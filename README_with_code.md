# ML-IMEX: A Machine Learning-Based Backward Extension of IMERG Precipitation Over the Greater Alpine Region
can i change?
## Overview

Accurate and high-resolution precipitation estimates are vital for climate research and hydrological modeling, especially in mountainous regions like the Greater Alpine Region (GAR), where observational networks are sparse and traditional models often underperform. This project presents **ML-IMEX**, a novel machine learning-based reconstruction of daily precipitation at 0.1° resolution for the pre-satellite era (1960–2000), leveraging ERA5 atmospheric reanalysis data and IMERG satellite observations.

---

## Objectives

- Downscale and bias-correct ERA5 precipitation fields using IMERG as a reference.
- Reconstruct IMERG-like daily precipitation for 1960–2000 using machine learning.
- Identify key atmospheric predictors for precipitation over the GAR.
- Validate the resulting ML-IMEX dataset using independent observational data (HISTALP, CHAPTER).

---

## Data Sources

- **ERA5**: Atmospheric reanalysis dataset (ECMWF) providing over 100 variables at 30 km resolution from 1940–present.
- **IMERG Final V07**: Satellite-based precipitation estimates at 0.1° resolution from 2001 onward.
- **ETOPO**: Topography data regridded to 0.1° for orographic predictors.
- **HISTALP**: Historical monthly precipitation records from 50 gauge stations across the GAR.
- **CHAPTER**: High-resolution (3x3 km) downscaled climate simulations used for additional validation.

---

## Methodology

### Preprocessing

- ERA5 was regridded to match IMERG’s spatial resolution (0.1°).
- February 29th was removed for temporal consistency across years.
- Days with IMERG Quality Index (QI) below 0.6 were excluded.
- Conservative remapping was applied to preserve physical consistency in precipitation fields.

### Machine Learning Model

- **Model**: Extreme Gradient Boosting (XGBoost)
- **Input Features**: 28 ERA5-derived predictors including thermodynamics, wind, moisture, and orography.
- **Feature Selection**: SHAP (SHapley Additive exPlanations) was used to identify the three most impactful variables:
  - Total Column Ice Water (TCIW)
  - ERA5 Precipitation
  - Column-Averaged Mixing Ratio (CAMR)
- **Training Setup**:
  - 60% training / 20% validation / 20% test
  - Daily granularity with spatial independence
  - Trained on all seasons (not season-specific models)

---

## Performance

| Metric        | ERA5 vs IMERG | XGB vs IMERG |
|---------------|---------------|---------------|
| **RMSE**      | 5.13 mm/day   | 4.39 mm/day   |
| **R²**        | 0.75          | 0.90          |

- XGB model reduces RMSE by ~14% compared to ERA5.
- Performs better across most terrain elevations and precipitation intensities.
- Shows robust generalization and spatial consistency.

---

## Validation

- **HISTALP**: XGB-generated data achieved **R² = 0.87**, outperforming both ERA5 (0.43) and CHAPTER (0.52).
- Demonstrated high agreement in monthly climatology over historical periods (1960–2000).

---

## Applications

- Climate change studies in data-sparse regions.
- Hydrological modeling and water resource planning.
- Historical weather event analysis in complex terrains.

---

## Repository Structure

```
├── ML-IMEX/
│   ├── data/              # ERA5, IMERG, and derived datasets
│   ├── notebooks/         # Jupyter Notebooks for modeling
│   ├── src/               # Core ML and preprocessing scripts
│   └── README.md          # This file
```

---

## Getting Started

1. Clone the repository:

```bash
git clone https://github.com/imanam1371/maxm-20240516.git
cd maxm-20240516
```

2. Install dependencies:

```bash
pip install -r requirements.txt
```

3. Run the main notebook:

```bash
jupyter notebook notebooks/maxm20250319-clear.ipynb
```

---

## Citation

If you use this dataset or code, please cite:

Goudarzi, I., Fazzini, D., Pasquero, C., Meroni, A. N., Borgnino, M. (2025).  
**A Machine Learning-Based Backward Extension of IMERG Daily Precipitation over the Greater Alpine Region**.  
[DOI:10.5281/zenodo.16631516](https://doi.org/10.5281/zenodo.16631516)

---

## License

This project is open source under the MIT License.

---

## Acknowledgments

This work was supported by the Department of Earth and Environmental Sciences, University of Milano-Bicocca.



---

## Code and Implementation

<h1> Import necessary packages</h1>


```python
import pandas as pd
import shap
import dask
import os
import numpy as np
import xarray as xr
import rioxarray as rxr
import cartopy.crs as ccrs
import netCDF4 as nc
import matplotlib.pyplot as plt
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import mean_squared_error, r2_score, mean_absolute_error
from sklearn.ensemble import RandomForestRegressor
from xgboost import XGBRegressor
from sklearn.neural_network import MLPRegressor
from sklearn.model_selection import train_test_split
from rasterio.merge import merge
from rasterio.plot import show
from tqdm import tqdm
import seaborn as sns
import random
import joblib
import json
```

    C:\Users\Iman\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\tqdm\auto.py:21: TqdmWarning: IProgress not found. Please update jupyter and ipywidgets. See https://ipywidgets.readthedocs.io/en/stable/user_install.html
      from .autonotebook import tqdm as notebook_tqdm



```python
#plot colour and size modification for the poster

import cartopy.crs as ccrs
crs = ccrs.PlateCarree()
import cartopy.feature as cfeature
from matplotlib import ticker
import matplotlib.colors as mcolors
custom_cmap = mcolors.LinearSegmentedColormap.from_list("white_to_blue", ["white", "blue"])


def map_m_fig(fig, m_array, elev, lon, lat, lev_max=3000, lev_range=500, title_fig="title fig", m_unit=r"angular coefficient m $[year^{-1}]$", extr=None, chosen_map="RdBu_r", vmin=None, vmax=None):
    ## extremes of colormap
    m_not_nan = np.nan_to_num(m_array)
    if extr is None:
        extr = np.max((np.abs(m_not_nan.min()), m_not_nan.max()))

    # label height
    levels = np.arange(0, lev_max, lev_range)

    ax = fig.add_subplot(projection=crs)
    contour = ax.contour(lon, lat, elev, levels, colors='k', linewidths=0.5)
    ax.add_feature(cfeature.COASTLINE)
    
    title_color = '#000000'  # Title color
    plt.title(title_fig, fontsize=20, fontweight='bold', color=title_color)  # Increased title font size
    
    if vmin is None:
        vmin = -extr
    if vmax is None:
        vmax = extr
    im = plt.pcolormesh(lon, lat, m_not_nan, vmin=vmin, vmax=vmax, cmap=chosen_map)
    
    # Gridlines with larger font size and same color as title
    gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, x_inline=False, y_inline=False, linewidth=0.33, color='k', alpha=0.5)
    gl.right_labels = gl.top_labels = False
    gl.xlabel_style = {'size': 15, 'color': title_color}
    gl.ylabel_style = {'size': 15, 'color': title_color}

    # Colorbar with larger font size and same color as title
    cax = fig.add_axes([ax.get_position().x1 + 0.01, ax.get_position().y0, 0.02, ax.get_position().height])
    cbar = plt.colorbar(im, cax=cax)
    cbar.set_label(m_unit, fontsize=15, color=title_color)
    
    # Set the colorbar background to transparent by setting its frame face color to None
    cbar.outline.set_edgecolor('none')  # Hide the colorbar outline
    
    # Remove the background face color for both the axes and colorbar
    cbar.ax.patch.set_facecolor('none')  # Set the colorbar facecolor to none
    ax.patch.set_facecolor('none')       # Set the axes facecolor to none
    
    # Update colorbar tick labels and ticks to match title color and size
    cbar.ax.yaxis.set_tick_params(labelsize=15, color=title_color)  # Adjust size and color of tick labels
    cbar.ax.yaxis.set_tick_params(which='both', width=2, color=title_color)  # Adjust width and color of ticks
    plt.setp(cbar.ax.get_yticklabels(), color=title_color)  # Set tick labels color to match title
```

<h1>Imerg and ERA5 and Resolution of Imerg _ 0.1</h1>

<h1>Import Data</h1>


```python
path = 'C:/Iman/Maxm'
#path = '/leonardo_work/mBI23_AmbCo_1/igoudarz'

iyear = list(range(2001, 2021)) #2021
```

<h1>ERA5 NN</h1>


```python
shap = "NO"  # or "YES"

if shap == "NO":
    var_surface_input_list = ['total_column_cloud_ice_water_daymean','total_precipitation_daycum','camr_daymean']
else:
    var_surface_input_list = [
         '10m_u_component_of_wind_daymean',
         '10m_v_component_of_wind_daymean',
         '2m_dewpoint_temperature_daymean',
         '2m_temperature_daymax',
         'convective_available_potential_energy_daymax',
         'geopotential_daymean',
         'k_index_daymean',
         'mean_surface_latent_heat_flux_daymean',
         'mean_surface_sensible_heat_flux_daymean',
         'mean_vertically_integrated_moisture_divergence_daymean',
         'sea_surface_temperature_daymean',
         'surface_pressure_daymean',
         'toa_incident_solar_radiation_daymean',
         'total_column_cloud_liquid_water_daymean',
         'total_column_cloud_ice_water_daymean',
         'total_column_water_vapour_daymean',
         'total_totals_index_daymean',
         'vertical_integral_of_eastward_water_vapour_flux_daymean',
         'vertical_integral_of_northward_water_vapour_flux_daymean',
         'volumetric_soil_water_layer_1_daymean',
         'total_precipitation_daycum',
         'temperature_daymean',
         'u_component_of_wind_daymean',
         'v_component_of_wind_daymean',
         'vertical_velocity_daymean',
         'vorticity_daymean',
         'q2m_daymean',
         'camr_daymean',
         'bs_daymax',
         'WVT_daymean']

```


```python
'''
var_surface_input_list=[
    #'10m_u_component_of_wind_daymean', 
    #'10m_v_component_of_wind_daymean', #2
    #'2m_dewpoint_temperature_daymean',
    #'2m_temperature_daymax',
    #'convective_available_potential_energy_daymax', #5                    #################
    #'convective_inhibition_daymin',
    #'geopotential_daymean',
    #'k_index_daymean',
    #'mean_surface_latent_heat_flux_daymean',
    #'mean_surface_sensible_heat_flux_daymean',
    #'mean_vertically_integrated_moisture_divergence_daymean', #11
    #'sea_surface_temperature_daymean',
    #'surface_pressure_daymean',
    #'toa_incident_solar_radiation_daymean',
    #'total_column_cloud_liquid_water_daymean', #15
    #'total_column_cloud_ice_water_daymean',                                #################
    #'total_column_water_vapour_daymean',                                   #################
    #'total_totals_index_daymean',
    #'vertical_integral_of_eastward_water_vapour_flux_daymean',             #################
    #'vertical_integral_of_northward_water_vapour_flux_daymean', #20  
    #'volumetric_soil_water_layer_1_daymean',
    #'total_precipitation_daycum',                                           #################
    
    #'temperature_daymean',                                                  ################# 
    #'u_component_of_wind_daymean',                                          ################# 
    #'v_component_of_wind_daymean', #25                                      #################
    #'vertical_velocity_daymean',
    #'vorticity_daymean',
    
    #'q2m_daymean', 
    #'camr_daymean',                                                          #################
    #'bs_daymax',
    
    #'WVT_daymean' #31
    ]
'''

# List to store the merged datasets for each variable
merged_datasets = []

for var in var_surface_input_list:
    datasets = []
    for year in iyear:
        # Open the dataset for the current variable and year
        ds = xr.open_dataset(f"{path}/ERA5_NearestN/{var}_{year}_NearestN.nc")
        #ds = xr.open_dataset(f"{path}/ERA5_Bilinear/{var}_{year}_Bilinear.nc")
        ds = ds.isel(bnds=0)
        datasets.append(ds)
    
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)

# Combine all merged variable datasets into a single xarray.Dataset
era5_dailydata = xr.merge(merged_datasets)
era5_dailydata

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 789MB
Dimensions:    (time: 7305, lon: 150, lat: 60)
Coordinates:
  * time       (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020-12-31T...
  * lon        (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.65 18.75 18.85 18.95
  * lat        (lat) float64 480B 43.05 43.15 43.25 43.35 ... 48.75 48.85 48.95
Data variables:
    time_bnds  (time) datetime64[ns] 58kB 2001-01-01 2001-01-02 ... 2020-12-31
    tciw       (time, lat, lon) float32 263MB 0.003961 0.003729 ... 0.008197
    tp         (time, lat, lon) float32 263MB 0.0001367 0.0003987 ... 5.329e-05
    camr       (time, lat, lon) float32 263MB 0.001835 0.001866 ... 0.0008634
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-dda794e6-6435-46b9-b1ca-c083e5070a53' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-dda794e6-6435-46b9-b1ca-c083e5070a53' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7305</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4c301b6c-e3de-4916-8138-c5e673a520b6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4c301b6c-e3de-4916-8138-c5e673a520b6' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-254395d5-32dd-44ec-820c-562efe45a489' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-254395d5-32dd-44ec-820c-562efe45a489' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-77d042e6-704e-471b-987c-fbbe4ad75e53' class='xr-var-data-in' type='checkbox'><label for='data-77d042e6-704e-471b-987c-fbbe4ad75e53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-6b7fdc6a-e742-4ab2-8ddf-e1e95a66ac0d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6b7fdc6a-e742-4ab2-8ddf-e1e95a66ac0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-70d8ca8c-d5ad-4bd1-8ccf-046b19c94e4a' class='xr-var-data-in' type='checkbox'><label for='data-70d8ca8c-d5ad-4bd1-8ccf-046b19c94e4a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-76d26da4-ebf8-47de-8f05-94c650c1ecea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-76d26da4-ebf8-47de-8f05-94c650c1ecea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6eb57a95-0543-4fe8-9b8b-186e15c6ee7f' class='xr-var-data-in' type='checkbox'><label for='data-6eb57a95-0543-4fe8-9b8b-186e15c6ee7f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-def45481-0c35-4d2d-9a16-8cb5ae7c0c93' class='xr-section-summary-in' type='checkbox'  checked><label for='section-def45481-0c35-4d2d-9a16-8cb5ae7c0c93' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-31</div><input id='attrs-6ef2b43b-6648-41a3-bf4a-28a482086e7c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ef2b43b-6648-41a3-bf4a-28a482086e7c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-659333a9-b4ab-49fe-a01d-ffe11cd9b5b0' class='xr-var-data-in' type='checkbox'><label for='data-659333a9-b4ab-49fe-a01d-ffe11cd9b5b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-01-02T00:00:00.000000000&#x27;,
       &#x27;2001-01-03T00:00:00.000000000&#x27;, ...,
       &#x27;2020-12-29T00:00:00.000000000&#x27;, &#x27;2020-12-30T00:00:00.000000000&#x27;,
       &#x27;2020-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-c0e4ddc9-9ce1-4702-8ab9-664d25bc4c2c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0e4ddc9-9ce1-4702-8ab9-664d25bc4c2c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-571f1f1b-9152-41ac-b614-8e97b93b09ac' class='xr-var-data-in' type='checkbox'><label for='data-571f1f1b-9152-41ac-b614-8e97b93b09ac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0001367 0.0003987 ... 5.329e-05</div><input id='attrs-92ccf8d4-58cb-4f4c-91f5-b57910e513ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-92ccf8d4-58cb-4f4c-91f5-b57910e513ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8650f735-23ff-4e7f-9f9e-f5d03236de84' class='xr-var-data-in' type='checkbox'><label for='data-8650f735-23ff-4e7f-9f9e-f5d03236de84' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Total precipitation</dd><dt><span>units :</span></dt><dd>m</dd><dt><span>cell_methods :</span></dt><dd>time: sum</dd></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-04, 3.9868618e-04, 3.9868618e-04, ...,
         3.1475225e-05, 3.1475225e-05, 5.8870330e-05],
        [8.1573293e-04, 1.0453855e-03, 1.0453855e-03, ...,
         2.5355042e-05, 2.5355042e-05, 6.7904883e-05],
        [8.1573293e-04, 1.0453855e-03, 1.0453855e-03, ...,
         2.5355042e-05, 2.5355042e-05, 6.7904883e-05],
        ...,
        [1.1190025e-02, 8.2750702e-03, 8.2750702e-03, ...,
         1.8943423e-05, 1.8943423e-05, 2.3023544e-05],
        [1.1190025e-02, 8.2750702e-03, 8.2750702e-03, ...,
         1.8943423e-05, 1.8943423e-05, 2.3023544e-05],
        [1.0786385e-02, 9.8406710e-03, 9.8406710e-03, ...,
         2.9726601e-05, 2.9726601e-05, 1.0404311e-04]],

       [[8.8159775e-04, 7.8338338e-04, 7.8338338e-04, ...,
         3.6998399e-18, 3.6998399e-18, 3.6998399e-18],
        [7.0090662e-04, 8.0465828e-04, 8.0465828e-04, ...,
         3.6998399e-18, 3.6998399e-18, 3.6998399e-18],
        [7.0090662e-04, 8.0465828e-04, 8.0465828e-04, ...,
         3.6998399e-18, 3.6998399e-18, 3.6998399e-18],
...
        [6.4181973e-04, 8.9844415e-04, 8.9844415e-04, ...,
         9.2847850e-03, 9.2847850e-03, 1.0145201e-02],
        [6.4181973e-04, 8.9844415e-04, 8.9844415e-04, ...,
         9.2847850e-03, 9.2847850e-03, 1.0145201e-02],
        [6.7751948e-04, 6.9692155e-04, 6.9692155e-04, ...,
         7.1722902e-03, 7.1722902e-03, 7.7952254e-03]],

       [[9.2095049e-04, 9.3828299e-04, 9.3828299e-04, ...,
         1.2160686e-02, 1.2160686e-02, 1.5352452e-02],
        [1.5516464e-03, 1.8519901e-03, 1.8519901e-03, ...,
         8.2983850e-03, 8.2983850e-03, 1.1352267e-02],
        [1.5516464e-03, 1.8519901e-03, 1.8519901e-03, ...,
         8.2983850e-03, 8.2983850e-03, 1.1352267e-02],
        ...,
        [6.7022434e-03, 6.5478031e-03, 6.5478031e-03, ...,
         1.2934698e-05, 1.2934698e-05, 3.2854132e-05],
        [6.7022434e-03, 6.5478031e-03, 6.5478031e-03, ...,
         1.2934698e-05, 1.2934698e-05, 3.2854132e-05],
        [9.4371559e-03, 8.2243988e-03, 8.2243988e-03, ...,
         1.0347759e-05, 1.0347759e-05, 5.3290958e-05]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-e971dd63-ea14-4c73-abb2-3769bab98911' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e971dd63-ea14-4c73-abb2-3769bab98911' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f233d926-ea57-4119-8983-65039a42a2b3' class='xr-var-data-in' type='checkbox'><label for='data-f233d926-ea57-4119-8983-65039a42a2b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ec05d444-c304-4a67-9ac0-c54b1a90fb1c' class='xr-section-summary-in' type='checkbox'  ><label for='section-ec05d444-c304-4a67-9ac0-c54b1a90fb1c' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7e77054a-ef23-4871-b447-a93ec96ae3c5' class='xr-index-data-in' type='checkbox'/><label for='index-7e77054a-ef23-4871-b447-a93ec96ae3c5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7305, freq=&#x27;D&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7ff2fcbf-3752-4165-ad31-e976871aa615' class='xr-index-data-in' type='checkbox'/><label for='index-7ff2fcbf-3752-4165-ad31-e976871aa615' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  4.05000019073486,  4.150000194575159,  4.250000198415457,
        4.350000202255757,  4.450000206096056,  4.550000209936355,
        4.650000213776654,  4.750000217616953,  4.850000221457252,
        4.950000225297551,
       ...
        18.05000072837672, 18.150000732217016, 18.250000736057316,
       18.350000739897617, 18.450000743737917, 18.550000747578217,
       18.650000751418514, 18.750000755258814,  18.85000075909911,
        18.95000076293941],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-be897535-a9ce-4563-8171-40c9610efa2f' class='xr-index-data-in' type='checkbox'/><label for='index-be897535-a9ce-4563-8171-40c9610efa2f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             43.05,              43.15,              43.25,
       43.349999999999994, 43.449999999999996,              43.55,
                    43.65,              43.75, 43.849999999999994,
       43.949999999999996,              44.05,              44.15,
                    44.25, 44.349999999999994, 44.449999999999996,
                    44.55,              44.65,              44.75,
       44.849999999999994, 44.949999999999996,              45.05,
                    45.15,              45.25, 45.349999999999994,
       45.449999999999996,              45.55,              45.65,
                    45.75, 45.849999999999994, 45.949999999999996,
                    46.05,              46.15,              46.25,
       46.349999999999994, 46.449999999999996,              46.55,
                    46.65,              46.75, 46.849999999999994,
       46.949999999999996,              47.05,              47.15,
                    47.25, 47.349999999999994, 47.449999999999996,
                    47.55,              47.65,              47.75,
       47.849999999999994, 47.949999999999996,              48.05,
                    48.15,              48.25, 48.349999999999994,
       48.449999999999996,              48.55,              48.65,
                    48.75, 48.849999999999994, 48.949999999999996],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-45dfca3f-2d31-422b-9ca4-2d1b6e1d869e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45dfca3f-2d31-422b-9ca4-2d1b6e1d869e' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
era5_dailydata = era5_dailydata.rename({'tp': 'tp_NearestN'})
era5_dailydata['tp_NearestN'] = era5_dailydata['tp_NearestN'] * 1000

if shap != "NO":
    era5_dailydata = era5_dailydata.rename({'z': 'geopotential/9.81'})  # make it comment
    era5_dailydata['geopotential/9.81'] = era5_dailydata['geopotential/9.81'] / 9.81  # make it comment

    era5_dailydata = era5_dailydata.rename({'p71.162': 'viewvf'})  # make it comment
    era5_dailydata = era5_dailydata.rename({'p72.162': 'vinwvf'})  # make it comment
    pass  # nothing else to do if lines are commented
```


```python
'''
#era5_dailydata = era5_dailydata.rename({'z': 'geopotential/9.81'})                     #make it comment#
#era5_dailydata['geopotential/9.81']=era5_dailydata['geopotential/9.81']/9.81           #make it comment#

era5_dailydata = era5_dailydata.rename({'tp': 'tp_NearestN'})
era5_dailydata['tp_NearestN']=era5_dailydata['tp_NearestN']*1000   

#era5_dailydata = era5_dailydata.rename({'p71.162': 'viewvf'})          #make it comment#
#era5_dailydata = era5_dailydata.rename({'p72.162': 'vinwvf'})          #make it comment#
 
era5_dailydata
'''
```




    "\n#era5_dailydata = era5_dailydata.rename({'z': 'geopotential/9.81'})                     #make it comment#\n#era5_dailydata['geopotential/9.81']=era5_dailydata['geopotential/9.81']/9.81           #make it comment#\n\nera5_dailydata = era5_dailydata.rename({'tp': 'tp_NearestN'})\nera5_dailydata['tp_NearestN']=era5_dailydata['tp_NearestN']*1000   \n\n#era5_dailydata = era5_dailydata.rename({'p71.162': 'viewvf'})          #make it comment#\n#era5_dailydata = era5_dailydata.rename({'p72.162': 'vinwvf'})          #make it comment#\n \nera5_dailydata\n"




```python
# Define the Z from ETOPO

path = 'C:/Iman/Maxm'
#path = '/leonardo_work/mBI23_AmbCo_1/igoudarz'
# Open the dataset
ds = xr.open_dataset(f"{path}/ETOPO_2022_v1_30s_N90W180_surface_Imerg_conservative_remapped.nc", engine="netcdf4")
# Select the latitude and longitude ranges
ETOPO_consmap_Z = ds.sel(lat=slice(43, 49), lon=slice(4, 19))




# Repeat the z data along the time dimension to match the length of era5_data_daily time dimension
expanded_z = xr.concat([ETOPO_consmap_Z['z']] * len(era5_dailydata.time), dim='time')

# Create a new DataArray 
new_data_array = xr.DataArray(
    expanded_z,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_dailydata.coords['time'],
        'lat': era5_dailydata.coords['lat'],
        'lon': era5_dailydata.coords['lon']
    }
)

# Assign the new DataArray to the dataset
era5_dailydata['ETOPO_consmap_z'] = new_data_array
era5_dailydata['ETOPO_consmap_z'] = era5_dailydata['ETOPO_consmap_z'].where(era5_dailydata['ETOPO_consmap_z'] >= 0, 0)

era5_dailydata
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1GB
Dimensions:          (time: 7305, lon: 150, lat: 60)
Coordinates:
  * time             (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020-...
  * lon              (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.75 18.85 18.95
  * lat              (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
Data variables:
    time_bnds        (time) datetime64[ns] 58kB 2001-01-01 ... 2020-12-31
    tciw             (time, lat, lon) float32 263MB 0.003961 ... 0.008197
    tp_NearestN      (time, lat, lon) float32 263MB 0.1367 0.3987 ... 0.05329
    camr             (time, lat, lon) float32 263MB 0.001835 ... 0.0008634
    ETOPO_consmap_z  (time, lat, lon) float32 263MB 0.0 0.0 0.0 ... 471.2 672.8
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-4fc473e3-5199-4e24-9336-4f6e4e86cbb5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-4fc473e3-5199-4e24-9336-4f6e4e86cbb5' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7305</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-447e3b42-d70a-4ef5-8174-0509573b3c3f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-447e3b42-d70a-4ef5-8174-0509573b3c3f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-31e4f995-24c8-49c1-acc3-870bdb7894a8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-31e4f995-24c8-49c1-acc3-870bdb7894a8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f07c5a7-7108-4bf9-907f-1c31ba6545ba' class='xr-var-data-in' type='checkbox'><label for='data-4f07c5a7-7108-4bf9-907f-1c31ba6545ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-23c60084-737f-4419-9447-2792544ec93b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-23c60084-737f-4419-9447-2792544ec93b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c12225f-559e-42a2-8af0-0a76f474a906' class='xr-var-data-in' type='checkbox'><label for='data-8c12225f-559e-42a2-8af0-0a76f474a906' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-9b9631d9-bc47-4962-ab54-5b329a6765c0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9b9631d9-bc47-4962-ab54-5b329a6765c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-964da8d5-0619-4280-accd-22c4a99486b3' class='xr-var-data-in' type='checkbox'><label for='data-964da8d5-0619-4280-accd-22c4a99486b3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09f9d967-0bc5-4569-ae4c-2fa5401e24ed' class='xr-section-summary-in' type='checkbox'  checked><label for='section-09f9d967-0bc5-4569-ae4c-2fa5401e24ed' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-31</div><input id='attrs-e462b199-f023-4513-90d2-17c731b04c2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e462b199-f023-4513-90d2-17c731b04c2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e69fe07f-7501-48a9-b90a-8061401501e2' class='xr-var-data-in' type='checkbox'><label for='data-e69fe07f-7501-48a9-b90a-8061401501e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-01-02T00:00:00.000000000&#x27;,
       &#x27;2001-01-03T00:00:00.000000000&#x27;, ...,
       &#x27;2020-12-29T00:00:00.000000000&#x27;, &#x27;2020-12-30T00:00:00.000000000&#x27;,
       &#x27;2020-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-161ac0f3-1f9e-4038-93f1-d3a0dcdf5b4f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-161ac0f3-1f9e-4038-93f1-d3a0dcdf5b4f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-505760b8-cf43-4f0f-94d1-b259952af5f0' class='xr-var-data-in' type='checkbox'><label for='data-505760b8-cf43-4f0f-94d1-b259952af5f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-6ccde0ce-8ccc-4229-8beb-86bc2ffb00a9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6ccde0ce-8ccc-4229-8beb-86bc2ffb00a9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a190e34-9952-4050-9312-7b3d5ca78aca' class='xr-var-data-in' type='checkbox'><label for='data-8a190e34-9952-4050-9312-7b3d5ca78aca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-f4c3b6f6-03b0-4d7f-80f4-6b836bf45c23' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f4c3b6f6-03b0-4d7f-80f4-6b836bf45c23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4198744a-b670-4eb0-9319-93af1b55933a' class='xr-var-data-in' type='checkbox'><label for='data-4198744a-b670-4eb0-9319-93af1b55933a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-359d9011-a9e5-47b2-9fe8-2a009668dde5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-359d9011-a9e5-47b2-9fe8-2a009668dde5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-044bd8d0-87fd-49f2-b032-0e8726d4d30c' class='xr-var-data-in' type='checkbox'><label for='data-044bd8d0-87fd-49f2-b032-0e8726d4d30c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c977c974-56dd-4a04-9ca3-e2b3a8219112' class='xr-section-summary-in' type='checkbox'  ><label for='section-c977c974-56dd-4a04-9ca3-e2b3a8219112' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-623f887c-1343-4710-8e54-20e7f3311a45' class='xr-index-data-in' type='checkbox'/><label for='index-623f887c-1343-4710-8e54-20e7f3311a45' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7305, freq=&#x27;D&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f9ff2a29-741d-4896-b8d2-694c59aa17ae' class='xr-index-data-in' type='checkbox'/><label for='index-f9ff2a29-741d-4896-b8d2-694c59aa17ae' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  4.05000019073486,  4.150000194575159,  4.250000198415457,
        4.350000202255757,  4.450000206096056,  4.550000209936355,
        4.650000213776654,  4.750000217616953,  4.850000221457252,
        4.950000225297551,
       ...
        18.05000072837672, 18.150000732217016, 18.250000736057316,
       18.350000739897617, 18.450000743737917, 18.550000747578217,
       18.650000751418514, 18.750000755258814,  18.85000075909911,
        18.95000076293941],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-acd075cc-efd6-4cf7-a8d5-3f3dfc258244' class='xr-index-data-in' type='checkbox'/><label for='index-acd075cc-efd6-4cf7-a8d5-3f3dfc258244' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             43.05,              43.15,              43.25,
       43.349999999999994, 43.449999999999996,              43.55,
                    43.65,              43.75, 43.849999999999994,
       43.949999999999996,              44.05,              44.15,
                    44.25, 44.349999999999994, 44.449999999999996,
                    44.55,              44.65,              44.75,
       44.849999999999994, 44.949999999999996,              45.05,
                    45.15,              45.25, 45.349999999999994,
       45.449999999999996,              45.55,              45.65,
                    45.75, 45.849999999999994, 45.949999999999996,
                    46.05,              46.15,              46.25,
       46.349999999999994, 46.449999999999996,              46.55,
                    46.65,              46.75, 46.849999999999994,
       46.949999999999996,              47.05,              47.15,
                    47.25, 47.349999999999994, 47.449999999999996,
                    47.55,              47.65,              47.75,
       47.849999999999994, 47.949999999999996,              48.05,
                    48.15,              48.25, 48.349999999999994,
       48.449999999999996,              48.55,              48.65,
                    48.75, 48.849999999999994, 48.949999999999996],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-817d7402-eca8-4c31-bcd4-e3e6b351ce9d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-817d7402-eca8-4c31-bcd4-e3e6b351ce9d' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
var_surface_input_list2=['total_precipitation_daycum']


# List to store the merged datasets for each variable
merged_datasets = []

for var in var_surface_input_list2:
    datasets = []
    for year in iyear:
        # Open the dataset for the current variable and year
        ds = xr.open_dataset(f"{path}/ERA5_consmap/{var}_{year}_consmap.nc")
        #ds = ds.rename({var.split('_')[0]: var})
        ds = ds.isel(bnds=0)
        datasets.append(ds)
    
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)

# Combine all merged variable datasets into a single xarray.Dataset
era5_ppt_era5 = xr.merge(merged_datasets)
era5_ppt_era5 = era5_ppt_era5.rename({'tp': 'ppt_era5'})
era5_ppt_era5['ppt_era5']=era5_ppt_era5['ppt_era5']*1000 
era5_ppt_era5
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 263MB
Dimensions:    (time: 7305, lon: 150, lat: 60)
Coordinates:
  * time       (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020-12-31T...
  * lon        (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.65 18.75 18.85 18.95
  * lat        (lat) float64 480B 43.05 43.15 43.25 43.35 ... 48.75 48.85 48.95
Data variables:
    time_bnds  (time) datetime64[ns] 58kB 2001-01-01 2001-01-02 ... 2020-12-31
    ppt_era5   (time, lat, lon) float32 263MB 0.1367 0.3332 ... 0.02108 0.05329
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Tue Oct 08 10:17:49 2024: cdo remapcon,/mnt/c/Iman/Maxm/Ime...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-960f3e79-1c74-4bc8-9d8f-bc39e882dd5e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-960f3e79-1c74-4bc8-9d8f-bc39e882dd5e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7305</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9ddb81a6-cde1-430d-9891-28ff552220dc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9ddb81a6-cde1-430d-9891-28ff552220dc' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-b40436ec-d81b-4d7c-a251-20f3a5d5d952' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b40436ec-d81b-4d7c-a251-20f3a5d5d952' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-52269d0e-e8e5-4e81-9083-d657ede2f808' class='xr-var-data-in' type='checkbox'><label for='data-52269d0e-e8e5-4e81-9083-d657ede2f808' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-3b834dd2-49ca-4d7c-83cb-a8cf6648796d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3b834dd2-49ca-4d7c-83cb-a8cf6648796d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e3656ecb-0855-4fbd-b3d0-c390577bbdaa' class='xr-var-data-in' type='checkbox'><label for='data-e3656ecb-0855-4fbd-b3d0-c390577bbdaa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-4ee95f35-d499-4050-ba12-c1ecd276cf3f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4ee95f35-d499-4050-ba12-c1ecd276cf3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fc2bc7c9-a41b-4b58-9ac7-1da2fdf281af' class='xr-var-data-in' type='checkbox'><label for='data-fc2bc7c9-a41b-4b58-9ac7-1da2fdf281af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6f25d173-1876-4d85-b336-57299a45296e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6f25d173-1876-4d85-b336-57299a45296e' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-31</div><input id='attrs-a8c1afc7-5cd7-4b3c-8ed9-01d6fa0f13b4' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a8c1afc7-5cd7-4b3c-8ed9-01d6fa0f13b4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-571f6055-ec35-4e01-a498-cb521583d100' class='xr-var-data-in' type='checkbox'><label for='data-571f6055-ec35-4e01-a498-cb521583d100' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-01-02T00:00:00.000000000&#x27;,
       &#x27;2001-01-03T00:00:00.000000000&#x27;, ...,
       &#x27;2020-12-29T00:00:00.000000000&#x27;, &#x27;2020-12-30T00:00:00.000000000&#x27;,
       &#x27;2020-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-b0ed1543-c6b4-460c-b9f3-7402540231d2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b0ed1543-c6b4-460c-b9f3-7402540231d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6778e89-a99f-4036-bae5-cf36f87dbdd4' class='xr-var-data-in' type='checkbox'><label for='data-c6778e89-a99f-4036-bae5-cf36f87dbdd4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-97e48ebb-41f7-4e46-a273-7562bea0255a' class='xr-section-summary-in' type='checkbox'  ><label for='section-97e48ebb-41f7-4e46-a273-7562bea0255a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-81fa6fae-7f1d-41b5-bfec-328289987a88' class='xr-index-data-in' type='checkbox'/><label for='index-81fa6fae-7f1d-41b5-bfec-328289987a88' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7305, freq=&#x27;D&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7fa90644-062c-42c6-8ff2-19a7947e2c80' class='xr-index-data-in' type='checkbox'/><label for='index-7fa90644-062c-42c6-8ff2-19a7947e2c80' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  4.05000019073486,  4.150000194575159,  4.250000198415457,
        4.350000202255757,  4.450000206096056,  4.550000209936355,
        4.650000213776654,  4.750000217616953,  4.850000221457252,
        4.950000225297551,
       ...
        18.05000072837672, 18.150000732217016, 18.250000736057316,
       18.350000739897617, 18.450000743737917, 18.550000747578217,
       18.650000751418514, 18.750000755258814,  18.85000075909911,
        18.95000076293941],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4e19da36-2da9-4640-b945-eb0832080e3f' class='xr-index-data-in' type='checkbox'/><label for='index-4e19da36-2da9-4640-b945-eb0832080e3f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             43.05,              43.15,              43.25,
       43.349999999999994, 43.449999999999996,              43.55,
                    43.65,              43.75, 43.849999999999994,
       43.949999999999996,              44.05,              44.15,
                    44.25, 44.349999999999994, 44.449999999999996,
                    44.55,              44.65,              44.75,
       44.849999999999994, 44.949999999999996,              45.05,
                    45.15,              45.25, 45.349999999999994,
       45.449999999999996,              45.55,              45.65,
                    45.75, 45.849999999999994, 45.949999999999996,
                    46.05,              46.15,              46.25,
       46.349999999999994, 46.449999999999996,              46.55,
                    46.65,              46.75, 46.849999999999994,
       46.949999999999996,              47.05,              47.15,
                    47.25, 47.349999999999994, 47.449999999999996,
                    47.55,              47.65,              47.75,
       47.849999999999994, 47.949999999999996,              48.05,
                    48.15,              48.25, 48.349999999999994,
       48.449999999999996,              48.55,              48.65,
                    48.75, 48.849999999999994, 48.949999999999996],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-12431ce2-1861-49e0-bd51-72aa1ce597c3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-12431ce2-1861-49e0-bd51-72aa1ce597c3' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Tue Oct 08 10:17:49 2024: cdo remapcon,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_precipitation_daycum_2001.nc /mnt/c/Iman/Maxm/ERA5_consmap/total_precipitation_daycum_2001_consmap.nc
Wed Aug 07 12:00:17 2024: cdo -s -b F32 -daysum -selname,tp /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_precipitation_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_precipitation_daycum_2001.nc
2024-08-04 02:03:03 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data9/adaptor.mars.internal-1722736959.1447163-22728-1-37837e2c-41d7-4862-96c7-14c162703191.nc /cache/tmp/37837e2c-41d7-4862-96c7-14c162703191-adaptor.mars.internal-1722736166.4492922-22728-1-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
era5_data_daily = xr.merge([era5_dailydata, era5_ppt_era5], compat='override')
era5_data_daily = era5_data_daily.drop_vars('time_bnds')

#exclude data less than 0
era5_data_daily["ppt_era5"] = xr.where(era5_data_daily["ppt_era5"] > 0, era5_data_daily["ppt_era5"], 0)
era5_data_daily["tciw"] = xr.where(era5_data_daily["tciw"] > 0, era5_data_daily["tciw"], 0)

era5_data_daily["ppt_era5"].attrs["units"] = "mm" 
era5_data_daily["camr"].attrs["units"] = "unitless"
era5_data_daily["tciw"].attrs["units"] = "kg m**-2"


if shap != "NO":
    era5_data_daily["cape"] = xr.where(era5_data_daily["cape"] > 0, era5_data_daily["cape"], 0)  
    era5_data_daily["tp_NearestN"].attrs["units"] = "mm"       #make it comment#
    era5_data_daily["bs"].attrs["units"] = "m s**-1"           #make it comment#
    era5_data_daily["cape"].attrs["units"] = "J kg**-1"
    era5_data_daily["q2m"].attrs["units"] = "kg/kg"            #make it comment#
    era5_data_daily["WVT"].attrs["units"] = "m s**-1"  
    pass  # nothing else to do if lines are commented

era5_data_daily
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 1GB
Dimensions:          (time: 7305, lon: 150, lat: 60)
Coordinates:
  * time             (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020-...
  * lon              (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.75 18.85 18.95
  * lat              (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
Data variables:
    tciw             (time, lat, lon) float32 263MB 0.003961 ... 0.008197
    tp_NearestN      (time, lat, lon) float32 263MB 0.1367 0.3987 ... 0.05329
    camr             (time, lat, lon) float32 263MB 0.001835 ... 0.0008634
    ETOPO_consmap_z  (time, lat, lon) float32 263MB 0.0 0.0 0.0 ... 471.2 672.8
    ppt_era5         (time, lat, lon) float32 263MB 0.1367 0.3332 ... 0.05329
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-04d06c58-8269-4f8b-9ec3-b8ef44ea49c2' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-04d06c58-8269-4f8b-9ec3-b8ef44ea49c2' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7305</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6694c15a-7631-4df9-9e65-47921194ea0f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6694c15a-7631-4df9-9e65-47921194ea0f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-1ad00b50-5374-4d51-8bc0-4b8adfafe4d0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1ad00b50-5374-4d51-8bc0-4b8adfafe4d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-660cffab-61f6-4ef2-aec4-51c36b615175' class='xr-var-data-in' type='checkbox'><label for='data-660cffab-61f6-4ef2-aec4-51c36b615175' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-d7ac40e1-f861-4de9-a84f-33481dd68b0e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d7ac40e1-f861-4de9-a84f-33481dd68b0e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-891d478d-bacf-468c-8dd6-b144c4f470b8' class='xr-var-data-in' type='checkbox'><label for='data-891d478d-bacf-468c-8dd6-b144c4f470b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-ee59a923-bc24-406c-b811-4b3f87d4482e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ee59a923-bc24-406c-b811-4b3f87d4482e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9456b704-62d5-4f8b-b3ce-c43424e35dbc' class='xr-var-data-in' type='checkbox'><label for='data-9456b704-62d5-4f8b-b3ce-c43424e35dbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38728b9e-feec-4393-a905-f182116a3301' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38728b9e-feec-4393-a905-f182116a3301' class='xr-section-summary' >Data variables: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-6aa207f1-8f2b-49b2-b16d-60c97d36d36e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6aa207f1-8f2b-49b2-b16d-60c97d36d36e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0ce9a902-62b8-4515-8fae-f922e6f45b81' class='xr-var-data-in' type='checkbox'><label for='data-0ce9a902-62b8-4515-8fae-f922e6f45b81' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-c1fe7985-0c42-47c5-8814-04fbb140bc6a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1fe7985-0c42-47c5-8814-04fbb140bc6a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-790e22ed-0430-42fd-8258-c5feecf30539' class='xr-var-data-in' type='checkbox'><label for='data-790e22ed-0430-42fd-8258-c5feecf30539' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-b096cc70-d18f-41f2-af01-2baf53693688' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b096cc70-d18f-41f2-af01-2baf53693688' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a353f21-33ba-4543-937b-962c5d67f0bd' class='xr-var-data-in' type='checkbox'><label for='data-8a353f21-33ba-4543-937b-962c5d67f0bd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-f2c69347-2fb6-4668-a823-05f350c48ab9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f2c69347-2fb6-4668-a823-05f350c48ab9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49a0e942-c096-47b7-8790-e9d25dbfffff' class='xr-var-data-in' type='checkbox'><label for='data-49a0e942-c096-47b7-8790-e9d25dbfffff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-e2146507-c24e-4021-bf6f-a01b8273b510' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e2146507-c24e-4021-bf6f-a01b8273b510' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f158c2b9-1baf-448c-9d05-1a9b050d0922' class='xr-var-data-in' type='checkbox'><label for='data-f158c2b9-1baf-448c-9d05-1a9b050d0922' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ff70b34d-bbb7-488b-b76d-3758a2565f09' class='xr-section-summary-in' type='checkbox'  ><label for='section-ff70b34d-bbb7-488b-b76d-3758a2565f09' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ffd99e1b-c17e-42c3-8e9b-4a8940706d6e' class='xr-index-data-in' type='checkbox'/><label for='index-ffd99e1b-c17e-42c3-8e9b-4a8940706d6e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7305, freq=&#x27;D&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f63c124b-0f9a-4011-b52f-e1ceea7e10f3' class='xr-index-data-in' type='checkbox'/><label for='index-f63c124b-0f9a-4011-b52f-e1ceea7e10f3' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([  4.05000019073486,  4.150000194575159,  4.250000198415457,
        4.350000202255757,  4.450000206096056,  4.550000209936355,
        4.650000213776654,  4.750000217616953,  4.850000221457252,
        4.950000225297551,
       ...
        18.05000072837672, 18.150000732217016, 18.250000736057316,
       18.350000739897617, 18.450000743737917, 18.550000747578217,
       18.650000751418514, 18.750000755258814,  18.85000075909911,
        18.95000076293941],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-954dad8d-607d-40f4-b716-767e6c1428eb' class='xr-index-data-in' type='checkbox'/><label for='index-954dad8d-607d-40f4-b716-767e6c1428eb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             43.05,              43.15,              43.25,
       43.349999999999994, 43.449999999999996,              43.55,
                    43.65,              43.75, 43.849999999999994,
       43.949999999999996,              44.05,              44.15,
                    44.25, 44.349999999999994, 44.449999999999996,
                    44.55,              44.65,              44.75,
       44.849999999999994, 44.949999999999996,              45.05,
                    45.15,              45.25, 45.349999999999994,
       45.449999999999996,              45.55,              45.65,
                    45.75, 45.849999999999994, 45.949999999999996,
                    46.05,              46.15,              46.25,
       46.349999999999994, 46.449999999999996,              46.55,
                    46.65,              46.75, 46.849999999999994,
       46.949999999999996,              47.05,              47.15,
                    47.25, 47.349999999999994, 47.449999999999996,
                    47.55,              47.65,              47.75,
       47.849999999999994, 47.949999999999996,              48.05,
                    48.15,              48.25, 48.349999999999994,
       48.449999999999996,              48.55,              48.65,
                    48.75, 48.849999999999994, 48.949999999999996],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4fc55c6c-4191-4a86-aa59-4413f844474f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4fc55c6c-4191-4a86-aa59-4413f844474f' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
'''
era5_data_daily = xr.merge([era5_dailydata, era5_ppt_era5], compat='override')
era5_data_daily = era5_data_daily.drop_vars('time_bnds')


era5_data_daily["ppt_era5"] = xr.where(era5_data_daily["ppt_era5"] > 0, era5_data_daily["ppt_era5"], 0)
era5_data_daily["tciw"] = xr.where(era5_data_daily["tciw"] > 0, era5_data_daily["tciw"], 0)
era5_data_daily["cape"] = xr.where(era5_data_daily["cape"] > 0, era5_data_daily["cape"], 0)


#era5_data_daily["tp_NearestN"].attrs["units"] = "mm"       #make it comment#
era5_data_daily["ppt_era5"].attrs["units"] = "mm"   
#era5_data_daily["bs"].attrs["units"] = "m s**-1"           #make it comment#
era5_data_daily["camr"].attrs["units"] = "unitless"
era5_data_daily["tciw"].attrs["units"] = "kg m**-2"
#era5_data_daily["cape"].attrs["units"] = "J kg**-1"
#era5_data_daily["q2m"].attrs["units"] = "kg/kg"            #make it comment#
#era5_data_daily["WVT"].attrs["units"] = "m s**-1"          #make it comment#


era5_data_daily
'''
```




    '\nera5_data_daily = xr.merge([era5_dailydata, era5_ppt_era5], compat=\'override\')\nera5_data_daily = era5_data_daily.drop_vars(\'time_bnds\')\n\n\nera5_data_daily["ppt_era5"] = xr.where(era5_data_daily["ppt_era5"] > 0, era5_data_daily["ppt_era5"], 0)\nera5_data_daily["tciw"] = xr.where(era5_data_daily["tciw"] > 0, era5_data_daily["tciw"], 0)\nera5_data_daily["cape"] = xr.where(era5_data_daily["cape"] > 0, era5_data_daily["cape"], 0)\n\n\n#era5_data_daily["tp_NearestN"].attrs["units"] = "mm"       #make it comment#\nera5_data_daily["ppt_era5"].attrs["units"] = "mm"   \n#era5_data_daily["bs"].attrs["units"] = "m s**-1"           #make it comment#\nera5_data_daily["camr"].attrs["units"] = "unitless"\nera5_data_daily["tciw"].attrs["units"] = "kg m**-2"\n#era5_data_daily["cape"].attrs["units"] = "J kg**-1"\n#era5_data_daily["q2m"].attrs["units"] = "kg/kg"            #make it comment#\n#era5_data_daily["WVT"].attrs["units"] = "m s**-1"          #make it comment#\n\n\nera5_data_daily\n'



<h2>Imerg</h2>


```python
# Imerg with original resolution and with DASK
import xarray as xr

# Define the path to your data
path = 'C:/Iman/Maxm'
#path = '/leonardo_work/mBI23_AmbCo_1/igoudarz'
dates = pd.date_range(start="2001-01-01", end="2020-12-31", freq="D") #end="2020-12-31"

# Enable dask to manage datasets lazily
merged_datasets = []

for date in dates:
    try:
        i = date.strftime("%Y%m%d")  # Format date as YYYYMMDD
        # Open the dataset with dask for lazy loading
        ds = xr.open_dataset(f"{path}/IMERG7_CDO/CDO_Precipitation_3B-DAY.MS.MRG.3IMERG.{i}-S000000-E235959.V07B.nc4", 
                             engine="netcdf4", chunks={'time': 1})  # Load in small chunks, like one time slice at a time
        ds = ds['precipitation']
        merged_datasets.append(ds)
    except FileNotFoundError:
        print(f"File not found for {i}, skipping...")

# Merge datasets lazily
Imerg_orgres_dask = xr.concat(merged_datasets, dim='time')
Imerg_orgres_dask=Imerg_orgres_dask.transpose('time', 'lat', 'lon')
Imerg_orgres_dask
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;precipitation&#x27; (time: 7305, lat: 60, lon: 150)&gt; Size: 263MB
dask.array&lt;transpose, shape=(7305, 60, 150), dtype=float32, chunksize=(1, 60, 150), chunktype=numpy.ndarray&gt;
Coordinates:
  * time     (time) datetime64[ns] 58kB 2001-01-01 2001-01-02 ... 2020-12-31
  * lon      (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.65 18.75 18.85 18.95
  * lat      (lat) float64 480B 43.05 43.15 43.25 43.35 ... 48.75 48.85 48.95
Attributes:
    long_name:  Daily mean precipitation rate (combined microwave-IR) estimat...
    units:      mm/day</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'precipitation'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7305</li><li><span class='xr-has-index'>lat</span>: 60</li><li><span class='xr-has-index'>lon</span>: 150</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-ca49cd40-ca05-4154-91a1-6dd09b59d6b5' class='xr-array-in' type='checkbox' checked><label for='section-ca49cd40-ca05-4154-91a1-6dd09b59d6b5' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 60, 150), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 250.80 MiB </td>
                        <td> 35.16 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (7305, 60, 150) </td>
                        <td> (1, 60, 150) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 7305 chunks in 14612 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="159" height="146" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="25" x2="80" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="25" style="stroke-width:2" />
  <line x1="13" y1="3" x2="13" y2="29" />
  <line x1="17" y1="7" x2="17" y2="32" />
  <line x1="21" y1="11" x2="21" y2="36" />
  <line x1="24" y1="14" x2="24" y2="40" />
  <line x1="28" y1="18" x2="28" y2="43" />
  <line x1="32" y1="22" x2="32" y2="47" />
  <line x1="36" y1="26" x2="36" y2="51" />
  <line x1="39" y1="29" x2="39" y2="55" />
  <line x1="43" y1="33" x2="43" y2="58" />
  <line x1="47" y1="37" x2="47" y2="62" />
  <line x1="50" y1="40" x2="50" y2="66" />
  <line x1="54" y1="44" x2="54" y2="69" />
  <line x1="58" y1="48" x2="58" y2="73" />
  <line x1="62" y1="52" x2="62" y2="77" />
  <line x1="65" y1="55" x2="65" y2="81" />
  <line x1="69" y1="59" x2="69" y2="84" />
  <line x1="73" y1="63" x2="73" y2="88" />
  <line x1="76" y1="66" x2="76" y2="92" />
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,96.00085180870013 10.0,25.412616514582485" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="39" y2="0" style="stroke-width:2" />
  <line x1="13" y1="3" x2="42" y2="3" />
  <line x1="17" y1="7" x2="46" y2="7" />
  <line x1="21" y1="11" x2="50" y2="11" />
  <line x1="24" y1="14" x2="54" y2="14" />
  <line x1="28" y1="18" x2="57" y2="18" />
  <line x1="32" y1="22" x2="61" y2="22" />
  <line x1="36" y1="26" x2="65" y2="26" />
  <line x1="39" y1="29" x2="68" y2="29" />
  <line x1="43" y1="33" x2="72" y2="33" />
  <line x1="47" y1="37" x2="76" y2="37" />
  <line x1="50" y1="40" x2="80" y2="40" />
  <line x1="54" y1="44" x2="83" y2="44" />
  <line x1="58" y1="48" x2="87" y2="48" />
  <line x1="62" y1="52" x2="91" y2="52" />
  <line x1="65" y1="55" x2="94" y2="55" />
  <line x1="69" y1="59" x2="98" y2="59" />
  <line x1="73" y1="63" x2="102" y2="63" />
  <line x1="76" y1="66" x2="106" y2="66" />
  <line x1="80" y1="70" x2="109" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="39" y1="0" x2="109" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 39.17924711340376,0.0 109.76748240752141,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="109" y2="70" style="stroke-width:2" />
  <line x1="80" y1="96" x2="109" y2="96" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="96" style="stroke-width:2" />
  <line x1="109" y1="70" x2="109" y2="96" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 109.76748240752141,70.58823529411765 109.76748240752141,96.00085180870013 80.58823529411765,96.00085180870013" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="95.177859" y="116.000852" font-size="1.0rem" font-weight="100" text-anchor="middle" >150</text>
  <text x="129.767482" y="83.294544" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,129.767482,83.294544)">60</text>
  <text x="35.294118" y="80.706734" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,80.706734)">7305</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-1deaac4f-c016-42c3-9e0b-5352ab7f7813' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1deaac4f-c016-42c3-9e0b-5352ab7f7813' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-31</div><input id='attrs-02739c30-4764-4db4-858f-ab40389edaae' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02739c30-4764-4db4-858f-ab40389edaae' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0268d314-d14c-44ff-858c-623e08378096' class='xr-var-data-in' type='checkbox'><label for='data-0268d314-d14c-44ff-858c-623e08378096' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-01-02T00:00:00.000000000&#x27;,
       &#x27;2001-01-03T00:00:00.000000000&#x27;, ..., &#x27;2020-12-29T00:00:00.000000000&#x27;,
       &#x27;2020-12-30T00:00:00.000000000&#x27;, &#x27;2020-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-64ca9967-4f87-450b-b5e5-1063f38fbd9a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-64ca9967-4f87-450b-b5e5-1063f38fbd9a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d20cdfa6-3f4b-4a6b-b5ce-874529b16e3e' class='xr-var-data-in' type='checkbox'><label for='data-d20cdfa6-3f4b-4a6b-b5ce-874529b16e3e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.15    , 12.25    , 12.35    ,
       12.45    , 12.55    , 12.65    , 12.75    , 12.85    , 12.95    ,
       13.05    , 13.15    , 13.25    , 13.35    , 13.45    , 13.55    ,
       13.65    , 13.75    , 13.85    , 13.95    , 14.05    , 14.15    ,
       14.25    , 14.35    , 14.45    , 14.55    , 14.65    , 14.75    ,
       14.85    , 14.95    , 15.05    , 15.15    , 15.25    , 15.35    ,
       15.45    , 15.55    , 15.65    , 15.75    , 15.85    , 15.95    ,
       16.049999, 16.15    , 16.25    , 16.35    , 16.450001, 16.549999,
       16.65    , 16.75    , 16.85    , 16.950001, 17.049999, 17.15    ,
       17.25    , 17.35    , 17.450001, 17.549999, 17.65    , 17.75    ,
       17.85    , 17.950001, 18.049999, 18.15    , 18.25    , 18.35    ,
       18.450001, 18.549999, 18.65    , 18.75    , 18.85    , 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-12bd8b72-f279-4320-98b5-d2a52be10fc0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12bd8b72-f279-4320-98b5-d2a52be10fc0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ed845b5-2967-484b-988c-446b7c733a11' class='xr-var-data-in' type='checkbox'><label for='data-6ed845b5-2967-484b-988c-446b7c733a11' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-95088c6f-e084-4cd6-b8a0-ef2c0bce7609' class='xr-section-summary-in' type='checkbox'  ><label for='section-95088c6f-e084-4cd6-b8a0-ef2c0bce7609' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ac3a826c-403b-41d6-82f0-d3b0762ae6ae' class='xr-index-data-in' type='checkbox'/><label for='index-ac3a826c-403b-41d6-82f0-d3b0762ae6ae' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01&#x27;, &#x27;2001-01-02&#x27;, &#x27;2001-01-03&#x27;, &#x27;2001-01-04&#x27;,
               &#x27;2001-01-05&#x27;, &#x27;2001-01-06&#x27;, &#x27;2001-01-07&#x27;, &#x27;2001-01-08&#x27;,
               &#x27;2001-01-09&#x27;, &#x27;2001-01-10&#x27;,
               ...
               &#x27;2020-12-22&#x27;, &#x27;2020-12-23&#x27;, &#x27;2020-12-24&#x27;, &#x27;2020-12-25&#x27;,
               &#x27;2020-12-26&#x27;, &#x27;2020-12-27&#x27;, &#x27;2020-12-28&#x27;, &#x27;2020-12-29&#x27;,
               &#x27;2020-12-30&#x27;, &#x27;2020-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7305, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d4ba0336-925f-4ac2-b173-502a36b5a3aa' class='xr-index-data-in' type='checkbox'/><label for='index-d4ba0336-925f-4ac2-b173-502a36b5a3aa' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.050000190734863,  4.150000095367432,               4.25,
        4.349999904632568,  4.449999809265137,  4.550000190734863,
        4.650000095367432,               4.75,  4.849999904632568,
        4.949999809265137,
       ...
       18.049999237060547, 18.149999618530273,              18.25,
       18.350000381469727, 18.450000762939453, 18.549999237060547,
       18.649999618530273,              18.75, 18.850000381469727,
       18.950000762939453],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c12886cd-755b-4ca5-8e44-f37589ed0c0e' class='xr-index-data-in' type='checkbox'/><label for='index-c12886cd-755b-4ca5-8e44-f37589ed0c0e' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([             43.05,  43.14999999999999, 43.250000000000014,
        43.35000000000001,              43.45,              43.55,
        43.64999999999999, 43.750000000000014,  43.85000000000001,
                    43.95,              44.05,  44.14999999999999,
       44.250000000000014,  44.35000000000001,              44.45,
                    44.55,  44.64999999999999, 44.750000000000014,
        44.85000000000001,              44.95,              45.05,
        45.14999999999999, 45.250000000000014,  45.35000000000001,
                    45.45,              45.55,  45.64999999999999,
       45.750000000000014,  45.85000000000001,              45.95,
                    46.05,  46.14999999999999, 46.250000000000014,
        46.35000000000001,              46.45,              46.55,
        46.64999999999999, 46.750000000000014,  46.85000000000001,
                    46.95,              47.05,  47.14999999999999,
       47.250000000000014,  47.35000000000001,              47.45,
                    47.55,  47.64999999999999, 47.750000000000014,
        47.85000000000001,              47.95,              48.05,
        48.14999999999999, 48.250000000000014,  48.35000000000001,
                    48.45,              48.55,  48.64999999999999,
       48.750000000000014,  48.85000000000001,              48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-193f7452-5897-4401-91f1-dc43b411553f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-193f7452-5897-4401-91f1-dc43b411553f' class='xr-section-summary' >Attributes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Daily mean precipitation rate (combined microwave-IR) estimate. Formerly precipitationCal.</dd><dt><span>units :</span></dt><dd>mm/day</dd></dl></div></li></ul></div></div>




```python
era5_Imerg=era5_data_daily.copy(deep=True)

# Create a new DataArray for train/test indices
new_data_array = xr.DataArray(
    Imerg_orgres_dask.compute().values,
    dims=['time', 'lat','lon'],
    coords={
        'time': era5_Imerg.coords['time'],
        'lat': era5_Imerg.coords['lon'],
        'lon': era5_Imerg.coords['lat']
    }
)

# Assign the new DataArray to the dataset
era5_Imerg['Imerg_orgres'] = new_data_array






#removing 29th of Feb to have a same data for all years
era5_Imerg = era5_Imerg.sel(time=~((era5_Imerg['time'].dt.month == 2) & (era5_Imerg['time'].dt.day == 29)))

# Create a custom list of 365 day indices (or labels)
custom_dayofyear = np.tile(np.arange(1, 366), len(np.unique(era5_Imerg['time'].dt.year.values)))

# Assign this custom day index as a new coordinate
era5_Imerg = era5_Imerg.assign_coords(custom_dayofyear=("time", custom_dayofyear))

#assign the unit to IMERG pp
era5_Imerg["Imerg_orgres"].attrs["units"] = "mm"

era5_Imerg['lat'] = era5_Imerg['lat'].round(2).astype(float)
era5_Imerg['lon'] = era5_Imerg['lon'].round(2).astype(float)

era5_Imerg
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:           (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time              (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020...
  * lon               (lon) float64 1kB 4.05 4.15 4.25 ... 18.75 18.85 18.95
  * lat               (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
    custom_dayofyear  (time) int32 29kB 1 2 3 4 5 6 ... 360 361 362 363 364 365
Data variables:
    tciw              (time, lat, lon) float32 263MB 0.003961 ... 0.008197
    tp_NearestN       (time, lat, lon) float32 263MB 0.1367 0.3987 ... 0.05329
    camr              (time, lat, lon) float32 263MB 0.001835 ... 0.0008634
    ETOPO_consmap_z   (time, lat, lon) float32 263MB 0.0 0.0 0.0 ... 471.2 672.8
    ppt_era5          (time, lat, lon) float32 263MB 0.1367 0.3332 ... 0.05329
    Imerg_orgres      (time, lat, lon) float32 263MB 0.61 1.58 ... 0.145 0.035
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-772d246e-89d0-4492-b9da-edbd81b78b28' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-772d246e-89d0-4492-b9da-edbd81b78b28' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-9beaf263-c3b2-4982-8b19-38e52954c755' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9beaf263-c3b2-4982-8b19-38e52954c755' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-4e06c547-5a83-453b-aa50-48dcb48692d8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e06c547-5a83-453b-aa50-48dcb48692d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-20850daf-18b3-411b-a8f7-8b6902d6f0fe' class='xr-var-data-in' type='checkbox'><label for='data-20850daf-18b3-411b-a8f7-8b6902d6f0fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-e6323b72-f5bd-49a8-a669-3ea350f0c886' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6323b72-f5bd-49a8-a669-3ea350f0c886' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9219ee74-f4ab-48fa-ad7c-40de5d5ff84e' class='xr-var-data-in' type='checkbox'><label for='data-9219ee74-f4ab-48fa-ad7c-40de5d5ff84e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-21e9a7c0-b394-47c8-89c9-1b647389a149' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-21e9a7c0-b394-47c8-89c9-1b647389a149' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0905bd8a-e63c-4371-8fcd-299c3ee38c66' class='xr-var-data-in' type='checkbox'><label for='data-0905bd8a-e63c-4371-8fcd-299c3ee38c66' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-0f28ae15-67a5-4310-a86e-ce1a041382f6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f28ae15-67a5-4310-a86e-ce1a041382f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-841620a5-406e-41ff-aef1-a1a87abee3c9' class='xr-var-data-in' type='checkbox'><label for='data-841620a5-406e-41ff-aef1-a1a87abee3c9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-479ddd34-9c0b-4d09-bd32-5ab166d9277a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-479ddd34-9c0b-4d09-bd32-5ab166d9277a' class='xr-section-summary' >Data variables: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-09b0d502-df00-47ca-babc-54e68be44c20' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-09b0d502-df00-47ca-babc-54e68be44c20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa2aa902-6441-4ea0-8324-95b87a8689cb' class='xr-var-data-in' type='checkbox'><label for='data-fa2aa902-6441-4ea0-8324-95b87a8689cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-5b867579-b8f5-447e-9857-068416aa7891' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b867579-b8f5-447e-9857-068416aa7891' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5416894-0d69-437f-99d5-db8175339526' class='xr-var-data-in' type='checkbox'><label for='data-d5416894-0d69-437f-99d5-db8175339526' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-42a7b1bc-dffb-414b-a436-1a6867189a28' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-42a7b1bc-dffb-414b-a436-1a6867189a28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d3ee0b08-aec9-4e61-a613-e72dc921c65f' class='xr-var-data-in' type='checkbox'><label for='data-d3ee0b08-aec9-4e61-a613-e72dc921c65f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-bb0f27d3-8dbb-40dd-9b18-5f50d5dd65cd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb0f27d3-8dbb-40dd-9b18-5f50d5dd65cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-562e53f8-cc10-421a-b7d7-8ce36a146402' class='xr-var-data-in' type='checkbox'><label for='data-562e53f8-cc10-421a-b7d7-8ce36a146402' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-1a0b828d-2d46-44e4-bc12-ef99c1c599b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1a0b828d-2d46-44e4-bc12-ef99c1c599b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3f9b9f3e-9df3-4d4b-b061-daefdd1b8fea' class='xr-var-data-in' type='checkbox'><label for='data-3f9b9f3e-9df3-4d4b-b061-daefdd1b8fea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-02ebf4c3-b393-41db-992c-337301d433a3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02ebf4c3-b393-41db-992c-337301d433a3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-59dc8024-a439-46f6-972f-f21c4c912355' class='xr-var-data-in' type='checkbox'><label for='data-59dc8024-a439-46f6-972f-f21c4c912355' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7c0022b6-f7cc-4e2f-aae2-a1947fbcac7e' class='xr-section-summary-in' type='checkbox'  ><label for='section-7c0022b6-f7cc-4e2f-aae2-a1947fbcac7e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6fc08d22-ec67-400d-9bd0-b10d05a87cea' class='xr-index-data-in' type='checkbox'/><label for='index-6fc08d22-ec67-400d-9bd0-b10d05a87cea' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-067fbe5b-dade-443e-9f8d-a214b6bc0fd7' class='xr-index-data-in' type='checkbox'/><label for='index-067fbe5b-dade-443e-9f8d-a214b6bc0fd7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3b340564-2db7-4fac-889a-0eed1b7500e9' class='xr-index-data-in' type='checkbox'/><label for='index-3b340564-2db7-4fac-889a-0eed1b7500e9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bb24b4bd-d9f8-48cb-840f-92eb94cd2f35' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bb24b4bd-d9f8-48cb-840f-92eb94cd2f35' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



Seasonal labaling


```python
era5_Imerg['Seasonal Mask'] = xr.where(era5_Imerg['time.month'].isin([12, 1, 2]), 'winter',
    xr.where(era5_Imerg['time.month'].isin([3, 4, 5]), 'spring',
        xr.where(era5_Imerg['time.month'].isin([6, 7, 8]), 'summer',
            xr.where(era5_Imerg['time.month'].isin([9, 10, 11]), 'fall', None))))
era5_Imerg
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:           (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time              (time) datetime64[ns] 58kB 2001-01-01T11:00:00 ... 2020...
  * lon               (lon) float64 1kB 4.05 4.15 4.25 ... 18.75 18.85 18.95
  * lat               (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
    custom_dayofyear  (time) int32 29kB 1 2 3 4 5 6 ... 360 361 362 363 364 365
Data variables:
    tciw              (time, lat, lon) float32 263MB 0.003961 ... 0.008197
    tp_NearestN       (time, lat, lon) float32 263MB 0.1367 0.3987 ... 0.05329
    camr              (time, lat, lon) float32 263MB 0.001835 ... 0.0008634
    ETOPO_consmap_z   (time, lat, lon) float32 263MB 0.0 0.0 0.0 ... 471.2 672.8
    ppt_era5          (time, lat, lon) float32 263MB 0.1367 0.3332 ... 0.05329
    Imerg_orgres      (time, lat, lon) float32 263MB 0.61 1.58 ... 0.145 0.035
    Seasonal Mask     (time) object 58kB &#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27; &#x27;winter&#x27;
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-c74f9374-8f4a-4b6e-81ba-f53d91d8fedb' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c74f9374-8f4a-4b6e-81ba-f53d91d8fedb' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-2c2e68b5-19ce-44bc-9e9c-74aff41d5fef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-2c2e68b5-19ce-44bc-9e9c-74aff41d5fef' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-2f572f20-6fc9-4208-8eb7-a204004bdb8f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2f572f20-6fc9-4208-8eb7-a204004bdb8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1458f20-86a9-4254-9323-ae591c2ccc1d' class='xr-var-data-in' type='checkbox'><label for='data-e1458f20-86a9-4254-9323-ae591c2ccc1d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-6cda9d6b-48eb-43b8-ba90-8256a6bd8619' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6cda9d6b-48eb-43b8-ba90-8256a6bd8619' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1851925f-8960-4d1a-9a9e-4b2d2400f1e5' class='xr-var-data-in' type='checkbox'><label for='data-1851925f-8960-4d1a-9a9e-4b2d2400f1e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-dfc8e0de-d284-4c85-bcf3-1999753aad5e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dfc8e0de-d284-4c85-bcf3-1999753aad5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-94ecb786-47c3-4470-b30b-e1d0442b3a0e' class='xr-var-data-in' type='checkbox'><label for='data-94ecb786-47c3-4470-b30b-e1d0442b3a0e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-550d750d-f561-4f06-a10f-bee0457da3cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-550d750d-f561-4f06-a10f-bee0457da3cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26931105-96fa-4e55-871d-784b8295c750' class='xr-var-data-in' type='checkbox'><label for='data-26931105-96fa-4e55-871d-784b8295c750' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5a9e6d95-503a-446c-9dc1-c7f603ac05fb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5a9e6d95-503a-446c-9dc1-c7f603ac05fb' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-861f9072-e56b-42ef-bd00-b8daad4cae7f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-861f9072-e56b-42ef-bd00-b8daad4cae7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c7e804c-646e-4c8e-9e67-f4d3720141ff' class='xr-var-data-in' type='checkbox'><label for='data-8c7e804c-646e-4c8e-9e67-f4d3720141ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-5504c608-adf7-4cbc-a42f-a8ae5403677e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5504c608-adf7-4cbc-a42f-a8ae5403677e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c750690c-e5da-495a-9f67-832cf39b7cd7' class='xr-var-data-in' type='checkbox'><label for='data-c750690c-e5da-495a-9f67-832cf39b7cd7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-4987ff17-d9f9-461f-82ef-133c95d4dc1f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4987ff17-d9f9-461f-82ef-133c95d4dc1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0c0997b5-f9b2-4251-ac46-05875ae7fd14' class='xr-var-data-in' type='checkbox'><label for='data-0c0997b5-f9b2-4251-ac46-05875ae7fd14' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-57a522f5-fc7f-43dc-aa52-3c51274f60bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-57a522f5-fc7f-43dc-aa52-3c51274f60bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1b6bb3b-0280-431d-9176-f958565e59e3' class='xr-var-data-in' type='checkbox'><label for='data-d1b6bb3b-0280-431d-9176-f958565e59e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-84f8e57f-efcb-4185-8fae-fe48ac284c5d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-84f8e57f-efcb-4185-8fae-fe48ac284c5d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8e5ccc71-5322-4f87-a6b2-892ec1b5138e' class='xr-var-data-in' type='checkbox'><label for='data-8e5ccc71-5322-4f87-a6b2-892ec1b5138e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-02a4a920-2e8d-4552-ab89-c60794c0d0c1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-02a4a920-2e8d-4552-ab89-c60794c0d0c1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f722eb05-fcd7-4bb8-903d-b437998b1fb8' class='xr-var-data-in' type='checkbox'><label for='data-f722eb05-fcd7-4bb8-903d-b437998b1fb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Seasonal Mask</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;</div><input id='attrs-5b07f5f6-8e3d-4d77-be6e-6e6552584eda' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5b07f5f6-8e3d-4d77-be6e-6e6552584eda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c31eba4-0d3e-485e-80fb-7c466f414c0c' class='xr-var-data-in' type='checkbox'><label for='data-2c31eba4-0d3e-485e-80fb-7c466f414c0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;, ..., &#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-21f882a4-6a97-4e9d-973c-445d7cf4870a' class='xr-section-summary-in' type='checkbox'  ><label for='section-21f882a4-6a97-4e9d-973c-445d7cf4870a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ababbe9e-37e9-4de3-aa08-12091927ddbb' class='xr-index-data-in' type='checkbox'/><label for='index-ababbe9e-37e9-4de3-aa08-12091927ddbb' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-973b5958-5a12-4430-a4f6-84b0b1d4646a' class='xr-index-data-in' type='checkbox'/><label for='index-973b5958-5a12-4430-a4f6-84b0b1d4646a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-78b5e87e-89cf-4386-8afa-2bf53765efc1' class='xr-index-data-in' type='checkbox'/><label for='index-78b5e87e-89cf-4386-8afa-2bf53765efc1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ebb2ee41-f1d3-4a26-b89c-86862e2c0e74' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ebb2ee41-f1d3-4a26-b89c-86862e2c0e74' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



Threshold for rain/no rain


```python
Threshold=1 #mm/d

era5_Imerg['Rain/No rain threshold'] = xr.where(era5_Imerg['Imerg_orgres']>Threshold, 1, 0)
era5_Imerg['Imerg P with threshold'] = xr.where(era5_Imerg['Imerg_orgres'] < Threshold, 0, era5_Imerg['Imerg_orgres'])

era5_Imerg
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:                 (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time                    (time) datetime64[ns] 58kB 2001-01-01T11:00:00 .....
  * lon                     (lon) float64 1kB 4.05 4.15 4.25 ... 18.85 18.95
  * lat                     (lat) float64 480B 43.05 43.15 43.25 ... 48.85 48.95
    custom_dayofyear        (time) int32 29kB 1 2 3 4 5 ... 361 362 363 364 365
Data variables:
    tciw                    (time, lat, lon) float32 263MB 0.003961 ... 0.008197
    tp_NearestN             (time, lat, lon) float32 263MB 0.1367 ... 0.05329
    camr                    (time, lat, lon) float32 263MB 0.001835 ... 0.000...
    ETOPO_consmap_z         (time, lat, lon) float32 263MB 0.0 0.0 ... 672.8
    ppt_era5                (time, lat, lon) float32 263MB 0.1367 ... 0.05329
    Imerg_orgres            (time, lat, lon) float32 263MB 0.61 1.58 ... 0.035
    Seasonal Mask           (time) object 58kB &#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;
    Rain/No rain threshold  (time, lat, lon) int32 263MB 0 1 1 1 1 ... 0 0 0 0 0
    Imerg P with threshold  (time, lat, lon) float32 263MB 0.0 1.58 ... 0.0 0.0
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b00ea25b-bc31-4eff-95fb-23ca5b463c24' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b00ea25b-bc31-4eff-95fb-23ca5b463c24' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-00817a6f-d9fd-493a-b339-2b3ef14e10b3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-00817a6f-d9fd-493a-b339-2b3ef14e10b3' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-8713b329-3ca8-4950-a56d-7a898e784b33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8713b329-3ca8-4950-a56d-7a898e784b33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f61ce07-9663-4c8e-a24f-e2c78b3cef9a' class='xr-var-data-in' type='checkbox'><label for='data-8f61ce07-9663-4c8e-a24f-e2c78b3cef9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-2a7f9b5b-5e42-4030-a2ec-b206803ead47' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2a7f9b5b-5e42-4030-a2ec-b206803ead47' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-54327ab9-d677-4ef1-968d-2049632232b0' class='xr-var-data-in' type='checkbox'><label for='data-54327ab9-d677-4ef1-968d-2049632232b0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-bd350dad-5341-483f-83c7-0566ba6fbf25' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-bd350dad-5341-483f-83c7-0566ba6fbf25' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-280048c2-c9e4-41b3-b34e-199104e5a9ce' class='xr-var-data-in' type='checkbox'><label for='data-280048c2-c9e4-41b3-b34e-199104e5a9ce' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-729187ad-fbcc-443d-ab80-b69a32a05883' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-729187ad-fbcc-443d-ab80-b69a32a05883' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b99d80e4-6f90-4a8a-a854-bec76b37c0be' class='xr-var-data-in' type='checkbox'><label for='data-b99d80e4-6f90-4a8a-a854-bec76b37c0be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-737405ff-1269-4783-a6e4-cc35a32f5d83' class='xr-section-summary-in' type='checkbox'  checked><label for='section-737405ff-1269-4783-a6e4-cc35a32f5d83' class='xr-section-summary' >Data variables: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-f74fe7ee-96dd-4338-bb7d-093bc0f43916' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f74fe7ee-96dd-4338-bb7d-093bc0f43916' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11f1e255-c393-4eb0-8259-3b5865548631' class='xr-var-data-in' type='checkbox'><label for='data-11f1e255-c393-4eb0-8259-3b5865548631' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-1833f37b-02bb-4718-9c89-da4c841d6860' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1833f37b-02bb-4718-9c89-da4c841d6860' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b47210bb-e772-42be-ab18-46149f460c55' class='xr-var-data-in' type='checkbox'><label for='data-b47210bb-e772-42be-ab18-46149f460c55' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-b52e228d-a142-4b6a-b620-1220a85178c8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b52e228d-a142-4b6a-b620-1220a85178c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c104d13-c6b4-48c2-9a96-398fd715b2b2' class='xr-var-data-in' type='checkbox'><label for='data-9c104d13-c6b4-48c2-9a96-398fd715b2b2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-f09cd392-236e-4341-a84d-26356c8c7e16' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f09cd392-236e-4341-a84d-26356c8c7e16' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-06f9fb4c-d32c-42a9-95ff-4061a35947d5' class='xr-var-data-in' type='checkbox'><label for='data-06f9fb4c-d32c-42a9-95ff-4061a35947d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-cfbb6bf9-c542-40c5-80d9-3c66dfb11b80' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cfbb6bf9-c542-40c5-80d9-3c66dfb11b80' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d6d0564e-1a98-4c30-acd2-6b0ffae7bf39' class='xr-var-data-in' type='checkbox'><label for='data-d6d0564e-1a98-4c30-acd2-6b0ffae7bf39' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-3f462d76-0a39-497a-858d-ed89e1fb9c6a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f462d76-0a39-497a-858d-ed89e1fb9c6a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89205669-d64a-425b-8d9b-a16c885f9487' class='xr-var-data-in' type='checkbox'><label for='data-89205669-d64a-425b-8d9b-a16c885f9487' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Seasonal Mask</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;</div><input id='attrs-253ddcbf-e8b2-49ca-93a6-b11aa7b37310' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-253ddcbf-e8b2-49ca-93a6-b11aa7b37310' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-878edf77-7d77-48b1-a58f-a83f33321b88' class='xr-var-data-in' type='checkbox'><label for='data-878edf77-7d77-48b1-a58f-a83f33321b88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;, ..., &#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Rain/No rain threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 1 1 1 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-1f4372f8-8378-474e-820f-6ee07737371d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1f4372f8-8378-474e-820f-6ee07737371d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36ab113b-c564-4fe2-af44-e77b4153d8b8' class='xr-var-data-in' type='checkbox'><label for='data-36ab113b-c564-4fe2-af44-e77b4153d8b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0, 1, 1, ..., 0, 0, 0],
        [0, 0, 1, ..., 0, 0, 0],
        [0, 1, 1, ..., 0, 1, 1],
        ...,
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0]],

       [[0, 1, 1, ..., 1, 0, 0],
        [1, 1, 0, ..., 0, 1, 1],
        [1, 1, 0, ..., 1, 1, 0],
        ...,
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
...
        ...,
        [1, 1, 0, ..., 1, 1, 1],
        [1, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 1, 0, 0]],

       [[0, 0, 0, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [0, 1, 1, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg P with threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 1.58 2.02 2.445 ... 0.0 0.0 0.0</div><input id='attrs-455eac1e-14d5-4da0-ab96-7017a8f0c724' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-455eac1e-14d5-4da0-ab96-7017a8f0c724' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43876e4b-1356-4441-85fe-6f9ce0acf053' class='xr-var-data-in' type='checkbox'><label for='data-43876e4b-1356-4441-85fe-6f9ce0acf053' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.       ,  1.5799999,  2.02     , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  1.215    , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  1.1899999,  2.205    , ...,  0.       ,
          3.56     ,  5.9649997],
        ...,
        [16.609999 , 15.525002 , 17.244999 , ...,  0.       ,
          0.       ,  0.       ],
        [17.24     , 17.229998 , 18.01     , ...,  0.       ,
          0.       ,  0.       ],
        [18.300001 , 18.12     , 16.42     , ...,  0.       ,
          0.       ,  0.       ]],

       [[ 0.       ,  1.1249999,  1.2649999, ...,  2.3      ,
          0.       ,  0.       ],
        [ 1.115    ,  1.38     ,  0.       , ...,  0.       ,
          1.0799999,  1.255    ],
        [ 1.255    ,  1.375    ,  0.       , ...,  2.2599998,
          2.375    ,  0.       ],
...
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          2.69     ,  1.6500001],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  1.2099999,
          0.       ,  0.       ]],

       [[ 0.       ,  0.       ,  0.       , ..., 21.639997 ,
         10.12     ,  5.62     ],
        [ 1.135    ,  1.9250002,  1.6949999, ..., 24.25     ,
         19.095    ,  8.845    ],
        [ 0.       ,  2.0149999,  3.54     , ..., 15.814999 ,
         19.75     , 14.844999 ],
        ...,
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-461cece7-b1e6-4544-8e37-7c0e06c3933a' class='xr-section-summary-in' type='checkbox'  ><label for='section-461cece7-b1e6-4544-8e37-7c0e06c3933a' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ba081d09-d2ae-4ddf-a38a-46549ec3bf61' class='xr-index-data-in' type='checkbox'/><label for='index-ba081d09-d2ae-4ddf-a38a-46549ec3bf61' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-387ab87a-3098-43b6-89e7-c381c99197f4' class='xr-index-data-in' type='checkbox'/><label for='index-387ab87a-3098-43b6-89e7-c381c99197f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-162d6d32-4236-4dbf-9f10-4c20bbb4423d' class='xr-index-data-in' type='checkbox'/><label for='index-162d6d32-4236-4dbf-9f10-4c20bbb4423d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-83501876-d705-462d-8975-424860e8d338' class='xr-section-summary-in' type='checkbox'  checked><label for='section-83501876-d705-462d-8975-424860e8d338' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



Necessary for plot


```python
era5_long = era5_Imerg.variables["lon"][:]
era5_lat  = era5_Imerg.variables["lat"][:]
era5_elev= era5_Imerg['ETOPO_consmap_z'][0,:,:]

```

QI


```python
data_dir = "C:/Iman/Maxm/QI_CDO"
file_list = [os.path.join(data_dir, f) for f in os.listdir(data_dir) if f.endswith('.nc4')]
ds_QI_hour = xr.open_mfdataset(file_list,combine='by_coords',chunks={'time': 24}, parallel=True,cache=False)

# Optional: print file count and size info
print(f"Found {len(file_list)} .nc4 files.")
print(f"First file size: {os.path.getsize(file_list[0]) / (1024**2):.2f} MB")

############################################################
ds_QI_hour=ds_QI_hour.drop_vars('time_bnds')
ds_QI_hour=ds_QI_hour.compute()
ds_QI_hour['lat'] = ds_QI_hour['lat'].round(2).astype(float)
ds_QI_hour['lon'] = ds_QI_hour['lon'].round(2).astype(float)
##########################################################
ds_QI_resamp = ds_QI_hour.resample(time='1D').mean()
###########################################################
#starting from 2001 to be compatible with era5_Imerg
ds_QI_resamp = ds_QI_resamp.sel(time=slice('2001', None))
#Transpose 
ds_QI_resamp=ds_QI_resamp.transpose('time', 'lat', 'lon')
#removing 29th of Feb to have a same data for all years
ds_QI_resamp = ds_QI_resamp.sel(time=~((ds_QI_resamp['time'].dt.month == 2) & (ds_QI_resamp['time'].dt.day == 29)))
# Create a custom list of 365 day indices (or labels)
custom_dayofyear = np.tile(np.arange(1, 366), len(np.unique(ds_QI_resamp['time'].dt.year.values)))
# Assign this custom day index as a new coordinate
ds_QI_resamp = ds_QI_resamp.assign_coords(custom_dayofyear=("time", custom_dayofyear))
# round the long, lat a constant number
ds_QI_resamp['lat'] = ds_QI_resamp['lat'].round(2).astype(float)
ds_QI_resamp['lon'] =ds_QI_resamp['lon'].round(2).astype(float)

ds_QI_resamp
```

    Found 252 .nc4 files.
    First file size: 25.66 MB





<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 263MB
Dimensions:                    (time: 7300, lat: 60, lon: 150)
Coordinates:
  * lon                        (lon) float64 1kB 4.05 4.15 4.25 ... 18.85 18.95
  * lat                        (lat) float64 480B 43.05 43.15 ... 48.85 48.95
  * time                       (time) datetime64[ns] 58kB 2001-01-01 ... 2020...
    custom_dayofyear           (time) int32 29kB 1 2 3 4 5 ... 362 363 364 365
Data variables:
    precipitationQualityIndex  (time, lat, lon) float32 263MB 0.6412 ... 0.7227
Attributes:
    CDI:                                    Climate Data Interface version 2....
    Conventions:                            CF-1.6
    Original_Producer_Metadata_FileHeader:  DOI=10.5067/GPM/IMERG/3B-HH/07;\n...
    Original_Producer_Metadata_FileInfo:    DataFormatVersion=7e;\nTKCodeBuil...
    Original_Producer_Metadata_GridHeader:  BinMethod=ARITHMETIC_MEAN;\nRegis...
    InputPointer:                           3B-HHR.MS.MRG.3IMERG.20000101-S00...
    history_L34RS:                          &#x27;Created by L34RS v1.4.4 @ NASA G...
    history:                                Fri May 23 15:00:32 2025: cdo -b ...
    CDO:                                    Climate Data Operators version 2....</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8d630424-1329-48d6-80ea-d8a4a4c2bd50' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8d630424-1329-48d6-80ea-d8a4a4c2bd50' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lat</span>: 60</li><li><span class='xr-has-index'>lon</span>: 150</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-df209aca-98a9-47b3-b11a-95f8600c5f58' class='xr-section-summary-in' type='checkbox'  checked><label for='section-df209aca-98a9-47b3-b11a-95f8600c5f58' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-bde09991-5010-4899-8419-ceeeb6399307' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bde09991-5010-4899-8419-ceeeb6399307' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cc3cb372-c9d2-4812-baa2-8d37a71cf6ff' class='xr-var-data-in' type='checkbox'><label for='data-cc3cb372-c9d2-4812-baa2-8d37a71cf6ff' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-20652c79-8d32-4c86-8ef3-b01e1a907445' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-20652c79-8d32-4c86-8ef3-b01e1a907445' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ed70d6a-219a-4c11-95da-3c02521bae4e' class='xr-var-data-in' type='checkbox'><label for='data-6ed70d6a-219a-4c11-95da-3c02521bae4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-31</div><input id='attrs-671f3d78-a234-4e4e-b2af-c4938468487d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-671f3d78-a234-4e4e-b2af-c4938468487d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-400c32cb-b7b8-4475-8cb4-e233053ae73c' class='xr-var-data-in' type='checkbox'><label for='data-400c32cb-b7b8-4475-8cb4-e233053ae73c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-01-02T00:00:00.000000000&#x27;,
       &#x27;2001-01-03T00:00:00.000000000&#x27;, ..., &#x27;2020-12-29T00:00:00.000000000&#x27;,
       &#x27;2020-12-30T00:00:00.000000000&#x27;, &#x27;2020-12-31T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-a1e5cdbe-a8c7-4040-96fe-743bbcb55023' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a1e5cdbe-a8c7-4040-96fe-743bbcb55023' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0539e8f5-12d8-4a1d-aa9b-19706670c164' class='xr-var-data-in' type='checkbox'><label for='data-0539e8f5-12d8-4a1d-aa9b-19706670c164' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7c5b5434-9aac-4519-a4d5-62092a9eec3c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7c5b5434-9aac-4519-a4d5-62092a9eec3c' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>precipitationQualityIndex</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.6412 0.6368 ... 0.7227 0.7227</div><input id='attrs-fb9ecb96-2327-4924-b866-e8e0ccf5383a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fb9ecb96-2327-4924-b866-e8e0ccf5383a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6e148b2-a9fc-4bec-89bb-f78931409b3f' class='xr-var-data-in' type='checkbox'><label for='data-c6e148b2-a9fc-4bec-89bb-f78931409b3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>DimensionNames :</span></dt><dd>time,lon,lat</dd><dt><span>CodeMissingValue :</span></dt><dd>-9999.9</dd><dt><span>LongName :</span></dt><dd>
Precipitation quality index; qualitative indicator
                        of skill based on the microwave-infrared merging process
</dd></dl></div><div class='xr-var-data'><pre>array([[[0.64120835, 0.63681257, 0.63681257, ..., 0.35652086,
         0.35514584, 0.63293755],
        [0.64385426, 0.64385426, 0.6419167 , ..., 0.3548125 ,
         0.6085208 , 0.35270834],
        [0.6399168 , 0.6399168 , 0.6379792 , ..., 0.34964585,
         0.63293755, 0.35514584],
        ...,
        [0.5837709 , 0.5837709 , 0.579625  , ..., 0.58214587,
         0.36610416, 0.36610416],
        [0.5837709 , 0.5837709 , 0.58064586, ..., 0.3666875 ,
         0.36610416, 0.36589587],
        [0.5852917 , 0.5811458 , 0.58064586, ..., 0.3666875 ,
         0.36589584, 0.36568752]],

       [[0.6909583 , 0.69037503, 0.69037503, ..., 0.5888542 ,
         0.3633542 , 0.5888542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.3633542 ,
         0.5888542 , 0.3633542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.5888542 ,
         0.5888542 , 0.3633542 ],
...
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.7248542 ,
         0.7247917 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72572917,
         0.7250208 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72775   ,
         0.72572917, 0.72554165]],

       [[0.7024792 , 0.6986251 , 0.6899584 , ..., 0.707375  ,
         0.37502083, 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.707375  ],
        ...,
        [0.7012709 , 0.7006251 , 0.70210415, ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7039167 , 0.70210415, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7019376 , 0.70308334, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-baa7fd18-9758-4527-8d97-7fdefa72494e' class='xr-section-summary-in' type='checkbox'  ><label for='section-baa7fd18-9758-4527-8d97-7fdefa72494e' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-7326a1e6-f888-490a-a114-02dc4508f193' class='xr-index-data-in' type='checkbox'/><label for='index-7326a1e6-f888-490a-a114-02dc4508f193' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e029f8b2-172d-44d8-a6b4-e8dd3c696880' class='xr-index-data-in' type='checkbox'/><label for='index-e029f8b2-172d-44d8-a6b4-e8dd3c696880' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cc381af8-61ab-445c-93f1-c5d37c613e67' class='xr-index-data-in' type='checkbox'/><label for='index-cc381af8-61ab-445c-93f1-c5d37c613e67' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01&#x27;, &#x27;2001-01-02&#x27;, &#x27;2001-01-03&#x27;, &#x27;2001-01-04&#x27;,
               &#x27;2001-01-05&#x27;, &#x27;2001-01-06&#x27;, &#x27;2001-01-07&#x27;, &#x27;2001-01-08&#x27;,
               &#x27;2001-01-09&#x27;, &#x27;2001-01-10&#x27;,
               ...
               &#x27;2020-12-22&#x27;, &#x27;2020-12-23&#x27;, &#x27;2020-12-24&#x27;, &#x27;2020-12-25&#x27;,
               &#x27;2020-12-26&#x27;, &#x27;2020-12-27&#x27;, &#x27;2020-12-28&#x27;, &#x27;2020-12-29&#x27;,
               &#x27;2020-12-30&#x27;, &#x27;2020-12-31&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e900556d-596b-434e-857d-ba989c41ce07' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e900556d-596b-434e-857d-ba989c41ce07' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>Original_Producer_Metadata_FileHeader :</span></dt><dd>DOI=10.5067/GPM/IMERG/3B-HH/07;
DOIauthority=http://dx.doi.org/;
DOIshortName=3IMERGHH;
AlgorithmID=3IMERGHH;
AlgorithmVersion=3IMERGH_7.0;
FileName=3B-HHR.MS.MRG.3IMERG.20000101-S000000-E002959.0000.V07B.HDF5;
SatelliteName=MULTI;
InstrumentName=MERGED;
GenerationDateTime=2024-11-02T09:14:12.000Z;
StartGranuleDateTime=2000-01-01T00:00:00.000Z;
StopGranuleDateTime=2000-01-01T00:29:59.999Z;
GranuleNumber=;
NumberOfSwaths=0;
NumberOfGrids=1;
GranuleStart=;
TimeInterval=HALF_HOUR;
ProcessingSystem=PPS;
ProductVersion=V07B;
EmptyGranule=NOT_EMPTY;
MissingData=;
</dd><dt><span>Original_Producer_Metadata_FileInfo :</span></dt><dd>DataFormatVersion=7e;
TKCodeBuildVersion=0;
MetadataVersion=7e;
FormatPackage=HDF5-1.10.9;
BlueprintFilename=GPM.V7.3IMERGHH.blueprint.xml;
BlueprintVersion=BV_69;
TKIOVersion=3.101;
MetadataStyle=PVL;
EndianType=LITTLE_ENDIAN;
</dd><dt><span>Original_Producer_Metadata_GridHeader :</span></dt><dd>BinMethod=ARITHMETIC_MEAN;
Registration=CENTER;
LatitudeResolution=0.1;
LongitudeResolution=0.1;
NorthBoundingCoordinate=90;
SouthBoundingCoordinate=-90;
EastBoundingCoordinate=180;
WestBoundingCoordinate=-180;
Origin=SOUTHWEST;
</dd><dt><span>InputPointer :</span></dt><dd>3B-HHR.MS.MRG.3IMERG.20000101-S000000-E002959.0000.V07B.HDF5</dd><dt><span>history_L34RS :</span></dt><dd>&#x27;Created by L34RS v1.4.4 @ NASA GES DISC on April 27 2025 09:21:53. Variables: precipitationQualityIndex&#x27;</dd><dt><span>history :</span></dt><dd>Fri May 23 15:00:32 2025: cdo -b F32 -sellonlatbox,4,19,43,49 /himalaya/IMERG/qIndex_Hourly/3B-HHR.MS.MRG.3IMERG.200001.V07B.HDF5.SUB.nc4 /andes/iman/QI_CDO/CDO_3B-HHR.MS.MRG.3IMERG.200001.V07B.HDF5.SUB.nc4</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
#make the hour of day same
ds_QI_resamp['time'] = era5_Imerg['time']
#mere resampled QI into our era5-Imerg
era5_Imerg = xr.merge([era5_Imerg, ds_QI_resamp])
era5_Imerg
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 2GB
Dimensions:                    (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time                       (time) datetime64[ns] 58kB 2001-01-01T11:00:00...
  * lon                        (lon) float64 1kB 4.05 4.15 4.25 ... 18.85 18.95
  * lat                        (lat) float64 480B 43.05 43.15 ... 48.85 48.95
    custom_dayofyear           (time) int32 29kB 1 2 3 4 5 ... 362 363 364 365
Data variables:
    tciw                       (time, lat, lon) float32 263MB 0.003961 ... 0....
    tp_NearestN                (time, lat, lon) float32 263MB 0.1367 ... 0.05329
    camr                       (time, lat, lon) float32 263MB 0.001835 ... 0....
    ETOPO_consmap_z            (time, lat, lon) float32 263MB 0.0 0.0 ... 672.8
    ppt_era5                   (time, lat, lon) float32 263MB 0.1367 ... 0.05329
    Imerg_orgres               (time, lat, lon) float32 263MB 0.61 ... 0.035
    Seasonal Mask              (time) object 58kB &#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;
    Rain/No rain threshold     (time, lat, lon) int32 263MB 0 1 1 1 ... 0 0 0 0
    Imerg P with threshold     (time, lat, lon) float32 263MB 0.0 1.58 ... 0.0
    precipitationQualityIndex  (time, lat, lon) float32 263MB 0.6412 ... 0.7227
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-2e266337-4c58-4a0c-b4bd-3d28ade88536' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-2e266337-4c58-4a0c-b4bd-3d28ade88536' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ada6a10e-f407-4b3e-9c00-8dd4b4f44347' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ada6a10e-f407-4b3e-9c00-8dd4b4f44347' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-1392485c-8b75-42d1-8747-e3115041dc30' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1392485c-8b75-42d1-8747-e3115041dc30' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c9b55f9-e9a7-4269-986f-a733ccf3fdd6' class='xr-var-data-in' type='checkbox'><label for='data-5c9b55f9-e9a7-4269-986f-a733ccf3fdd6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-cafd93c0-9bcb-457f-935d-84aa7aab0db0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cafd93c0-9bcb-457f-935d-84aa7aab0db0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1821b91e-ed7c-47e6-948c-d073dd55d1ed' class='xr-var-data-in' type='checkbox'><label for='data-1821b91e-ed7c-47e6-948c-d073dd55d1ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-79806671-def7-4819-992a-b388310f7dee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-79806671-def7-4819-992a-b388310f7dee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ba47683-0bcb-45ea-8bce-76cd89637525' class='xr-var-data-in' type='checkbox'><label for='data-1ba47683-0bcb-45ea-8bce-76cd89637525' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-2b325074-3f8b-4537-a9dd-2e50c0670c5c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2b325074-3f8b-4537-a9dd-2e50c0670c5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3507b83d-0526-4813-b303-1b55873d2ca6' class='xr-var-data-in' type='checkbox'><label for='data-3507b83d-0526-4813-b303-1b55873d2ca6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0cc86bbc-6d9a-4ead-a5f0-f063e251f69b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0cc86bbc-6d9a-4ead-a5f0-f063e251f69b' class='xr-section-summary' >Data variables: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-2d85cff7-ef4d-445b-85f1-e8753fbfb483' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2d85cff7-ef4d-445b-85f1-e8753fbfb483' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-351a33f8-5cc1-46a5-866e-12fabc95d85b' class='xr-var-data-in' type='checkbox'><label for='data-351a33f8-5cc1-46a5-866e-12fabc95d85b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-77da3a74-cb08-4384-abba-620a7cfd0a44' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-77da3a74-cb08-4384-abba-620a7cfd0a44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b12d7b6c-9d0a-4490-8a42-9d025979e106' class='xr-var-data-in' type='checkbox'><label for='data-b12d7b6c-9d0a-4490-8a42-9d025979e106' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-ec9dbab5-1901-44bc-b3c7-39a1f1fc1694' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec9dbab5-1901-44bc-b3c7-39a1f1fc1694' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b3333c4d-0f59-41f1-ab3b-286975071262' class='xr-var-data-in' type='checkbox'><label for='data-b3333c4d-0f59-41f1-ab3b-286975071262' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-32860b93-9eb6-403f-b9d2-fec753d9cd87' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-32860b93-9eb6-403f-b9d2-fec753d9cd87' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-915e636e-a56e-46de-b6cd-2b8b36e1151f' class='xr-var-data-in' type='checkbox'><label for='data-915e636e-a56e-46de-b6cd-2b8b36e1151f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-7c670696-995d-4b6c-a5cf-6b80b5f272e5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7c670696-995d-4b6c-a5cf-6b80b5f272e5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5477633c-5f00-4367-9534-64a9bcd83c88' class='xr-var-data-in' type='checkbox'><label for='data-5477633c-5f00-4367-9534-64a9bcd83c88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-d2903ab0-f7e5-4095-8c68-4cbe94226ca8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d2903ab0-f7e5-4095-8c68-4cbe94226ca8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2e892bd-5b23-4d20-9126-4b35a9394e43' class='xr-var-data-in' type='checkbox'><label for='data-d2e892bd-5b23-4d20-9126-4b35a9394e43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Seasonal Mask</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;</div><input id='attrs-6cbfa1b4-ed89-4645-bfbc-368240662154' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6cbfa1b4-ed89-4645-bfbc-368240662154' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-46163a8d-bf16-4a43-b8d5-d15163ea413b' class='xr-var-data-in' type='checkbox'><label for='data-46163a8d-bf16-4a43-b8d5-d15163ea413b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;, ..., &#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Rain/No rain threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 1 1 1 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-01ee8a40-524e-49ce-b43a-62dd2026ea6f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-01ee8a40-524e-49ce-b43a-62dd2026ea6f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08878c5a-3d66-4eb3-beab-691134f32e0a' class='xr-var-data-in' type='checkbox'><label for='data-08878c5a-3d66-4eb3-beab-691134f32e0a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0, 1, 1, ..., 0, 0, 0],
        [0, 0, 1, ..., 0, 0, 0],
        [0, 1, 1, ..., 0, 1, 1],
        ...,
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0]],

       [[0, 1, 1, ..., 1, 0, 0],
        [1, 1, 0, ..., 0, 1, 1],
        [1, 1, 0, ..., 1, 1, 0],
        ...,
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
...
        ...,
        [1, 1, 0, ..., 1, 1, 1],
        [1, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 1, 0, 0]],

       [[0, 0, 0, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [0, 1, 1, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg P with threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 1.58 2.02 2.445 ... 0.0 0.0 0.0</div><input id='attrs-f4492358-f497-4080-839b-8c73cea47c7d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f4492358-f497-4080-839b-8c73cea47c7d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2526b7f7-1c69-4a80-a7ee-1288752d0114' class='xr-var-data-in' type='checkbox'><label for='data-2526b7f7-1c69-4a80-a7ee-1288752d0114' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.       ,  1.5799999,  2.02     , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  1.215    , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  1.1899999,  2.205    , ...,  0.       ,
          3.56     ,  5.9649997],
        ...,
        [16.609999 , 15.525002 , 17.244999 , ...,  0.       ,
          0.       ,  0.       ],
        [17.24     , 17.229998 , 18.01     , ...,  0.       ,
          0.       ,  0.       ],
        [18.300001 , 18.12     , 16.42     , ...,  0.       ,
          0.       ,  0.       ]],

       [[ 0.       ,  1.1249999,  1.2649999, ...,  2.3      ,
          0.       ,  0.       ],
        [ 1.115    ,  1.38     ,  0.       , ...,  0.       ,
          1.0799999,  1.255    ],
        [ 1.255    ,  1.375    ,  0.       , ...,  2.2599998,
          2.375    ,  0.       ],
...
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          2.69     ,  1.6500001],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  1.2099999,
          0.       ,  0.       ]],

       [[ 0.       ,  0.       ,  0.       , ..., 21.639997 ,
         10.12     ,  5.62     ],
        [ 1.135    ,  1.9250002,  1.6949999, ..., 24.25     ,
         19.095    ,  8.845    ],
        [ 0.       ,  2.0149999,  3.54     , ..., 15.814999 ,
         19.75     , 14.844999 ],
        ...,
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitationQualityIndex</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.6412 0.6368 ... 0.7227 0.7227</div><input id='attrs-aee41c76-fcbb-40f9-964f-f798337d62bf' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aee41c76-fcbb-40f9-964f-f798337d62bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e631faac-d523-4912-ad8f-10663c83f393' class='xr-var-data-in' type='checkbox'><label for='data-e631faac-d523-4912-ad8f-10663c83f393' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>DimensionNames :</span></dt><dd>time,lon,lat</dd><dt><span>CodeMissingValue :</span></dt><dd>-9999.9</dd><dt><span>LongName :</span></dt><dd>
Precipitation quality index; qualitative indicator
                        of skill based on the microwave-infrared merging process
</dd></dl></div><div class='xr-var-data'><pre>array([[[0.64120835, 0.63681257, 0.63681257, ..., 0.35652086,
         0.35514584, 0.63293755],
        [0.64385426, 0.64385426, 0.6419167 , ..., 0.3548125 ,
         0.6085208 , 0.35270834],
        [0.6399168 , 0.6399168 , 0.6379792 , ..., 0.34964585,
         0.63293755, 0.35514584],
        ...,
        [0.5837709 , 0.5837709 , 0.579625  , ..., 0.58214587,
         0.36610416, 0.36610416],
        [0.5837709 , 0.5837709 , 0.58064586, ..., 0.3666875 ,
         0.36610416, 0.36589587],
        [0.5852917 , 0.5811458 , 0.58064586, ..., 0.3666875 ,
         0.36589584, 0.36568752]],

       [[0.6909583 , 0.69037503, 0.69037503, ..., 0.5888542 ,
         0.3633542 , 0.5888542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.3633542 ,
         0.5888542 , 0.3633542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.5888542 ,
         0.5888542 , 0.3633542 ],
...
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.7248542 ,
         0.7247917 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72572917,
         0.7250208 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72775   ,
         0.72572917, 0.72554165]],

       [[0.7024792 , 0.6986251 , 0.6899584 , ..., 0.707375  ,
         0.37502083, 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.707375  ],
        ...,
        [0.7012709 , 0.7006251 , 0.70210415, ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7039167 , 0.70210415, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7019376 , 0.70308334, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-dfe5cd43-6eb1-48f8-bb0d-ae5e90f37527' class='xr-section-summary-in' type='checkbox'  ><label for='section-dfe5cd43-6eb1-48f8-bb0d-ae5e90f37527' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-db0c6e9f-0622-4dc7-aaeb-d5654b39625a' class='xr-index-data-in' type='checkbox'/><label for='index-db0c6e9f-0622-4dc7-aaeb-d5654b39625a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1d8bba84-039c-4985-80b6-764074366623' class='xr-index-data-in' type='checkbox'/><label for='index-1d8bba84-039c-4985-80b6-764074366623' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-6bdd545f-ef9b-4e84-b44e-77b9c5f77592' class='xr-index-data-in' type='checkbox'/><label for='index-6bdd545f-ef9b-4e84-b44e-77b9c5f77592' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-082471bd-a5db-47f2-b409-991fb3a71821' class='xr-section-summary-in' type='checkbox'  checked><label for='section-082471bd-a5db-47f2-b409-991fb3a71821' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:44:23 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/total_column_cloud_ice_water_daymean_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/total_column_cloud_ice_water_daymean_2001_NearestN.nc
Sun Aug 04 14:09:24 2024: cdo -b F32 -daymean -selname,tciw /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_total_column_cloud_ice_water_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/total_column_cloud_ice_water_daymean_2001.nc
2024-08-03 23:45:11 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722728687.3459039-16546-6-540f5a48-27a5-4d5e-92ac-07fec95924ca.nc /cache/tmp/540f5a48-27a5-4d5e-92ac-07fec95924ca-adaptor.mars.internal-1722727843.1132894-16546-7-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



<h2> Visualization of variables</h2>


```python
selected_time='2002-11-09'
excluded_vars = ["Rain/No rain threshold","Imerg P with threshold","tp_NearestN","Seasonal Mask"]
included_vars = [var for var in era5_Imerg.data_vars if var not in excluded_vars]

for var in included_vars:
    fig = plt.figure(figsize=(14, 4))
    unit=era5_Imerg[var].attrs.get('units', 'unitless')
    vars_positive = ['totalx', 'tp_NearestN'] #'cape', 'tclw', 'tciw', 'tcwv', 'totalx', 'swvl1', 'tp_NearestN', 'q2m','bs'
    data = era5_Imerg[var].sel(time=selected_time)[0,:,:]
    
    
    if var in vars_positive:
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} ({unit})', m_unit='', chosen_map="GnBu", vmin=0)
    
    
    elif var == 'WVT':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (m/s)', m_unit='', chosen_map="GnBu")
    elif var == 'vo':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (1/s)', m_unit='', chosen_map="GnBu")
    elif var == 'w':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (Pa/s)', m_unit='', chosen_map="GnBu")
    elif var == 'u' or var == 'u10' or var == 'v' or var == 'v10':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (m/s)', m_unit='', chosen_map="GnBu")
    elif var == 'vinwvf' or var == 'viewvf':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (kg/m.s)', m_unit='', chosen_map="GnBu")
    elif var == 'mslhf' or var == 'msshf':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=fr'{var} (w/m$^2$)', m_unit='', chosen_map="GnBu")
    elif var == 'mvimd':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat, title_fig=f'{var} (kg/m$^2$.s)', m_unit='', chosen_map="GnBu")
        
        
        
    
    
    elif var == 'bs':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} (m/s)', m_unit='', chosen_map="GnBu", vmin=0)
        
    elif var == 'q2m':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} (kg/kg)', m_unit='', chosen_map="GnBu", vmin=0)
        
    elif var == 'cape':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} (j/kg)', m_unit='', chosen_map="GnBu", vmin=0)
        
    elif var == 'swvl1':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=fr'{var} (m$^3$/m$^3$)', m_unit='', chosen_map="GnBu", vmin=0)
        
    elif var == 'tclw' or var == 'tciw' or var == 'tcwv':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=fr'{var} (kg/m$^2$)', m_unit='', chosen_map="GnBu", vmin=0)
        
    elif var == 'd2m' or var == 't2m':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} ({unit})', m_unit='', chosen_map="GnBu", vmin=250, vmax=300)

    elif var == 'sp':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} ({unit})', m_unit='', chosen_map="GnBu", vmin=80000, vmax=100000)

    elif var == 'tisr':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=fr'{var} (j/m$^2$)', m_unit='', chosen_map="GnBu", vmin=500000, vmax=900000)

    elif var == 't':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} ({unit})', m_unit='', chosen_map="GnBu", vmin=250, vmax=280)
        
    elif var == 'Imerg_orgres':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                title_fig=f'IMERG ppt ({unit})', m_unit='', chosen_map="Blues", vmin=0)
    
    elif var == 'ppt_era5':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                title_fig=f'ERA5 ppt ({unit})', m_unit='', chosen_map="Blues", vmin=0)
    
    elif var == 'ETOPO_consmap_z':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                title_fig=f'ETOPO (m)', m_unit='', chosen_map="terrain", vmin=0)
        
    elif var == 'camr':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                title_fig=f'camr (kg/kg)', m_unit='', chosen_map="GnBu", vmin=0)
    
    elif var == 'precipitationQualityIndex':
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                title_fig=f'QI (unitless)', m_unit='', chosen_map="GnBu", vmin=0)
        
    else:
        map_m_fig(fig, data.values, era5_elev, era5_long, era5_lat,
                  title_fig=f'{var} ({unit})', m_unit='', chosen_map="GnBu")
        

```


    
![png](output_28_0.png)
    



    
![png](output_28_1.png)
    



    
![png](output_28_2.png)
    



    
![png](output_28_3.png)
    



    
![png](output_28_4.png)
    



    
![png](output_28_5.png)
    



```python
mask= (era5_Imerg['precipitationQualityIndex'] >= 0.6)
    
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["Imerg_orgres"].where(mask,drop=True).mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'IMERG Precipitation Mean', m_unit=era5_Imerg["Imerg_orgres"].attrs.get('units', 'unitless'), chosen_map="Blues", vmin=0, vmax=8)
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["ETOPO_consmap_z"].mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'Elevation', m_unit=era5_Imerg["ETOPO_consmap_z"].attrs.get('units', 'unitless'), chosen_map="terrain", vmin=0)
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["precipitationQualityIndex"].mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'IMERG Quality Index Mean', m_unit=era5_Imerg["precipitationQualityIndex"].attrs.get('units', 'unitless'), chosen_map="viridis", vmin=0)
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["ppt_era5"].where(mask,drop=True).mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'ERA5 Precipitation Mean', m_unit=era5_Imerg["ppt_era5"].attrs.get('units', 'unitless'), chosen_map="Blues", vmin=0, vmax=8)
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["camr"].where(mask,drop=True).mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'Camr Mean', m_unit=era5_Imerg["camr"].attrs.get('units', 'unitless'), chosen_map="GnBu", vmin=0)
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["tciw"].where(mask,drop=True).mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'Tciw Mean', m_unit=era5_Imerg["tciw"].attrs.get('units', 'unitless'), chosen_map="GnBu", vmin=0)

```


```python
x = era5_Imerg['ETOPO_consmap_z'].values.flatten()  #
y = era5_Imerg['precipitationQualityIndex'].values.flatten()

# Plot hexbin + linear regression
plt.figure(figsize=(7, 5))
plt.hexbin(x, y, mincnt=1, gridsize=2000, bins='log', cmap='inferno')  # mincnt=1 to avoid sparse hexes
plt.colorbar(label='log(counts)')
plt.xlabel("Elevation (m)", fontsize=15)
plt.ylabel("IMERG Precipitation Quality Index", fontsize=15)
plt.xticks(fontsize=10)
plt.yticks(fontsize=10)
#plt.title("Precipitation Quality Index vs Elevation")
plt.legend()
plt.tight_layout()
plt.show()
###################################
#x = era5_Imerg['ETOPO_Matteo_surface'].values.flatten()  #'ETOPO_consmap_z'
#y = era5_Imerg['precipitationQualityIndex'].values.flatten()
```

    C:\Users\Iman\AppData\Local\Temp\ipykernel_10460\1543843445.py:13: UserWarning: No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
      plt.legend()



    
![png](output_30_1.png)
    



```python
# Flatten the data
pq_index = era5_Imerg['precipitationQualityIndex'].values.flatten()

# Remove NaNs if present
pq_index = pq_index[~np.isnan(pq_index)]

# Count values below 0.6
below_threshold = pq_index < 0.6
count_below = np.sum(below_threshold)
total_count = len(pq_index)
percentage_below = (count_below / total_count) * 100

# Print results
print(f"Count below 0.6: {count_below}")
print(f"Percentage below 0.6: {percentage_below:.2f}%")
# Plot histogram
plt.hist(pq_index, bins=30)
plt.axvline(x=0.6, color='red', linestyle='--', label='Threshold = 0.6')
plt.legend()
plt.xlabel('IMERG Precipitation Quality Index',fontsize=15)
plt.ylabel('Frequency',fontsize=15)
plt.xticks(fontsize=10)
plt.yticks(fontsize=10)
#plt.title('Histogram of Imerg Precipitation Quality Index')
plt.show()
```

    Count below 0.6: 15135949
    Percentage below 0.6: 23.04%



    
![png](output_31_1.png)
    


<h1> Feature Selection</h1>


<h2>Shap</h2>


```python
'''
selected_variables=['tciw','u10', 'v10', 'd2m', 't2m', 'cape', 'ETOPO_consmap_z', 'kx', 'mslhf', 'msshf',
           'sp', 'tisr', 'tcwv', 'totalx', 'viewvf', 'vinwvf', 'WVT','ppt_era5',
           'swvl1', 't', 'u', 'v', 'vo', 'q2m', 'camr', 'bs','mvimd','w', 'tclw'] #, 'cin', 'sst',,,,



# fall, winter, spring, summer
#season= 'spring'
#era5_Imerg = era5_Imerg.where(era5_Imerg["Seasonal Mask"]==season, drop=True)

Y=era5_Imerg["Imerg_orgres"].values     #Y.shape=(.., 60, 150)
X = np.stack([era5_Imerg[var].values for var in selected_variables], axis=-1)   #X.shape=(.., 60, 150, 5)
'''
```




    '\nselected_variables=[\'tciw\',\'u10\', \'v10\', \'d2m\', \'t2m\', \'cape\', \'ETOPO_consmap_z\', \'kx\', \'mslhf\', \'msshf\',\n           \'sp\', \'tisr\', \'tcwv\', \'totalx\', \'viewvf\', \'vinwvf\', \'WVT\',\'ppt_era5\',\n           \'swvl1\', \'t\', \'u\', \'v\', \'vo\', \'q2m\', \'camr\', \'bs\',\'mvimd\',\'w\', \'tclw\'] #, \'cin\', \'sst\',,,,\n\n\n\n# fall, winter, spring, summer\n#season= \'spring\'\n#era5_Imerg = era5_Imerg.where(era5_Imerg["Seasonal Mask"]==season, drop=True)\n\nY=era5_Imerg["Imerg_orgres"].values     #Y.shape=(.., 60, 150)\nX = np.stack([era5_Imerg[var].values for var in selected_variables], axis=-1)   #X.shape=(.., 60, 150, 5)\n'




```python
#daily_wise data split
'''
# split into training, validation, and test sets (randomized split) based on the 'time' dimension
time_indices = np.arange(Y.shape[0])  # Array of time indices

# Randomly split the time indices into train, validation, and test sets
time_train, time_temp = train_test_split(time_indices, test_size=0.4, random_state=42)  # 40% for temp set (validation + test)
time_valid, time_test = train_test_split(time_temp, test_size=0.5, random_state=42)     # 50% validation, 50% test from temp set

# Create an array for holding the train/valid/test indices based on 'time'
train_test_indices = np.full((Y.shape[0], Y.shape[1], Y.shape[2]), 'unassigned', dtype=object)

# Mark entire days (time steps) as train, valid, or test
train_test_indices[time_train, :, :] = 'train'  # Mark all lat/lon points for the train time steps
train_test_indices[time_valid, :, :] = 'valid'  # Mark all lat/lon points for the valid time steps
train_test_indices[time_test, :, :] = 'test'    # Mark all lat/lon points for the test time steps

# Create a new DataArray for the train/valid/test indices with the original dimensions
era5_Imerg['Train/Valid/Test indices'] = xr.DataArray(
    train_test_indices,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_Imerg.coords['time'],
        'lat': era5_Imerg.coords['lat'],
        'lon': era5_Imerg.coords['lon']
    }
)


# Extract the training data based on time_train indices
X_train = X[time_train, :, :, :]  
y_train = Y[time_train, :, :]

# Extract the validation data based on time_valid indices
X_valid = X[time_valid, :, :, :]  
y_valid = Y[time_valid, :, :]     

# Extract the test data based on time_test indices
X_test = X[time_test, :, :, :]   
y_test = Y[time_test, :, :] 
  
# Display the updated dataset
era5_Imerg
'''
```




    "\n# split into training, validation, and test sets (randomized split) based on the 'time' dimension\ntime_indices = np.arange(Y.shape[0])  # Array of time indices\n\n# Randomly split the time indices into train, validation, and test sets\ntime_train, time_temp = train_test_split(time_indices, test_size=0.4, random_state=42)  # 40% for temp set (validation + test)\ntime_valid, time_test = train_test_split(time_temp, test_size=0.5, random_state=42)     # 50% validation, 50% test from temp set\n\n# Create an array for holding the train/valid/test indices based on 'time'\ntrain_test_indices = np.full((Y.shape[0], Y.shape[1], Y.shape[2]), 'unassigned', dtype=object)\n\n# Mark entire days (time steps) as train, valid, or test\ntrain_test_indices[time_train, :, :] = 'train'  # Mark all lat/lon points for the train time steps\ntrain_test_indices[time_valid, :, :] = 'valid'  # Mark all lat/lon points for the valid time steps\ntrain_test_indices[time_test, :, :] = 'test'    # Mark all lat/lon points for the test time steps\n\n# Create a new DataArray for the train/valid/test indices with the original dimensions\nera5_Imerg['Train/Valid/Test indices'] = xr.DataArray(\n    train_test_indices,\n    dims=['time', 'lat', 'lon'],\n    coords={\n        'time': era5_Imerg.coords['time'],\n        'lat': era5_Imerg.coords['lat'],\n        'lon': era5_Imerg.coords['lon']\n    }\n)\n\n\n# Extract the training data based on time_train indices\nX_train = X[time_train, :, :, :]  \ny_train = Y[time_train, :, :]\n\n# Extract the validation data based on time_valid indices\nX_valid = X[time_valid, :, :, :]  \ny_valid = Y[time_valid, :, :]     \n\n# Extract the test data based on time_test indices\nX_test = X[time_test, :, :, :]   \ny_test = Y[time_test, :, :] \n  \n# Display the updated dataset\nera5_Imerg\n"




```python
#Train
'''
#Mask of QI
Mask_train=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'train')
#X
X_masked = [era5_Imerg[var].where(Mask_train, drop=False).values for var in selected_variables]
X_train_QI = np.stack(X_masked, axis=-1)
#y
y_train_QI = era5_Imerg['Imerg_orgres'].where(Mask_train, drop=False).values
print(X_train_QI.shape)
print(y_train_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_train_QI) & ~np.isnan(X_train_QI).any(axis=-1)
X_train_QI = X_train_QI[mask_valid]
y_train_QI = y_train_QI[mask_valid]
print(X_train_QI.shape)
print(y_train_QI.shape)
#################################################
#Test
#Mask of QI
Mask_test=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'test')
#X
X_masked = [era5_Imerg[var].where(Mask_test, drop=False).values for var in selected_variables]
X_test_QI = np.stack(X_masked, axis=-1)
#y
y_test_QI = era5_Imerg['Imerg_orgres'].where(Mask_test, drop=False).values
print(X_test_QI.shape)
print(y_test_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_test_QI) & ~np.isnan(X_test_QI).any(axis=-1)
X_test_QI = X_test_QI[mask_valid]
y_test_QI = y_test_QI[mask_valid]
print(X_test_QI.shape)
print(y_test_QI.shape)
#################################################
#valid
#Mask of QI
Mask_valid=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'valid')
#X
X_masked = [era5_Imerg[var].where(Mask_valid, drop=False).values for var in selected_variables]
X_valid_QI = np.stack(X_masked, axis=-1)
#y
y_valid_QI = era5_Imerg['Imerg_orgres'].where(Mask_valid, drop=False).values
print(X_valid_QI.shape)
print(y_valid_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_valid_QI) & ~np.isnan(X_valid_QI).any(axis=-1)
X_valid_QI = X_valid_QI[mask_valid]
y_valid_QI = y_valid_QI[mask_valid]
print(X_valid_QI.shape)
print(y_valid_QI.shape)
'''
```




    "\n#Mask of QI\nMask_train=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'train')\n#X\nX_masked = [era5_Imerg[var].where(Mask_train, drop=False).values for var in selected_variables]\nX_train_QI = np.stack(X_masked, axis=-1)\n#y\ny_train_QI = era5_Imerg['Imerg_orgres'].where(Mask_train, drop=False).values\nprint(X_train_QI.shape)\nprint(y_train_QI.shape)\n#####eliminating NA####\nmask_valid = ~np.isnan(y_train_QI) & ~np.isnan(X_train_QI).any(axis=-1)\nX_train_QI = X_train_QI[mask_valid]\ny_train_QI = y_train_QI[mask_valid]\nprint(X_train_QI.shape)\nprint(y_train_QI.shape)\n#################################################\n#Test\n#Mask of QI\nMask_test=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'test')\n#X\nX_masked = [era5_Imerg[var].where(Mask_test, drop=False).values for var in selected_variables]\nX_test_QI = np.stack(X_masked, axis=-1)\n#y\ny_test_QI = era5_Imerg['Imerg_orgres'].where(Mask_test, drop=False).values\nprint(X_test_QI.shape)\nprint(y_test_QI.shape)\n#####eliminating NA####\nmask_valid = ~np.isnan(y_test_QI) & ~np.isnan(X_test_QI).any(axis=-1)\nX_test_QI = X_test_QI[mask_valid]\ny_test_QI = y_test_QI[mask_valid]\nprint(X_test_QI.shape)\nprint(y_test_QI.shape)\n#################################################\n#valid\n#Mask of QI\nMask_valid=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'valid')\n#X\nX_masked = [era5_Imerg[var].where(Mask_valid, drop=False).values for var in selected_variables]\nX_valid_QI = np.stack(X_masked, axis=-1)\n#y\ny_valid_QI = era5_Imerg['Imerg_orgres'].where(Mask_valid, drop=False).values\nprint(X_valid_QI.shape)\nprint(y_valid_QI.shape)\n#####eliminating NA####\nmask_valid = ~np.isnan(y_valid_QI) & ~np.isnan(X_valid_QI).any(axis=-1)\nX_valid_QI = X_valid_QI[mask_valid]\ny_valid_QI = y_valid_QI[mask_valid]\nprint(X_valid_QI.shape)\nprint(y_valid_QI.shape)\n"




```python
# Define XGBoost regressor
'''
xgb = XGBRegressor(random_state=42, n_jobs=-1) #**best_params,
xgb.fit(X_train_QI, y_train_QI)

yxgb_flat = xgb.predict(X.reshape(-1, X.shape[-1]))
yxgb = yxgb_flat.reshape(-1,Y.shape[1],Y.shape[2])

yxgb_test_flat = xgb.predict(X_test_QI)
r2_xgb = r2_score(y_test_QI, yxgb_test_flat)
rmse_xgb = mean_squared_error(y_test_QI, yxgb_test_flat, squared=False)
print(f'R² XGBoost: {r2_xgb}')
print(f'rmse XGBoost: {rmse_xgb}')
print(X.shape)
print(X_test_QI.shape)
print(X_test.shape)
'''
```




    "\nxgb = XGBRegressor(random_state=42, n_jobs=-1) #**best_params,\nxgb.fit(X_train_QI, y_train_QI)\n\nyxgb_flat = xgb.predict(X.reshape(-1, X.shape[-1]))\nyxgb = yxgb_flat.reshape(-1,Y.shape[1],Y.shape[2])\n\nyxgb_test_flat = xgb.predict(X_test_QI)\nr2_xgb = r2_score(y_test_QI, yxgb_test_flat)\nrmse_xgb = mean_squared_error(y_test_QI, yxgb_test_flat, squared=False)\nprint(f'R² XGBoost: {r2_xgb}')\nprint(f'rmse XGBoost: {rmse_xgb}')\nprint(X.shape)\nprint(X_test_QI.shape)\nprint(X_test.shape)\n"




```python
'''
new_data_array = xr.DataArray(
    yxgb,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_Imerg.coords['time'],
        'lat': era5_Imerg.coords['lat'],
        'lon': era5_Imerg.coords['lon']
    }
)
era5_Imerg['XGB']= new_data_array
'''
```




    "\nnew_data_array = xr.DataArray(\n    yxgb,\n    dims=['time', 'lat', 'lon'],\n    coords={\n        'time': era5_Imerg.coords['time'],\n        'lat': era5_Imerg.coords['lat'],\n        'lon': era5_Imerg.coords['lon']\n    }\n)\nera5_Imerg['XGB']= new_data_array\n"




```python
#importance_by_cover = xgb.get_booster().get_score(importance_type='cover') 'gain' 'weight' 'cover'
'''
plt.figure(figsize=(10, 6))
bars = plt.bar(selected_variables, xgb.feature_importances_, align='center') #xgb_class, xgb_reg

   
for bar, importance in zip(bars, xgb.feature_importances_):                  #xgb_class, xgb_reg
    plt.text(
        bar.get_x() + bar.get_width() / 2,  # X-coordinate
        bar.get_height() + 0.01,           # Y-coordinate
        f'{importance:.2f}',               # Format importance to one decimal place
        ha='center',                       # Align horizontally
        va='bottom',                       # Align vertically
        #rotation=90                        # Rotate text 90 degrees
    )
    
    
plt.xlabel('Feature Importance')
#plt.ylabel('Variables')
plt.xticks(rotation=90)
plt.title('Feature Importances from XGBoost')
#plt.savefig('/leonardo_work/mBI25_AmbCo/igoudarz/test20241226.png', bbox_inches='tight')
plt.show()
'''
```




    "\nplt.figure(figsize=(10, 6))\nbars = plt.bar(selected_variables, xgb.feature_importances_, align='center') #xgb_class, xgb_reg\n\n   \nfor bar, importance in zip(bars, xgb.feature_importances_):                  #xgb_class, xgb_reg\n    plt.text(\n        bar.get_x() + bar.get_width() / 2,  # X-coordinate\n        bar.get_height() + 0.01,           # Y-coordinate\n        f'{importance:.2f}',               # Format importance to one decimal place\n        ha='center',                       # Align horizontally\n        va='bottom',                       # Align vertically\n        #rotation=90                        # Rotate text 90 degrees\n    )\n    \n    \nplt.xlabel('Feature Importance')\n#plt.ylabel('Variables')\nplt.xticks(rotation=90)\nplt.title('Feature Importances from XGBoost')\n#plt.savefig('/leonardo_work/mBI25_AmbCo/igoudarz/test20241226.png', bbox_inches='tight')\nplt.show()\n"




```python
'''
#1 step
import joblib
import shap

# Initialize the SHAP explainer with the XGBRegressor model
explainer = shap.Explainer(xgb, X_valid_QI)

# Compute SHAP values for the entire dataset
shap_values = explainer(X_valid_QI)

# Save SHAP values and related data
joblib.dump((shap_values, X_valid_QI, selected_variables), 'shap_data20250614.pkl')
'''

```




    "\n#1 step\nimport joblib\nimport shap\n\n# Initialize the SHAP explainer with the XGBRegressor model\nexplainer = shap.Explainer(xgb, X_valid_QI)\n\n# Compute SHAP values for the entire dataset\nshap_values = explainer(X_valid_QI)\n\n# Save SHAP values and related data\njoblib.dump((shap_values, X_valid_QI, selected_variables), 'shap_data20250614.pkl')\n"




```python
'''
# Set font sizes before the plot
plt.rc('axes', labelsize=18)   # Axis labels 
plt.rc('xtick', labelsize=16)  # X-axis tick labels 
plt.rc('ytick', labelsize=16)  # Y-axis tick labels 

# Plot the summary of SHAP values to show global feature importance
shap.summary_plot(shap_values, X_valid_QI, feature_names=selected_variables)

plt.show()
'''
```




    "\n# Set font sizes before the plot\nplt.rc('axes', labelsize=18)   # Axis labels \nplt.rc('xtick', labelsize=16)  # X-axis tick labels \nplt.rc('ytick', labelsize=16)  # Y-axis tick labels \n\n# Plot the summary of SHAP values to show global feature importance\nshap.summary_plot(shap_values, X_valid_QI, feature_names=selected_variables)\n\nplt.show()\n"




```python
'''
# Set font sizes before the plot
plt.rc('axes', labelsize=18)   # Axis labels 
plt.rc('xtick', labelsize=16)  # X-axis tick labels 
plt.rc('ytick', labelsize=16)  # Y-axis tick labels 

# Plot the bar chart for mean absolute SHAP values (global feature importance)
shap.summary_plot(shap_values, X_valid_QI, plot_type="bar", feature_names=selected_variables)

plt.show()
'''
```




    '\n# Set font sizes before the plot\nplt.rc(\'axes\', labelsize=18)   # Axis labels \nplt.rc(\'xtick\', labelsize=16)  # X-axis tick labels \nplt.rc(\'ytick\', labelsize=16)  # Y-axis tick labels \n\n# Plot the bar chart for mean absolute SHAP values (global feature importance)\nshap.summary_plot(shap_values, X_valid_QI, plot_type="bar", feature_names=selected_variables)\n\nplt.show()\n'




```python
'''
# Compute the mean absolute SHAP values for each feature
mean_abs_shap_values = pd.DataFrame({
    'Feature': selected_variables,
    'Mean Absolute SHAP Value': np.abs(shap_values.values).mean(axis=0)
})

# Sort features by mean absolute SHAP value in descending order
ranked_features = mean_abs_shap_values.sort_values(by="Mean Absolute SHAP Value", ascending=False)
ranked_features=ranked_features.iloc[:15,:]
print(ranked_features['Feature'])
#############################################
results = []

for i in tqdm(range(1, len(ranked_features) + 1)):  # Ensure at least one variable is selected
    vars = ranked_features.iloc[:i, 0].tolist()  # Get the top `i` variables as a list
    
    #train
    Mask_train=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'train')
    X_masked = [era5_Imerg[var].where(Mask_train, drop=False).values for var in vars]
    X_train_internal = np.stack(X_masked, axis=-1)
    y_train_internal = era5_Imerg['Imerg_orgres'].where(Mask_train, drop=False).values
    mask_valid = ~np.isnan(y_train_internal) & ~np.isnan(X_train_internal).any(axis=-1)
    X_train_internal = X_train_internal[mask_valid]
    y_train_internal = y_train_internal[mask_valid]
    #test
    Mask_test=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'test')
    X_masked = [era5_Imerg[var].where(Mask_test, drop=False).values for var in vars]
    X_test_internal = np.stack(X_masked, axis=-1)
    y_test_internal = era5_Imerg['Imerg_orgres'].where(Mask_test, drop=False).values
    mask_valid = ~np.isnan(y_test_internal) & ~np.isnan(X_test_internal).any(axis=-1)
    X_test_internal = X_test_internal[mask_valid]
    y_test_internal = y_test_internal[mask_valid]
     
    
    # Define XGBoost regressor
    xgb_internal = XGBRegressor(random_state=42, n_jobs=-1) #**best_params,
    xgb_internal.fit(X_train_internal, y_train_internal)
    yxgb_test_flat_internal = xgb_internal.predict(X_test_internal)
    
    #we decided to put 0 all below 1 for Imerg and XGB
    yxgb_test_flat_internal=np.where(yxgb_test_flat_internal<1,0,yxgb_test_flat_internal)
    y_test_internal=np.where(y_test_internal<1,0,y_test_internal)
    
    rmse_xgb_internal = mean_squared_error(y_test_internal, yxgb_test_flat_internal, squared=False)
    
    # Append the result as a tuple (variables, accuracy)
    results.append((vars, round(rmse_xgb_internal, 2)))
    
# Create a DataFrame from the results
df_1s = pd.DataFrame(results, columns=['Variables', 'RMSE_XGB_1s'])
###############################################
df_1s['Variables'] = df_1s['Variables'].apply(lambda x: ', '.join(x))
##############################################à
#save the df
df_1s.to_csv("RMSE_XGB_1s_results20250614.csv", index=False)
###############################################
# Bar plot for RMSE by Feature_Set_Season and Target_Season
plt.figure(figsize=(12, 6))
plt.plot(df_1s['RMSE_XGB_1s'],df_1s['Variables'], marker='o', linestyle='-', color='b')
plt.title("RMSE_XGB_1s")
plt.xlabel("RMSE(mm/d)")
plt.ylabel("Feature")
plt.show()
'''
```




    '\n# Compute the mean absolute SHAP values for each feature\nmean_abs_shap_values = pd.DataFrame({\n    \'Feature\': selected_variables,\n    \'Mean Absolute SHAP Value\': np.abs(shap_values.values).mean(axis=0)\n})\n\n# Sort features by mean absolute SHAP value in descending order\nranked_features = mean_abs_shap_values.sort_values(by="Mean Absolute SHAP Value", ascending=False)\nranked_features=ranked_features.iloc[:15,:]\nprint(ranked_features[\'Feature\'])\n#############################################\nresults = []\n\nfor i in tqdm(range(1, len(ranked_features) + 1)):  # Ensure at least one variable is selected\n    vars = ranked_features.iloc[:i, 0].tolist()  # Get the top `i` variables as a list\n    \n    #train\n    Mask_train=(era5_Imerg[\'precipitationQualityIndex\'] >= 0.6) & (era5_Imerg[\'Train/Valid/Test indices\'] == \'train\')\n    X_masked = [era5_Imerg[var].where(Mask_train, drop=False).values for var in vars]\n    X_train_internal = np.stack(X_masked, axis=-1)\n    y_train_internal = era5_Imerg[\'Imerg_orgres\'].where(Mask_train, drop=False).values\n    mask_valid = ~np.isnan(y_train_internal) & ~np.isnan(X_train_internal).any(axis=-1)\n    X_train_internal = X_train_internal[mask_valid]\n    y_train_internal = y_train_internal[mask_valid]\n    #test\n    Mask_test=(era5_Imerg[\'precipitationQualityIndex\'] >= 0.6) & (era5_Imerg[\'Train/Valid/Test indices\'] == \'test\')\n    X_masked = [era5_Imerg[var].where(Mask_test, drop=False).values for var in vars]\n    X_test_internal = np.stack(X_masked, axis=-1)\n    y_test_internal = era5_Imerg[\'Imerg_orgres\'].where(Mask_test, drop=False).values\n    mask_valid = ~np.isnan(y_test_internal) & ~np.isnan(X_test_internal).any(axis=-1)\n    X_test_internal = X_test_internal[mask_valid]\n    y_test_internal = y_test_internal[mask_valid]\n     \n    \n    # Define XGBoost regressor\n    xgb_internal = XGBRegressor(random_state=42, n_jobs=-1) #**best_params,\n    xgb_internal.fit(X_train_internal, y_train_internal)\n    yxgb_test_flat_internal = xgb_internal.predict(X_test_internal)\n    \n    #we decided to put 0 all below 1 for Imerg and XGB\n    yxgb_test_flat_internal=np.where(yxgb_test_flat_internal<1,0,yxgb_test_flat_internal)\n    y_test_internal=np.where(y_test_internal<1,0,y_test_internal)\n    \n    rmse_xgb_internal = mean_squared_error(y_test_internal, yxgb_test_flat_internal, squared=False)\n    \n    # Append the result as a tuple (variables, accuracy)\n    results.append((vars, round(rmse_xgb_internal, 2)))\n    \n# Create a DataFrame from the results\ndf_1s = pd.DataFrame(results, columns=[\'Variables\', \'RMSE_XGB_1s\'])\n###############################################\ndf_1s[\'Variables\'] = df_1s[\'Variables\'].apply(lambda x: \', \'.join(x))\n##############################################à\n#save the df\ndf_1s.to_csv("RMSE_XGB_1s_results20250614.csv", index=False)\n###############################################\n# Bar plot for RMSE by Feature_Set_Season and Target_Season\nplt.figure(figsize=(12, 6))\nplt.plot(df_1s[\'RMSE_XGB_1s\'],df_1s[\'Variables\'], marker=\'o\', linestyle=\'-\', color=\'b\')\nplt.title("RMSE_XGB_1s")\nplt.xlabel("RMSE(mm/d)")\nplt.ylabel("Feature")\nplt.show()\n'




```python
#RMSE graph of SHAP ranking
'''
df = pd.read_csv("RMSE_XGB_1s_results20250614.csv")

# Count the number of variables used in each row
df["Num_Variables"] = df["Variables"].apply(lambda x: len(x.split(",")))

# Plot RMSE vs. number of variables
plt.figure(figsize=(10, 6))
plt.plot(df["RMSE_XGB_1s"],df["Variables"], marker='o')
plt.xlabel("RMSE (mm/d)")
plt.ylabel("Variables")
#plt.title("RMSE vs. Variables")
plt.grid(True)
#plt.xticks(df["Num_Variables"])  # Show all points on x-axis
#plt.gca().invert_yaxis()  # Lower RMSE is better
plt.tight_layout()
plt.show()
'''
```


    
![png](output_44_0.png)
    



```python
'''
#load the stored SHAP data
shap_values, X_valid, selected_variables = joblib.load('C:\\Iman\\Maxm\\shap_data20250614.pkl')
'''
```


```python
'''
# Create the SHAP summary plot and get the figure
fig = plt.figure()
shap.summary_plot(shap_values, X_valid.reshape(-1, X_valid.shape[-1]), feature_names=selected_variables, show=False)

# Now modify font sizes
plt.xlabel(plt.gca().get_xlabel(), fontsize=18)
plt.ylabel(plt.gca().get_ylabel(), fontsize=18)
plt.xticks(fontsize=18)
plt.yticks(fontsize=18)
plt.show()
'''
```


    
![png](output_46_0.png)
    



```python
'''
fig = plt.figure()
shap.summary_plot(shap_values, X_valid.reshape(-1, X_valid.shape[-1]), plot_type="bar", feature_names=selected_variables, show=False)

# Now modify font sizes
plt.xlabel(plt.gca().get_xlabel(), fontsize=15)
plt.ylabel(plt.gca().get_ylabel(), fontsize=18)
plt.xticks(fontsize=18)
plt.yticks(fontsize=18)

plt.show()
'''
```


    
![png](output_47_0.png)
    


<h1>Data prepration</h1>


```python
selected_variables= ['tciw','ppt_era5', 'camr']

# fall, winter, spring, summer
#season= 'summer'
#era5_Imerg = era5_Imerg.where(era5_Imerg["Seasonal Mask"]==season, drop=True)


Y=era5_Imerg["Imerg_orgres"].values     #Y.shape=(.., 60, 150)
X = np.stack([era5_Imerg[var].values for var in selected_variables], axis=-1)   #X.shape=(.., 60, 150, 5)
```


```python
#daily_wise data split

# split into training, validation, and test sets (randomized split) based on the 'time' dimension
time_indices = np.arange(Y.shape[0])  # Array of time indices

# Randomly split the time indices into train, validation, and test sets
time_train, time_temp = train_test_split(time_indices, test_size=0.4, random_state=42)  # 40% for temp set (validation + test)
time_valid, time_test = train_test_split(time_temp, test_size=0.5, random_state=42)     # 50% validation, 50% test from temp set

# Create an array for holding the train/valid/test indices based on 'time'
train_test_indices = np.full((Y.shape[0], Y.shape[1], Y.shape[2]), 'unassigned', dtype=object)

# Mark entire days (time steps) as train, valid, or test
train_test_indices[time_train, :, :] = 'train'  # Mark all lat/lon points for the train time steps
train_test_indices[time_valid, :, :] = 'valid'  # Mark all lat/lon points for the valid time steps
train_test_indices[time_test, :, :] = 'test'    # Mark all lat/lon points for the test time steps

# Create a new DataArray for the train/valid/test indices with the original dimensions

era5_Imerg['Train/Valid/Test indices'] = xr.DataArray(
    train_test_indices,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_Imerg.coords['time'],
        'lat': era5_Imerg.coords['lat'],
        'lon': era5_Imerg.coords['lon']})


# Extract the training data based on time_train indices
X_train = X[time_train, :, :, :]  
y_train = Y[time_train, :, :]

# Extract the validation data based on time_valid indices
X_valid = X[time_valid, :, :, :]  
y_valid = Y[time_valid, :, :]     

# Extract the test data based on time_test indices
X_test = X[time_test, :, :, :]   
y_test = Y[time_test, :, :] 

```

<h1> Modelling</h1>


```python
#Train
#Mask of QI
Mask_train=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'train')
#X
X_masked = [era5_Imerg[var].where(Mask_train, drop=False).values for var in selected_variables]
X_train_QI = np.stack(X_masked, axis=-1)
#y
y_train_QI = era5_Imerg['Imerg_orgres'].where(Mask_train, drop=False).values
print(X_train_QI.shape)
print(y_train_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_train_QI) & ~np.isnan(X_train_QI).any(axis=-1)
X_train_QI = X_train_QI[mask_valid]
y_train_QI = y_train_QI[mask_valid]
print(X_train_QI.shape)
print(y_train_QI.shape)
#################################################
#Test
#Mask of QI
Mask_test=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'test')
#X
X_masked = [era5_Imerg[var].where(Mask_test, drop=False).values for var in selected_variables]
X_test_QI = np.stack(X_masked, axis=-1)
#y
y_test_QI = era5_Imerg['Imerg_orgres'].where(Mask_test, drop=False).values
print(X_test_QI.shape)
print(y_test_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_test_QI) & ~np.isnan(X_test_QI).any(axis=-1)
X_test_QI = X_test_QI[mask_valid]
y_test_QI = y_test_QI[mask_valid]
print(X_test_QI.shape)
print(y_test_QI.shape)
#################################################
#valid
#Mask of QI
Mask_valid=(era5_Imerg['precipitationQualityIndex'] >= 0.6) & (era5_Imerg['Train/Valid/Test indices'] == 'valid')
#X
X_masked = [era5_Imerg[var].where(Mask_valid, drop=False).values for var in selected_variables]
X_valid_QI = np.stack(X_masked, axis=-1)
#y
y_valid_QI = era5_Imerg['Imerg_orgres'].where(Mask_valid, drop=False).values
print(X_valid_QI.shape)
print(y_valid_QI.shape)
#####eliminating NA####
mask_valid = ~np.isnan(y_valid_QI) & ~np.isnan(X_valid_QI).any(axis=-1)
X_valid_QI = X_valid_QI[mask_valid]
y_valid_QI = y_valid_QI[mask_valid]
print(X_valid_QI.shape)
print(y_valid_QI.shape)
######################################
######################################
######################################
######################################
######################################
######################################   #**best_params,
# Define XGBoost regressor
from xgboost import XGBRegressor
xgb = XGBRegressor(random_state=42, n_jobs=-1) 
xgb.fit(X_train_QI, y_train_QI)

yxgb_flat = xgb.predict(X.reshape(-1, X.shape[-1]))
yxgb = yxgb_flat.reshape(-1,Y.shape[1],Y.shape[2])

print(xgb.get_xgb_params())

yxgb_test_flat = xgb.predict(X_test_QI)
r2_xgb = r2_score(y_test_QI, yxgb_test_flat)
rmse_xgb = mean_squared_error(y_test_QI, yxgb_test_flat, squared=False)
print(f'R² XGBoost: {r2_xgb}')
print(f'rmse XGBoost: {rmse_xgb}')
print(X.shape)
print(X_test_QI.shape)
print(X_test.shape)
################à
new_data_array = xr.DataArray(
    yxgb,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_Imerg.coords['time'],
        'lat': era5_Imerg.coords['lat'],
       'lon': era5_Imerg.coords['lon']
    })
era5_Imerg['XGB']= new_data_array

```

    (7300, 60, 150, 3)
    (7300, 60, 150)
    (30365704, 3)
    (30365704,)
    (7300, 60, 150, 3)
    (7300, 60, 150)
    (10178818, 3)
    (10178818,)
    (7300, 60, 150, 3)
    (7300, 60, 150)
    (10019529, 3)
    (10019529,)
    {'objective': 'reg:squarederror', 'base_score': None, 'booster': None, 'colsample_bylevel': None, 'colsample_bynode': None, 'colsample_bytree': None, 'device': None, 'eval_metric': None, 'gamma': None, 'grow_policy': None, 'interaction_constraints': None, 'learning_rate': None, 'max_bin': None, 'max_cat_threshold': None, 'max_cat_to_onehot': None, 'max_delta_step': None, 'max_depth': None, 'max_leaves': None, 'min_child_weight': None, 'monotone_constraints': None, 'multi_strategy': None, 'n_jobs': -1, 'num_parallel_tree': None, 'random_state': 42, 'reg_alpha': None, 'reg_lambda': None, 'sampling_method': None, 'scale_pos_weight': None, 'subsample': None, 'tree_method': None, 'validate_parameters': None, 'verbosity': None}
    R² XGBoost: 0.5957653522491455
    rmse XGBoost: 4.434057712554932
    (7300, 60, 150, 3)
    (10178818, 3)
    (1460, 60, 150, 3)


    C:\Users\Iman\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.11_qbz5n2kfra8p0\LocalCache\local-packages\Python311\site-packages\sklearn\metrics\_regression.py:492: FutureWarning: 'squared' is deprecated in version 1.4 and will be removed in 1.6. To calculate the root mean squared error, use the function'root_mean_squared_error'.
      warnings.warn(



```python
# Get booster config
config_json = xgb.get_booster().save_config()
parsed = json.loads(config_json)

# Extract relevant sections
generic_params = parsed["learner"]["generic_param"]
tree_params = parsed["learner"]["gradient_booster"]["tree_train_param"]
model_params = parsed["learner"]["gradient_booster"]["gbtree_model_param"]

# Extract hyperparameters
n_estimators = int(model_params.get("num_trees")) 
learning_rate = float(tree_params.get("eta"))      
max_depth = int(tree_params.get("max_depth"))       
min_child_weight = float(tree_params.get("min_child_weight"))  
n_jobs = int(generic_params.get("n_jobs"))          
random_state = int(generic_params.get("random_state"))  
max_leaves = int(tree_params.get("max_leaves"))      

# Print the results
print(f"n_estimators: {n_estimators}")
print(f"learning_rate: {learning_rate}")
print(f"max_depth: {max_depth}")
print(f"min_child_weight: {min_child_weight}")
print(f"n_jobs: {n_jobs}")
print(f"random_state: {random_state}")
print(f"max_leaves: {max_leaves}")

```

    n_estimators: 100
    learning_rate: 0.300000012
    max_depth: 6
    min_child_weight: 1.0
    n_jobs: -1
    random_state: 42
    max_leaves: 0


<h1>Error Analysis</h1>


```python
#a quick analysis regarding era5 and IMERG
mask_q=  (era5_Imerg['precipitationQualityIndex'] >= 0.6)
A = era5_Imerg['Imerg_orgres'].where(mask_q, drop=True)
B = era5_Imerg['ppt_era5'].where(mask_q, drop=True)

squared_diff = (A - B) ** 2
mean_squared_diff = squared_diff.mean(dim='time')
rmse = np.sqrt(np.nanmean((A.values.flatten() - B.values.flatten()) ** 2))
print(rmse)
```

    5.1302595



```python
#RMSE MAP of ERA5 and IMERG
mask_t_q= (era5_Imerg['precipitationQualityIndex'] >= 0.6) #& (era5_Imerg['Train/Valid/Test indices'] == 'test')
A = era5_Imerg['Imerg_orgres'].where(mask_t_q, drop=True)
B = era5_Imerg['ppt_era5'].where(mask_t_q, drop=True)

squared_diff = (A - B) ** 2
mean_squared_diff = squared_diff.mean(dim='time')
rmse_map = np.sqrt(mean_squared_diff)
rmse = np.sqrt(np.nanmean((A.values.flatten() - B.values.flatten()) ** 2))
print(rmse)
# Plot RMSE map
fig1 = plt.figure(figsize=(14, 4), facecolor='none')
map_m_fig(fig1, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'', m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4, vmax=12)
#################################################################################################################################
A = era5_Imerg['Imerg_orgres'].where(mask_t_q, drop=True)
B = era5_Imerg['XGB'].where(mask_t_q, drop=True)

squared_diff = (A - B) ** 2
mean_squared_diff = squared_diff.mean(dim='time')
rmse_map = np.sqrt(mean_squared_diff)
rmse = np.sqrt(np.nanmean((A.values.flatten() - B.values.flatten()) ** 2))
print(rmse)
# Plot RMSE map
fig1 = plt.figure(figsize=(14, 4), facecolor='none')
map_m_fig(fig1, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'', m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4, vmax=12)
#################################################################################################################################
fig = plt.figure(figsize=(14, 4))
map_m_fig(fig, era5_Imerg["Imerg_orgres"].where((era5_Imerg['precipitationQualityIndex'] >= 0.6),drop=True).mean(dim='time').values, era5_elev, era5_long, era5_lat, title_fig=f'', m_unit=era5_Imerg["Imerg_orgres"].attrs.get('units', 'unitless'), chosen_map="Blues", vmin=0, vmax=6)

```

    5.1302595
    4.3915234



    
![png](output_56_1.png)
    



    
![png](output_56_2.png)
    



    
![png](output_56_3.png)
    



```python
#seasonal ERA5 RMSE 

seasons = ['fall', 'winter', 'spring', 'summer']
figures = []  # Collect all figures here

for season in seasons:
    print(f"\nProcessing season: {season}")
    mask_s_t_q=  (era5_Imerg['Seasonal Mask'] == season) & (era5_Imerg['Train/Valid/Test indices'] == 'test') & (era5_Imerg['precipitationQualityIndex'] >= 0.6)
    A = era5_Imerg['Imerg_orgres'].where(mask_s_t_q,drop=True)
    B = era5_Imerg['ppt_era5'].where(mask_s_t_q,drop=True)
    C = era5_Imerg['XGB'].where(mask_s_t_q,drop=True)
    ################################################################################################################################
    ################################################################################################################################
    squared_diff = (A - B) ** 2
    mean_squared_diff = squared_diff.mean(dim='time')
    rmse_map = np.sqrt(mean_squared_diff)
    rmse = np.sqrt(np.nanmean((A.values.flatten() - B.values.flatten()) ** 2))

    # ########Plot RMSE map#################################### 
    fig1 = plt.figure(figsize=(14, 4), facecolor='none')
    map_m_fig(fig1, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'RMSE Map of ERA5 (test data) & ({season}), SpatioTemporal RMSE = {rmse:.2f} mm/d',
              m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4)
    figures.append(fig1)
    ######## Plot RMSE map without title########################
    fig2 = plt.figure(figsize=(14, 4), facecolor='none')
    map_m_fig(fig2, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'', m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4, vmax=12)
    figures.append(fig2)
    ######## Mean Precipitation####################################
    fig3 = plt.figure(figsize=(14, 4), facecolor='none')
    map_m_fig(fig3, era5_Imerg['Imerg_orgres'].where((era5_Imerg['Seasonal Mask'] == season)& (era5_Imerg['precipitationQualityIndex'] >= 0.6), drop=True).mean(dim='time'),
              era5_elev, era5_long, era5_lat,title_fig=f'', m_unit=r"mm/d", chosen_map="Blues", vmin=0 ,vmax=6)
    figures.append(fig3)
    ################################################################################################################################à
    ################################################################################################################################à
    squared_diff = (A - C) ** 2
    mean_squared_diff = squared_diff.mean(dim='time')
    rmse_map = np.sqrt(mean_squared_diff)
    rmse = np.sqrt(np.nanmean((A.values.flatten() - C.values.flatten()) ** 2))

    # ########Plot RMSE map#################################### 
    fig4 = plt.figure(figsize=(14, 4), facecolor='none')
    map_m_fig(fig4, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'RMSE Map of XGB (test data) & ({season}), SpatioTemporal RMSE = {rmse:.2f} mm/d',
              m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4)
    figures.append(fig4)
    ######## Plot RMSE map without title########################
    fig5 = plt.figure(figsize=(14, 4), facecolor='none')
    map_m_fig(fig5, rmse_map, era5_elev, era5_long, era5_lat,title_fig=f'', m_unit=r"RMSE mm/d", chosen_map="Reds", vmin=4, vmax=12)
    figures.append(fig5)


# After loop: show all collected figures
print("\nDisplaying all figures...")
for fig in figures:
    fig.show()

```

    
    Processing season: fall
    
    Processing season: winter
    
    Processing season: spring
    
    Processing season: summer
    
    Displaying all figures...


    C:\Users\Iman\AppData\Local\Temp\ipykernel_10460\338937248.py:54: UserWarning: FigureCanvasAgg is non-interactive, and thus cannot be shown
      fig.show()



    
![png](output_57_2.png)
    



    
![png](output_57_3.png)
    



    
![png](output_57_4.png)
    



    
![png](output_57_5.png)
    



    
![png](output_57_6.png)
    



    
![png](output_57_7.png)
    



    
![png](output_57_8.png)
    



    
![png](output_57_9.png)
    



    
![png](output_57_10.png)
    



    
![png](output_57_11.png)
    



    
![png](output_57_12.png)
    



    
![png](output_57_13.png)
    



    
![png](output_57_14.png)
    



    
![png](output_57_15.png)
    



    
![png](output_57_16.png)
    



    
![png](output_57_17.png)
    



    
![png](output_57_18.png)
    



    
![png](output_57_19.png)
    



    
![png](output_57_20.png)
    



    
![png](output_57_21.png)
    


<h2>Error based on Z percentile</h2>


```python
# 100 percent classification for Z

percentiles = range(100, 0, -1)
#percentiles = np.arange(100, 0, -0.5)

# Flatten the DataArray to get all z values across time, long, lat
z_values_flattened = era5_Imerg['ETOPO_consmap_z'].values.flatten()

# Initialize an empty DataArray for storing the percentile class
percentile_class = xr.full_like(era5_Imerg['ETOPO_consmap_z'], np.nan)

# Loop through each percentile and assign classes
for i in percentiles:
    percentile_value = np.percentile(z_values_flattened, i)
    # Use xarray's where method to assign the class where the condition is met
    percentile_class = percentile_class.where(era5_Imerg['ETOPO_consmap_z'] >= percentile_value, i) #if false, i

# Add the new DataArray as a variable in the original dataset 
era5_Imerg['Z 100 percentile class'] = percentile_class
era5_Imerg
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 5GB
Dimensions:                    (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time                       (time) datetime64[ns] 58kB 2001-01-01T11:00:00...
  * lon                        (lon) float64 1kB 4.05 4.15 4.25 ... 18.85 18.95
  * lat                        (lat) float64 480B 43.05 43.15 ... 48.85 48.95
    custom_dayofyear           (time) int32 29kB 1 2 3 4 5 ... 362 363 364 365
Data variables: (12/19)
    cape                       (time, lat, lon) float32 263MB 1.421 ... 7.731
    tciw                       (time, lat, lon) float32 263MB 0.003961 ... 0....
    tcwv                       (time, lat, lon) float32 263MB 18.88 ... 8.136
    p71.162                    (time, lat, lon) float32 263MB 159.9 ... 3.952
    tp_NearestN                (time, lat, lon) float32 263MB 0.1367 ... 0.05329
    t                          (time, lat, lon) float32 263MB 256.5 ... 243.5
    ...                         ...
    Rain/No rain threshold     (time, lat, lon) int32 263MB 0 1 1 1 ... 0 0 0 0
    Imerg P with threshold     (time, lat, lon) float32 263MB 0.0 1.58 ... 0.0
    precipitationQualityIndex  (time, lat, lon) float32 263MB 0.6412 ... 0.7227
    Train/Valid/Test indices   (time, lat, lon) object 526MB &#x27;test&#x27; ... &#x27;train&#x27;
    XGB                        (time, lat, lon) float32 263MB 0.2473 ... 0.4109
    Z 100 percentile class     (time, lat, lon) float32 263MB 13.0 13.0 ... 71.0
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-a2fb88c0-9c57-4ba2-843a-5cff280752f9' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-a2fb88c0-9c57-4ba2-843a-5cff280752f9' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4de3ed66-31ce-4ccb-958b-fb9fb59ef8a9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4de3ed66-31ce-4ccb-958b-fb9fb59ef8a9' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-a29652c0-f256-4a8d-a8c7-fb26d1291d67' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a29652c0-f256-4a8d-a8c7-fb26d1291d67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6418ef2f-18de-4a5c-8cd2-a5a2dd83b0d4' class='xr-var-data-in' type='checkbox'><label for='data-6418ef2f-18de-4a5c-8cd2-a5a2dd83b0d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-9baf6211-7f90-4768-8234-7f4437f6066e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9baf6211-7f90-4768-8234-7f4437f6066e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c2eee736-8a94-4a23-996f-aa4537bf388a' class='xr-var-data-in' type='checkbox'><label for='data-c2eee736-8a94-4a23-996f-aa4537bf388a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-454c8cd0-6398-44f4-94a8-f692f5bfb752' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-454c8cd0-6398-44f4-94a8-f692f5bfb752' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5d332977-089d-4be4-af0b-022fec90b96f' class='xr-var-data-in' type='checkbox'><label for='data-5d332977-089d-4be4-af0b-022fec90b96f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-8f2a2f65-4347-4e63-b806-3231e55e0d12' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8f2a2f65-4347-4e63-b806-3231e55e0d12' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f060a05f-8b37-4510-99a0-ca356579b218' class='xr-var-data-in' type='checkbox'><label for='data-f060a05f-8b37-4510-99a0-ca356579b218' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-4c1375c3-fa6b-4d3a-af2b-23f40fcaf6b1' class='xr-section-summary-in' type='checkbox'  ><label for='section-4c1375c3-fa6b-4d3a-af2b-23f40fcaf6b1' class='xr-section-summary' >Data variables: <span>(19)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>cape</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.421 2.406 2.406 ... 8.468 7.731</div><input id='attrs-01a54352-0a63-4ec2-8281-f2441d454174' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-01a54352-0a63-4ec2-8281-f2441d454174' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-917e5033-1e7c-402d-91cd-f5eaef89d4e9' class='xr-var-data-in' type='checkbox'><label for='data-917e5033-1e7c-402d-91cd-f5eaef89d4e9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>J kg**-1</dd></dl></div><div class='xr-var-data'><pre>array([[[1.42149377e+00, 2.40560484e+00, 2.40560484e+00, ...,
         1.85887647e+00, 1.85887647e+00, 1.20280242e+00],
        [5.79532051e+00, 8.41961670e+00, 8.41961670e+00, ...,
         7.65419722e-01, 7.65419722e-01, 6.56074047e-01],
        [5.79532051e+00, 8.41961670e+00, 8.41961670e+00, ...,
         7.65419722e-01, 7.65419722e-01, 6.56074047e-01],
        ...,
        [5.64223671e+01, 9.40372772e+01, 9.40372772e+01, ...,
         1.34495182e+01, 1.34495182e+01, 1.58551226e+01],
        [5.64223671e+01, 9.40372772e+01, 9.40372772e+01, ...,
         1.34495182e+01, 1.34495182e+01, 1.58551226e+01],
        [7.07466507e+01, 1.14922302e+02, 1.14922302e+02, ...,
         1.37775545e+01, 1.37775545e+01, 1.66205425e+01]],

       [[3.08026764e+02, 3.51108948e+02, 3.51108948e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [3.90036011e+02, 4.59798553e+02, 4.59798553e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [3.90036011e+02, 4.59798553e+02, 4.59798553e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
...
        [8.07501678e+01, 6.60236893e+01, 6.60236893e+01, ...,
         6.88462677e+01, 6.88462677e+01, 5.93967781e+01],
        [8.07501678e+01, 6.60236893e+01, 6.60236893e+01, ...,
         6.88462677e+01, 6.88462677e+01, 5.93967781e+01],
        [6.67600174e+01, 6.30783958e+01, 6.30783958e+01, ...,
         4.87200851e+01, 4.87200851e+01, 4.46703033e+01]],

       [[1.96352983e+00, 1.71808863e+00, 1.71808863e+00, ...,
         1.56346069e+02, 1.56346069e+02, 1.62604813e+02],
        [2.57713294e+00, 2.08625054e+00, 2.08625054e+00, ...,
         1.43951279e+02, 1.43951279e+02, 1.48860107e+02],
        [2.57713294e+00, 2.08625054e+00, 2.08625054e+00, ...,
         1.43951279e+02, 1.43951279e+02, 1.48860107e+02],
        ...,
        [3.64480209e+01, 3.05574322e+01, 3.05574322e+01, ...,
         8.83588409e+00, 8.83588409e+00, 1.23947821e+01],
        [3.64480209e+01, 3.05574322e+01, 3.05574322e+01, ...,
         8.83588409e+00, 8.83588409e+00, 1.23947821e+01],
        [8.74997940e+01, 9.31449432e+01, 9.31449432e+01, ...,
         8.46772194e+00, 8.46772194e+00, 7.73139858e+00]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-2a0aa1ca-132a-4332-81eb-8db5e6109325' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a0aa1ca-132a-4332-81eb-8db5e6109325' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d37b7a7d-113f-48b4-9729-fabc372f08cc' class='xr-var-data-in' type='checkbox'><label for='data-d37b7a7d-113f-48b4-9729-fabc372f08cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>18.88 19.2 19.2 ... 8.158 8.136</div><input id='attrs-281e2c30-5270-440d-9194-f11b3571b762' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-281e2c30-5270-440d-9194-f11b3571b762' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9d32d5e1-c2e0-47f2-84de-e4829eb3584f' class='xr-var-data-in' type='checkbox'><label for='data-9d32d5e1-c2e0-47f2-84de-e4829eb3584f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[18.877731 , 19.196379 , 19.196379 , ...,  4.8336053,
          4.8336053,  4.543007 ],
        [19.209276 , 19.41561  , 19.41561  , ...,  4.5966434,
          4.5966434,  4.376464 ],
        [19.209276 , 19.41561  , 19.41561  , ...,  4.5966434,
          4.5966434,  4.376464 ],
        ...,
        [20.010712 , 19.974598 , 19.974598 , ...,  3.242357 ,
          3.242357 ,  3.0428135],
        [20.010712 , 19.974598 , 19.974598 , ...,  3.242357 ,
          3.242357 ,  3.0428135],
        [19.929708 , 19.932613 , 19.932613 , ...,  3.2648315,
          3.2648315,  3.0128968]],

       [[15.671308 , 15.798683 , 15.798683 , ...,  7.835593 ,
          7.835593 ,  7.274292 ],
        [16.164532 , 16.669025 , 16.669025 , ...,  7.8434505,
          7.8434505,  7.2999687],
        [16.164532 , 16.669025 , 16.669025 , ...,  7.8434505,
          7.8434505,  7.2999687],
...
        [ 9.282007 ,  9.340907 ,  9.340907 , ..., 11.058987 ,
         11.058987 , 10.746535 ],
        [ 9.282007 ,  9.340907 ,  9.340907 , ..., 11.058987 ,
         11.058987 , 10.746535 ],
        [ 9.309742 ,  9.363061 ,  9.363061 , ..., 10.769295 ,
         10.769295 , 10.364661 ]],

       [[13.382874 , 13.546597 , 13.546597 , ...,  7.7033434,
          7.7033434,  7.201854 ],
        [13.894079 , 13.908097 , 13.908097 , ...,  7.4785695,
          7.4785695,  6.996142 ],
        [13.894079 , 13.908097 , 13.908097 , ...,  7.4785695,
          7.4785695,  6.996142 ],
        ...,
        [10.919603 , 11.086487 , 11.086487 , ...,  8.726594 ,
          8.726594 ,  8.769457 ],
        [10.919603 , 11.086487 , 11.086487 , ...,  8.726594 ,
          8.726594 ,  8.769457 ],
        [10.799081 , 10.932009 , 10.932009 , ...,  8.158472 ,
          8.158472 ,  8.136149 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>p71.162</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>159.9 161.7 161.7 ... 4.103 3.952</div><input id='attrs-a7f4186e-632a-437d-9fcb-0643218f03e0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a7f4186e-632a-437d-9fcb-0643218f03e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-725b9d70-f12c-4f53-9397-ff24c5f59944' class='xr-var-data-in' type='checkbox'><label for='data-725b9d70-f12c-4f53-9397-ff24c5f59944' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Vertical integral of eastward water vapour flux</dd><dt><span>units :</span></dt><dd>kg m**-1 s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[159.90842  , 161.68945  , 161.68945  , ...,  -8.736225 ,
          -8.736225 ,  -8.706814 ],
        [117.19496  , 122.65574  , 122.65574  , ...,  -9.781975 ,
          -9.781975 ,  -9.771082 ],
        [117.19496  , 122.65574  , 122.65574  , ...,  -9.781975 ,
          -9.781975 ,  -9.771082 ],
        ...,
        [286.63046  , 283.61194  , 283.61194  , ...,  13.492501 ,
          13.492501 ,  12.484877 ],
        [286.63046  , 283.61194  , 283.61194  , ...,  13.492501 ,
          13.492501 ,  12.484877 ],
        [287.56183  , 283.30038  , 283.30038  , ...,  14.747401 ,
          14.747401 ,  13.6362915]],

       [[151.33109  , 161.32562  , 161.32562  , ...,  66.51857  ,
          66.51857  ,  62.082844 ],
        [139.97707  , 141.0653   , 141.0653   , ...,  67.892204 ,
          67.892204 ,  63.38023  ],
        [139.97707  , 141.0653   , 141.0653   , ...,  67.892204 ,
          67.892204 ,  63.38023  ],
...
        [ 68.680405 ,  68.439766 ,  68.439766 , ...,  42.62315  ,
          42.62315  ,  42.001633 ],
        [ 68.680405 ,  68.439766 ,  68.439766 , ...,  42.62315  ,
          42.62315  ,  42.001633 ],
        [ 66.06323  ,  65.84251  ,  65.84251  , ...,  44.872726 ,
          44.872726 ,  43.831333 ]],

       [[ 92.37524  ,  97.72742  ,  97.72742  , ...,  46.87834  ,
          46.87834  ,  48.336296 ],
        [110.98922  , 106.324104 , 106.324104 , ...,  49.877228 ,
          49.877228 ,  51.400734 ],
        [110.98922  , 106.324104 , 106.324104 , ...,  49.877228 ,
          49.877228 ,  51.400734 ],
        ...,
        [ 91.23841  ,  93.67802  ,  93.67802  , ...,   4.454188 ,
           4.454188 ,   5.0574493],
        [ 91.23841  ,  93.67802  ,  93.67802  , ...,   4.454188 ,
           4.454188 ,   5.0574493],
        [ 85.56676  ,  88.348236 ,  88.348236 , ...,   4.103184 ,
           4.103184 ,   3.952161 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-dbf5d34b-1b22-43f1-b96e-e5e77b08dc61' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dbf5d34b-1b22-43f1-b96e-e5e77b08dc61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-17e3fc29-2918-46f5-967d-319263aba0ca' class='xr-var-data-in' type='checkbox'><label for='data-17e3fc29-2918-46f5-967d-319263aba0ca' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>256.5 256.6 256.6 ... 243.3 243.5</div><input id='attrs-49aeb263-74d7-4c7d-a6d7-ecbd1f9666fb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-49aeb263-74d7-4c7d-a6d7-ecbd1f9666fb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2c3c0c04-f08b-4599-8248-0e3cb72bce82' class='xr-var-data-in' type='checkbox'><label for='data-2c3c0c04-f08b-4599-8248-0e3cb72bce82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[256.49066, 256.55716, 256.55716, ..., 253.0052 , 253.0052 ,
         252.8964 ],
        [256.3024 , 256.37775, 256.37775, ..., 252.967  , 252.967  ,
         252.8425 ],
        [256.3024 , 256.37775, 256.37775, ..., 252.967  , 252.967  ,
         252.8425 ],
        ...,
        [253.51062, 253.58298, 253.58298, ..., 249.6429 , 249.6429 ,
         249.37024],
        [253.51062, 253.58298, 253.58298, ..., 249.6429 , 249.6429 ,
         249.37024],
        [253.46223, 253.53143, 253.53143, ..., 249.55763, 249.55763,
         249.29507]],

       [[250.23323, 250.36234, 250.36234, ..., 256.82962, 256.82962,
         256.794  ],
        [249.84349, 249.96606, 249.96606, ..., 256.63492, 256.63492,
         256.6397 ],
        [249.84349, 249.96606, 249.96606, ..., 256.63492, 256.63492,
         256.6397 ],
...
        [240.7823 , 240.72282, 240.72282, ..., 244.64058, 244.64058,
         244.82233],
        [240.7823 , 240.72282, 240.72282, ..., 244.64058, 244.64058,
         244.82233],
        [240.81447, 240.75978, 240.75978, ..., 244.45679, 244.45679,
         244.63727]],

       [[244.8327 , 244.82104, 244.82104, ..., 245.76154, 245.76154,
         245.93304],
        [244.73772, 244.7326 , 244.7326 , ..., 245.59546, 245.59546,
         245.74634],
        [244.73772, 244.7326 , 244.7326 , ..., 245.59546, 245.59546,
         245.74634],
        ...,
        [243.22255, 243.1899 , 243.1899 , ..., 243.45236, 243.45236,
         243.61055],
        [243.22255, 243.1899 , 243.1899 , ..., 243.45236, 243.45236,
         243.61055],
        [243.14436, 243.11359, 243.11359, ..., 243.3091 , 243.3091 ,
         243.47261]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>20.11 19.95 19.95 ... 7.23 6.83</div><input id='attrs-4fe51400-a784-4e69-8f7f-0a94e66ad110' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4fe51400-a784-4e69-8f7f-0a94e66ad110' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-292f4bd3-8cb2-49c4-a250-f8f55c60eea8' class='xr-var-data-in' type='checkbox'><label for='data-292f4bd3-8cb2-49c4-a250-f8f55c60eea8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>long_name :</span></dt><dd>U component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[20.108004 , 19.954151 , 19.954151 , ...,  3.0157864,
          3.0157864,  2.8875213],
        [20.012627 , 19.833845 , 19.833845 , ...,  3.5658135,
          3.5658135,  3.3602605],
        [20.012627 , 19.833845 , 19.833845 , ...,  3.5658135,
          3.5658135,  3.3602605],
        ...,
        [20.374466 , 20.11675  , 20.11675  , ...,  6.796845 ,
          6.796845 ,  6.548471 ],
        [20.374466 , 20.11675  , 20.11675  , ...,  6.796845 ,
          6.796845 ,  6.548471 ],
        [20.499376 , 20.28547  , 20.28547  , ...,  6.7144265,
          6.7144265,  6.4787474]],

       [[20.784979 , 21.070978 , 21.070978 , ..., 12.162143 ,
         12.162143 , 11.474379 ],
        [19.814507 , 20.141943 , 20.141943 , ..., 11.756627 ,
         11.756627 , 11.308094 ],
        [19.814507 , 20.141943 , 20.141943 , ..., 11.756627 ,
         11.756627 , 11.308094 ],
...
        [ 9.120344 ,  9.079311 ,  9.079311 , ...,  9.823612 ,
          9.823612 , 10.284766 ],
        [ 9.120344 ,  9.079311 ,  9.079311 , ...,  9.823612 ,
          9.823612 , 10.284766 ],
        [ 9.412321 ,  9.313931 ,  9.313931 , ...,  9.398668 ,
          9.398668 ,  9.8454275]],

       [[11.067429 , 11.066463 , 11.066463 , ..., 11.471893 ,
         11.471893 , 11.6907835],
        [11.268584 , 11.259829 , 11.259829 , ..., 11.427002 ,
         11.427002 , 11.534369 ],
        [11.268584 , 11.259829 , 11.259829 , ..., 11.427002 ,
         11.427002 , 11.534369 ],
        ...,
        [12.826935 , 12.874274 , 12.874274 , ...,  6.6019187,
          6.6019187,  6.245313 ],
        [12.826935 , 12.874274 , 12.874274 , ...,  6.6019187,
          6.6019187,  6.245313 ],
        [12.332169 , 12.405997 , 12.405997 , ...,  7.2296515,
          7.2296515,  6.8303065]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.344 5.785 5.785 ... 10.44 10.05</div><input id='attrs-2a10b7a7-0d94-4723-8c36-13f96e1db349' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a10b7a7-0d94-4723-8c36-13f96e1db349' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ecf0555-2a1c-4fdb-bfac-89b5b18e2475' class='xr-var-data-in' type='checkbox'><label for='data-1ecf0555-2a1c-4fdb-bfac-89b5b18e2475' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>northward_wind</dd><dt><span>long_name :</span></dt><dd>V component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[  6.3441896 ,   5.784615  ,   5.784615  , ..., -12.864283  ,
         -12.864283  , -12.383464  ],
        [  6.9686565 ,   6.3644724 ,   6.3644724 , ..., -12.986172  ,
         -12.986172  , -12.606511  ],
        [  6.9686565 ,   6.3644724 ,   6.3644724 , ..., -12.986172  ,
         -12.986172  , -12.606511  ],
        ...,
        [ 16.116722  ,  15.465233  ,  15.465233  , ..., -13.588623  ,
         -13.588623  , -13.552743  ],
        [ 16.116722  ,  15.465233  ,  15.465233  , ..., -13.588623  ,
         -13.588623  , -13.552743  ],
        [ 16.76744   ,  16.132448  ,  16.132448  , ..., -13.333484  ,
         -13.333484  , -13.337399  ]],

       [[ 14.833962  ,  15.567546  ,  15.567546  , ...,  -2.4402611 ,
          -2.4402611 ,  -2.8993204 ],
        [ 15.215612  ,  15.922046  ,  15.922046  , ...,  -1.9712529 ,
          -1.9712529 ,  -2.2977679 ],
        [ 15.215612  ,  15.922046  ,  15.922046  , ...,  -1.9712529 ,
          -1.9712529 ,  -2.2977679 ],
...
        [ -3.5205407 ,  -3.2907648 ,  -3.2907648 , ...,  14.277745  ,
          14.277745  ,  14.76931   ],
        [ -3.5205407 ,  -3.2907648 ,  -3.2907648 , ...,  14.277745  ,
          14.277745  ,  14.76931   ],
        [ -3.5959318 ,  -3.3709369 ,  -3.3709369 , ...,  13.863788  ,
          13.863788  ,  14.258135  ]],

       [[ -0.47725597,  -0.46984163,  -0.46984163, ...,   9.522158  ,
           9.522158  ,   9.881096  ],
        [ -0.5962323 ,  -0.6097444 ,  -0.6097444 , ...,   9.097391  ,
           9.097391  ,   9.500954  ],
        [ -0.5962323 ,  -0.6097444 ,  -0.6097444 , ...,   9.097391  ,
           9.097391  ,   9.500954  ],
        ...,
        [  4.752296  ,   4.976113  ,   4.976113  , ...,   9.918306  ,
           9.918306  ,   9.614942  ],
        [  4.752296  ,   4.976113  ,   4.976113  , ...,   9.918306  ,
           9.918306  ,   9.614942  ],
        [  4.716541  ,   4.961631  ,   4.961631  , ...,  10.436342  ,
          10.436342  ,  10.045598  ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-410ae91c-3038-4515-927d-46da36f5bd85' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-410ae91c-3038-4515-927d-46da36f5bd85' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-158d60c2-e64a-44bd-abf1-c2136288f254' class='xr-var-data-in' type='checkbox'><label for='data-158d60c2-e64a-44bd-abf1-c2136288f254' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-53dce2a9-b9f1-4129-800c-10dd2fc4b0bb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-53dce2a9-b9f1-4129-800c-10dd2fc4b0bb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c7413d55-f24d-4e3f-b0f9-6ded3aced5ea' class='xr-var-data-in' type='checkbox'><label for='data-c7413d55-f24d-4e3f-b0f9-6ded3aced5ea' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-18e61ec5-c1fa-4104-95ac-9fc64b4ac80c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-18e61ec5-c1fa-4104-95ac-9fc64b4ac80c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-021fccdf-4e7c-4ccc-94df-5dcbb456c8fe' class='xr-var-data-in' type='checkbox'><label for='data-021fccdf-4e7c-4ccc-94df-5dcbb456c8fe' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-c10a0d8b-992c-4f88-89dd-8abb376b1dcb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c10a0d8b-992c-4f88-89dd-8abb376b1dcb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8f3e86d9-51f6-437d-b46a-c12b9de23a12' class='xr-var-data-in' type='checkbox'><label for='data-8f3e86d9-51f6-437d-b46a-c12b9de23a12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Seasonal Mask</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;</div><input id='attrs-fadfbc50-4ba1-48b5-b05c-1c7171eb2b33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fadfbc50-4ba1-48b5-b05c-1c7171eb2b33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c68b80ea-3502-4e2c-b134-748568231224' class='xr-var-data-in' type='checkbox'><label for='data-c68b80ea-3502-4e2c-b134-748568231224' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;, ..., &#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Rain/No rain threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 1 1 1 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-419fa808-7d0b-42df-9319-272f3309d63a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-419fa808-7d0b-42df-9319-272f3309d63a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85fd7a2a-da0c-47dc-9cbd-d19fef16667a' class='xr-var-data-in' type='checkbox'><label for='data-85fd7a2a-da0c-47dc-9cbd-d19fef16667a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0, 1, 1, ..., 0, 0, 0],
        [0, 0, 1, ..., 0, 0, 0],
        [0, 1, 1, ..., 0, 1, 1],
        ...,
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0]],

       [[0, 1, 1, ..., 1, 0, 0],
        [1, 1, 0, ..., 0, 1, 1],
        [1, 1, 0, ..., 1, 1, 0],
        ...,
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
...
        ...,
        [1, 1, 0, ..., 1, 1, 1],
        [1, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 1, 0, 0]],

       [[0, 0, 0, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [0, 1, 1, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg P with threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 1.58 2.02 2.445 ... 0.0 0.0 0.0</div><input id='attrs-24f0f7e6-2935-42da-a6c1-786d538bf1b1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-24f0f7e6-2935-42da-a6c1-786d538bf1b1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-81a3cc65-35cf-4e17-8752-a5e07d0652ba' class='xr-var-data-in' type='checkbox'><label for='data-81a3cc65-35cf-4e17-8752-a5e07d0652ba' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.       ,  1.5799999,  2.02     , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  1.215    , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  1.1899999,  2.205    , ...,  0.       ,
          3.56     ,  5.9649997],
        ...,
        [16.609999 , 15.525002 , 17.244999 , ...,  0.       ,
          0.       ,  0.       ],
        [17.24     , 17.229998 , 18.01     , ...,  0.       ,
          0.       ,  0.       ],
        [18.300001 , 18.12     , 16.42     , ...,  0.       ,
          0.       ,  0.       ]],

       [[ 0.       ,  1.1249999,  1.2649999, ...,  2.3      ,
          0.       ,  0.       ],
        [ 1.115    ,  1.38     ,  0.       , ...,  0.       ,
          1.0799999,  1.255    ],
        [ 1.255    ,  1.375    ,  0.       , ...,  2.2599998,
          2.375    ,  0.       ],
...
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          2.69     ,  1.6500001],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  1.2099999,
          0.       ,  0.       ]],

       [[ 0.       ,  0.       ,  0.       , ..., 21.639997 ,
         10.12     ,  5.62     ],
        [ 1.135    ,  1.9250002,  1.6949999, ..., 24.25     ,
         19.095    ,  8.845    ],
        [ 0.       ,  2.0149999,  3.54     , ..., 15.814999 ,
         19.75     , 14.844999 ],
        ...,
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitationQualityIndex</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.6412 0.6368 ... 0.7227 0.7227</div><input id='attrs-2430f062-a075-4148-b065-ba499ff41a72' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2430f062-a075-4148-b065-ba499ff41a72' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-79c73c01-b1ab-4a4b-96f0-95549a1ade94' class='xr-var-data-in' type='checkbox'><label for='data-79c73c01-b1ab-4a4b-96f0-95549a1ade94' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>DimensionNames :</span></dt><dd>time,lon,lat</dd><dt><span>CodeMissingValue :</span></dt><dd>-9999.9</dd><dt><span>LongName :</span></dt><dd>
Precipitation quality index; qualitative indicator
                        of skill based on the microwave-infrared merging process
</dd></dl></div><div class='xr-var-data'><pre>array([[[0.64120835, 0.63681257, 0.63681257, ..., 0.35652086,
         0.35514584, 0.63293755],
        [0.64385426, 0.64385426, 0.6419167 , ..., 0.3548125 ,
         0.6085208 , 0.35270834],
        [0.6399168 , 0.6399168 , 0.6379792 , ..., 0.34964585,
         0.63293755, 0.35514584],
        ...,
        [0.5837709 , 0.5837709 , 0.579625  , ..., 0.58214587,
         0.36610416, 0.36610416],
        [0.5837709 , 0.5837709 , 0.58064586, ..., 0.3666875 ,
         0.36610416, 0.36589587],
        [0.5852917 , 0.5811458 , 0.58064586, ..., 0.3666875 ,
         0.36589584, 0.36568752]],

       [[0.6909583 , 0.69037503, 0.69037503, ..., 0.5888542 ,
         0.3633542 , 0.5888542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.3633542 ,
         0.5888542 , 0.3633542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.5888542 ,
         0.5888542 , 0.3633542 ],
...
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.7248542 ,
         0.7247917 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72572917,
         0.7250208 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72775   ,
         0.72572917, 0.72554165]],

       [[0.7024792 , 0.6986251 , 0.6899584 , ..., 0.707375  ,
         0.37502083, 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.707375  ],
        ...,
        [0.7012709 , 0.7006251 , 0.70210415, ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7039167 , 0.70210415, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7019376 , 0.70308334, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Train/Valid/Test indices</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;test&#x27; &#x27;test&#x27; ... &#x27;train&#x27; &#x27;train&#x27;</div><input id='attrs-a979c62f-02c1-4008-b9b2-6b14af596151' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a979c62f-02c1-4008-b9b2-6b14af596151' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8ef952e5-6474-4c0a-b930-dbebc944d913' class='xr-var-data-in' type='checkbox'><label for='data-8ef952e5-6474-4c0a-b930-dbebc944d913' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        ...,
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
...
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]]],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XGB</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.2473 0.2627 ... 0.3281 0.4109</div><input id='attrs-a22e8d82-351a-4ce4-a872-43e490a02e4e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a22e8d82-351a-4ce4-a872-43e490a02e4e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e14ff5fa-0600-449e-a421-bc9447a80fe5' class='xr-var-data-in' type='checkbox'><label for='data-e14ff5fa-0600-449e-a421-bc9447a80fe5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.24732324,  0.26269162,  0.26269162, ...,  0.3851464 ,
          0.3851464 ,  0.39618757],
        [ 0.39167458,  0.47198793,  0.5513218 , ...,  0.38631782,
          0.40761706,  0.4595224 ],
        [ 0.47198793,  0.5513218 ,  0.5513218 , ...,  0.38631782,
          0.40761706,  0.4595224 ],
        ...,
        [18.118355  , 16.037098  , 14.440579  , ...,  0.15804331,
          0.15804331,  0.16411786],
        [18.118355  , 16.214687  , 14.575089  , ...,  0.15804331,
          0.18051544,  0.17340927],
        [18.085691  , 17.438374  , 17.438374  , ...,  0.18051544,
          0.20395152,  0.14014997]],

       [[ 0.6629803 ,  0.6629803 ,  0.6629803 , ...,  0.24914932,
          0.24914932,  0.2546678 ],
        [ 0.64970183,  0.74130785,  0.74130785, ...,  0.24914932,
          0.24914932,  0.2546678 ],
        [ 0.64970183,  0.74130785,  0.74130785, ...,  0.24914932,
          0.24914932,  0.2546678 ],
...
        [ 0.6119468 ,  0.62479043,  0.62479043, ...,  5.2527876 ,
          5.322145  ,  5.6378565 ],
        [ 0.6119468 ,  0.62479043,  0.62479043, ...,  4.709033  ,
          5.2256327 ,  5.423979  ],
        [ 0.74571466,  0.7679962 ,  0.7679962 , ...,  3.2684886 ,
          3.486782  ,  4.3122964 ]],

       [[ 0.9921837 ,  0.93443674,  0.93443674, ...,  5.4613833 ,
          5.37484   ,  5.388532  ],
        [ 1.6640289 ,  1.5659462 ,  1.5700445 , ...,  4.2018476 ,
          4.455406  ,  5.2435036 ],
        [ 1.6916648 ,  1.5832984 ,  1.5832984 , ...,  3.849972  ,
          4.1746926 ,  4.8850408 ],
        ...,
        [ 1.3431462 ,  1.4402862 ,  1.4402862 , ...,  0.44122648,
          0.44122648,  0.48231432],
        [ 1.518772  ,  1.5730064 ,  1.5730064 , ...,  0.44122648,
          0.44122648,  0.48231432],
        [ 1.8865509 ,  1.836851  ,  1.8111199 , ...,  0.3281491 ,
          0.3281491 ,  0.41089818]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Z 100 percentile class</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>13.0 13.0 13.0 ... 71.0 58.0 71.0</div><input id='attrs-d0db1a4d-f322-4f1c-9fa6-ab3bbb896eed' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d0db1a4d-f322-4f1c-9fa6-ab3bbb896eed' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c9d3dcd8-a991-4056-b13c-4a9ae76ccc12' class='xr-var-data-in' type='checkbox'><label for='data-c9d3dcd8-a991-4056-b13c-4a9ae76ccc12' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
...
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e5c3d85b-1131-41c8-923b-a74ec18e2df6' class='xr-section-summary-in' type='checkbox'  ><label for='section-e5c3d85b-1131-41c8-923b-a74ec18e2df6' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f8dd4e71-7ff6-446a-8919-250d24845a79' class='xr-index-data-in' type='checkbox'/><label for='index-f8dd4e71-7ff6-446a-8919-250d24845a79' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-702ad58f-63fb-4a96-a037-a09472883545' class='xr-index-data-in' type='checkbox'/><label for='index-702ad58f-63fb-4a96-a037-a09472883545' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-3a50e110-a937-4e2d-8e6f-4f94fe34382c' class='xr-index-data-in' type='checkbox'/><label for='index-3a50e110-a937-4e2d-8e6f-4f94fe34382c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3fcc0bcf-638c-41fa-b8d3-e7b5de4a1929' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3fcc0bcf-638c-41fa-b8d3-e7b5de4a1929' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/convective_available_potential_energy_daymax_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/convective_available_potential_energy_daymax_2001_NearestN.nc
Sun Aug 04 14:09:21 2024: cdo -b F32 -daymax -selname,cape /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_convective_available_potential_energy_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/convective_available_potential_energy_daymax_2001.nc
2024-08-03 21:46:28 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722721563.4663277-31296-1-8733f443-6fe5-4260-83b2-9aa5b12398a5.nc /cache/tmp/8733f443-6fe5-4260-83b2-9aa5b12398a5-adaptor.mars.internal-1722720636.4191825-31296-1-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
# Define percentile bins
percentile_bins = [(0, 13), (14, 20), (20, 30), (30, 40), (40, 50),
                   (50, 60), (60, 70), (70, 80), (80, 90), (90, 100)]

# Initialize list to collect results
results = []

for lower, upper in percentile_bins:
    mask = (
        (era5_Imerg['Z 100 percentile class'] > lower) &
        (era5_Imerg['Z 100 percentile class'] <= upper) &
        (era5_Imerg['precipitationQualityIndex'] >= 0.6) &
        (era5_Imerg['Train/Valid/Test indices'] == 'test')
    )

    A = era5_Imerg['Imerg_orgres'].where(mask).values.flatten()
    B = era5_Imerg['XGB'].where(mask).values.flatten()
    C = era5_Imerg['ppt_era5'].where(mask).values.flatten()

    rmse_xgb = np.sqrt(np.nanmean((A - B) ** 2))
    rmse_era5 = np.sqrt(np.nanmean((A - C) ** 2))
    mean_Imerg = np.nanmean(A)

    lower_elev = np.percentile(era5_Imerg['ETOPO_consmap_z'].values.flatten(), lower)
    upper_elev = np.percentile(era5_Imerg['ETOPO_consmap_z'].values.flatten(), upper)

    results.append({
        'lower_percentile': lower,
        'upper_percentile': upper,
        'lower_elev': lower_elev,
        'upper_elev': upper_elev,
        'rmse_xgb': rmse_xgb,
        'rmse_era5': rmse_era5,
        'mean_Imerg': mean_Imerg
    })

# Create DataFrame
df_zclass = pd.DataFrame(results)

# Plotting
fig, ax1 = plt.subplots(figsize=(10, 6))

# Plot RMSE
ax1.errorbar(range(len(df_zclass)), df_zclass['rmse_era5'], fmt='o-', color='blue', label='ERA5')
ax1.errorbar(range(len(df_zclass)), df_zclass['rmse_xgb'], fmt='o-', color='purple', label='XGB')
ax1.set_ylabel('RMSE (mm/d)', color='black', fontsize=20)
ax1.set_xticks(range(len(df_zclass)))
xticklabels = [f"({l},{u}]" for l, u in zip(df_zclass['lower_percentile'], df_zclass['upper_percentile'])]
elev_classes = [f"({int(l)},{int(u)})" for l, u in zip(df_zclass['lower_elev'], df_zclass['upper_elev'])]
ax1.set_xticklabels(xticklabels, rotation=45, fontsize=20)
ax1.set_xlabel('Elevation percentile', fontsize=20)
ax1.grid(True, which='both', linestyle='--', alpha=0.6)

# Secondary axis for mean IMERG precipitation
ax2 = ax1.twinx()
ax2.plot(range(len(df_zclass)), df_zclass['mean_Imerg'], 'g--o', label='Mean IMERG Precipitation')
ax2.set_ylabel('Mean IMERG Precipitation (mm/d)', color='green', fontsize=20)

# Legend
lines, labels = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax1.legend(lines + lines2, labels + labels2, loc='upper left', fontsize=15)

# Elevation classes as secondary x-axis
ax3 = ax1.twiny()
ax3.set_xlim(ax1.get_xlim())
ax3.set_xticks(range(len(df_zclass)))
ax3.set_xticklabels(elev_classes, rotation=45, fontsize=20)
ax3.set_xlabel('Elevation class (m)', fontsize=20)

plt.tight_layout()
plt.show()

```


    
![png](output_60_0.png)
    


<h2>Error based on P percentile</h2>


```python
# 100 percent classification for Z

percentiles = range(100, 0, -1)
#percentiles = np.arange(100.0, 0.0, -0.5)
#percentiles = np.arange(100.0, 0.0, -0.1)

# Flatten the DataArray to get all z values across time, long, lat
Imerg_orgres_values_flattened = era5_Imerg['Imerg_orgres'].values.flatten()

# Initialize an empty DataArray for storing the percentile class
percentile_class = xr.full_like(era5_Imerg['Imerg_orgres'], np.nan)

# Loop through each percentile and assign classes
for i in percentiles:
    percentile_value = np.percentile(Imerg_orgres_values_flattened, i)
    # Use xarray's where method to assign the class where the condition is met
    percentile_class = percentile_class.where(era5_Imerg['Imerg_orgres'] >= percentile_value, i) 

# Add the new DataArray as a variable in the original dataset 
era5_Imerg['Imerg_orgres 100 percentile class'] = percentile_class
era5_Imerg

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 5GB
Dimensions:                            (time: 7300, lon: 150, lat: 60)
Coordinates:
  * time                               (time) datetime64[ns] 58kB 2001-01-01T...
  * lon                                (lon) float64 1kB 4.05 4.15 ... 18.95
  * lat                                (lat) float64 480B 43.05 43.15 ... 48.95
    custom_dayofyear                   (time) int32 29kB 1 2 3 4 ... 363 364 365
Data variables: (12/20)
    cape                               (time, lat, lon) float32 263MB 1.421 ....
    tciw                               (time, lat, lon) float32 263MB 0.00396...
    tcwv                               (time, lat, lon) float32 263MB 18.88 ....
    p71.162                            (time, lat, lon) float32 263MB 159.9 ....
    tp_NearestN                        (time, lat, lon) float32 263MB 0.1367 ...
    t                                  (time, lat, lon) float32 263MB 256.5 ....
    ...                                 ...
    Imerg P with threshold             (time, lat, lon) float32 263MB 0.0 ......
    precipitationQualityIndex          (time, lat, lon) float32 263MB 0.6412 ...
    Train/Valid/Test indices           (time, lat, lon) object 526MB &#x27;test&#x27; ....
    XGB                                (time, lat, lon) float32 263MB 0.2473 ...
    Z 100 percentile class             (time, lat, lon) float32 263MB 13.0 .....
    Imerg_orgres 100 percentile class  (time, lat, lon) float32 263MB 62.0 .....
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-6e0412fa-b69e-4ea9-a878-9cc02b78a4d8' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-6e0412fa-b69e-4ea9-a878-9cc02b78a4d8' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 7300</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e56ff738-19b0-4461-b394-baf51c49a0a4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e56ff738-19b0-4461-b394-baf51c49a0a4' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01T11:00:00 ... 2020-12-...</div><input id='attrs-8d72d2ec-02b8-42df-a861-db8b19aa39bc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8d72d2ec-02b8-42df-a861-db8b19aa39bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b2fd4f9a-648b-4592-b656-982b9e5e8f5b' class='xr-var-data-in' type='checkbox'><label for='data-b2fd4f9a-648b-4592-b656-982b9e5e8f5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T11:00:00.000000000&#x27;, &#x27;2001-01-02T11:00:00.000000000&#x27;,
       &#x27;2001-01-03T11:00:00.000000000&#x27;, ..., &#x27;2020-12-29T11:00:00.000000000&#x27;,
       &#x27;2020-12-30T11:00:00.000000000&#x27;, &#x27;2020-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-617a5c40-51e8-4105-b25c-af5107cc6148' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-617a5c40-51e8-4105-b25c-af5107cc6148' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6010feb5-c1e1-46b9-8882-f9ab5bc6b092' class='xr-var-data-in' type='checkbox'><label for='data-6010feb5-c1e1-46b9-8882-f9ab5bc6b092' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-4e6ec0c4-95c9-4077-8a5f-4b531010ad96' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4e6ec0c4-95c9-4077-8a5f-4b531010ad96' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4ba80fe0-16cb-4d2f-a4e2-3d60c22b6c43' class='xr-var-data-in' type='checkbox'><label for='data-4ba80fe0-16cb-4d2f-a4e2-3d60c22b6c43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>custom_dayofyear</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>1 2 3 4 5 6 ... 361 362 363 364 365</div><input id='attrs-f8cf95f4-5cce-4897-af94-6caf85c40ecd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8cf95f4-5cce-4897-af94-6caf85c40ecd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec0293c0-4a86-4fc6-9ed4-a2fb31515d43' class='xr-var-data-in' type='checkbox'><label for='data-ec0293c0-4a86-4fc6-9ed4-a2fb31515d43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([  1,   2,   3, ..., 363, 364, 365])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0cc7731a-14df-4a3e-b824-653f7f614c0c' class='xr-section-summary-in' type='checkbox'  ><label for='section-0cc7731a-14df-4a3e-b824-653f7f614c0c' class='xr-section-summary' >Data variables: <span>(20)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>cape</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.421 2.406 2.406 ... 8.468 7.731</div><input id='attrs-967ae16b-2278-479d-af15-da3afebe2e97' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-967ae16b-2278-479d-af15-da3afebe2e97' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75391c1d-fa23-446a-98dc-53b5e8ffe7e5' class='xr-var-data-in' type='checkbox'><label for='data-75391c1d-fa23-446a-98dc-53b5e8ffe7e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>J kg**-1</dd></dl></div><div class='xr-var-data'><pre>array([[[1.42149377e+00, 2.40560484e+00, 2.40560484e+00, ...,
         1.85887647e+00, 1.85887647e+00, 1.20280242e+00],
        [5.79532051e+00, 8.41961670e+00, 8.41961670e+00, ...,
         7.65419722e-01, 7.65419722e-01, 6.56074047e-01],
        [5.79532051e+00, 8.41961670e+00, 8.41961670e+00, ...,
         7.65419722e-01, 7.65419722e-01, 6.56074047e-01],
        ...,
        [5.64223671e+01, 9.40372772e+01, 9.40372772e+01, ...,
         1.34495182e+01, 1.34495182e+01, 1.58551226e+01],
        [5.64223671e+01, 9.40372772e+01, 9.40372772e+01, ...,
         1.34495182e+01, 1.34495182e+01, 1.58551226e+01],
        [7.07466507e+01, 1.14922302e+02, 1.14922302e+02, ...,
         1.37775545e+01, 1.37775545e+01, 1.66205425e+01]],

       [[3.08026764e+02, 3.51108948e+02, 3.51108948e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [3.90036011e+02, 4.59798553e+02, 4.59798553e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
        [3.90036011e+02, 4.59798553e+02, 4.59798553e+02, ...,
         0.00000000e+00, 0.00000000e+00, 0.00000000e+00],
...
        [8.07501678e+01, 6.60236893e+01, 6.60236893e+01, ...,
         6.88462677e+01, 6.88462677e+01, 5.93967781e+01],
        [8.07501678e+01, 6.60236893e+01, 6.60236893e+01, ...,
         6.88462677e+01, 6.88462677e+01, 5.93967781e+01],
        [6.67600174e+01, 6.30783958e+01, 6.30783958e+01, ...,
         4.87200851e+01, 4.87200851e+01, 4.46703033e+01]],

       [[1.96352983e+00, 1.71808863e+00, 1.71808863e+00, ...,
         1.56346069e+02, 1.56346069e+02, 1.62604813e+02],
        [2.57713294e+00, 2.08625054e+00, 2.08625054e+00, ...,
         1.43951279e+02, 1.43951279e+02, 1.48860107e+02],
        [2.57713294e+00, 2.08625054e+00, 2.08625054e+00, ...,
         1.43951279e+02, 1.43951279e+02, 1.48860107e+02],
        ...,
        [3.64480209e+01, 3.05574322e+01, 3.05574322e+01, ...,
         8.83588409e+00, 8.83588409e+00, 1.23947821e+01],
        [3.64480209e+01, 3.05574322e+01, 3.05574322e+01, ...,
         8.83588409e+00, 8.83588409e+00, 1.23947821e+01],
        [8.74997940e+01, 9.31449432e+01, 9.31449432e+01, ...,
         8.46772194e+00, 8.46772194e+00, 7.73139858e+00]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.003961 0.003729 ... 0.008197</div><input id='attrs-07c0a8bd-4086-421c-a4f8-3cb384bec4c4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-07c0a8bd-4086-421c-a4f8-3cb384bec4c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c0facaee-ab00-4146-9207-801522b0a5fc' class='xr-var-data-in' type='checkbox'><label for='data-c0facaee-ab00-4146-9207-801522b0a5fc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00396065, 0.00372946, 0.00372946, ..., 0.00600242,
         0.00600242, 0.00858445],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        [0.00576272, 0.00557046, 0.00557046, ..., 0.00733359,
         0.00733359, 0.00980124],
        ...,
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.17260042, 0.16283934, 0.16283934, ..., 0.00175583,
         0.00175583, 0.00154897],
        [0.1906941 , 0.18682712, 0.18682712, ..., 0.00204542,
         0.00204542, 0.00221699]],

       [[0.01085742, 0.01028309, 0.01028309, ..., 0.00312593,
         0.00312593, 0.00286189],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
        [0.00973919, 0.01069437, 0.01069437, ..., 0.00315392,
         0.00315392, 0.00284242],
...
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.01665011, 0.01652823, 0.01652823, ..., 0.06891213,
         0.06891213, 0.07973655],
        [0.0238106 , 0.02424006, 0.02424006, ..., 0.05962081,
         0.05962081, 0.07175583]],

       [[0.01953055, 0.01821994, 0.01821994, ..., 0.08899305,
         0.08899305, 0.0906509 ],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        [0.02826282, 0.02438611, 0.02438611, ..., 0.08719978,
         0.08719978, 0.08853071],
        ...,
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.0197182 , 0.02185387, 0.02185387, ..., 0.00950606,
         0.00950606, 0.01183034],
        [0.02613488, 0.02631286, 0.02631286, ..., 0.00620002,
         0.00620002, 0.00819738]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>18.88 19.2 19.2 ... 8.158 8.136</div><input id='attrs-940f50ae-af6c-4bcc-85a1-ddc333b438e0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-940f50ae-af6c-4bcc-85a1-ddc333b438e0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3fda9935-e1b9-4105-9c54-0d71a9ca8f36' class='xr-var-data-in' type='checkbox'><label for='data-3fda9935-e1b9-4105-9c54-0d71a9ca8f36' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[18.877731 , 19.196379 , 19.196379 , ...,  4.8336053,
          4.8336053,  4.543007 ],
        [19.209276 , 19.41561  , 19.41561  , ...,  4.5966434,
          4.5966434,  4.376464 ],
        [19.209276 , 19.41561  , 19.41561  , ...,  4.5966434,
          4.5966434,  4.376464 ],
        ...,
        [20.010712 , 19.974598 , 19.974598 , ...,  3.242357 ,
          3.242357 ,  3.0428135],
        [20.010712 , 19.974598 , 19.974598 , ...,  3.242357 ,
          3.242357 ,  3.0428135],
        [19.929708 , 19.932613 , 19.932613 , ...,  3.2648315,
          3.2648315,  3.0128968]],

       [[15.671308 , 15.798683 , 15.798683 , ...,  7.835593 ,
          7.835593 ,  7.274292 ],
        [16.164532 , 16.669025 , 16.669025 , ...,  7.8434505,
          7.8434505,  7.2999687],
        [16.164532 , 16.669025 , 16.669025 , ...,  7.8434505,
          7.8434505,  7.2999687],
...
        [ 9.282007 ,  9.340907 ,  9.340907 , ..., 11.058987 ,
         11.058987 , 10.746535 ],
        [ 9.282007 ,  9.340907 ,  9.340907 , ..., 11.058987 ,
         11.058987 , 10.746535 ],
        [ 9.309742 ,  9.363061 ,  9.363061 , ..., 10.769295 ,
         10.769295 , 10.364661 ]],

       [[13.382874 , 13.546597 , 13.546597 , ...,  7.7033434,
          7.7033434,  7.201854 ],
        [13.894079 , 13.908097 , 13.908097 , ...,  7.4785695,
          7.4785695,  6.996142 ],
        [13.894079 , 13.908097 , 13.908097 , ...,  7.4785695,
          7.4785695,  6.996142 ],
        ...,
        [10.919603 , 11.086487 , 11.086487 , ...,  8.726594 ,
          8.726594 ,  8.769457 ],
        [10.919603 , 11.086487 , 11.086487 , ...,  8.726594 ,
          8.726594 ,  8.769457 ],
        [10.799081 , 10.932009 , 10.932009 , ...,  8.158472 ,
          8.158472 ,  8.136149 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>p71.162</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>159.9 161.7 161.7 ... 4.103 3.952</div><input id='attrs-d8110127-3d47-4716-84dd-48826117a567' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d8110127-3d47-4716-84dd-48826117a567' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-625ba8ec-f71c-4bce-92da-395639c90352' class='xr-var-data-in' type='checkbox'><label for='data-625ba8ec-f71c-4bce-92da-395639c90352' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Vertical integral of eastward water vapour flux</dd><dt><span>units :</span></dt><dd>kg m**-1 s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[159.90842  , 161.68945  , 161.68945  , ...,  -8.736225 ,
          -8.736225 ,  -8.706814 ],
        [117.19496  , 122.65574  , 122.65574  , ...,  -9.781975 ,
          -9.781975 ,  -9.771082 ],
        [117.19496  , 122.65574  , 122.65574  , ...,  -9.781975 ,
          -9.781975 ,  -9.771082 ],
        ...,
        [286.63046  , 283.61194  , 283.61194  , ...,  13.492501 ,
          13.492501 ,  12.484877 ],
        [286.63046  , 283.61194  , 283.61194  , ...,  13.492501 ,
          13.492501 ,  12.484877 ],
        [287.56183  , 283.30038  , 283.30038  , ...,  14.747401 ,
          14.747401 ,  13.6362915]],

       [[151.33109  , 161.32562  , 161.32562  , ...,  66.51857  ,
          66.51857  ,  62.082844 ],
        [139.97707  , 141.0653   , 141.0653   , ...,  67.892204 ,
          67.892204 ,  63.38023  ],
        [139.97707  , 141.0653   , 141.0653   , ...,  67.892204 ,
          67.892204 ,  63.38023  ],
...
        [ 68.680405 ,  68.439766 ,  68.439766 , ...,  42.62315  ,
          42.62315  ,  42.001633 ],
        [ 68.680405 ,  68.439766 ,  68.439766 , ...,  42.62315  ,
          42.62315  ,  42.001633 ],
        [ 66.06323  ,  65.84251  ,  65.84251  , ...,  44.872726 ,
          44.872726 ,  43.831333 ]],

       [[ 92.37524  ,  97.72742  ,  97.72742  , ...,  46.87834  ,
          46.87834  ,  48.336296 ],
        [110.98922  , 106.324104 , 106.324104 , ...,  49.877228 ,
          49.877228 ,  51.400734 ],
        [110.98922  , 106.324104 , 106.324104 , ...,  49.877228 ,
          49.877228 ,  51.400734 ],
        ...,
        [ 91.23841  ,  93.67802  ,  93.67802  , ...,   4.454188 ,
           4.454188 ,   5.0574493],
        [ 91.23841  ,  93.67802  ,  93.67802  , ...,   4.454188 ,
           4.454188 ,   5.0574493],
        [ 85.56676  ,  88.348236 ,  88.348236 , ...,   4.103184 ,
           4.103184 ,   3.952161 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3987 ... 0.01035 0.05329</div><input id='attrs-c8c9b2ce-d7ae-4055-8ddf-f3e458c36578' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c8c9b2ce-d7ae-4055-8ddf-f3e458c36578' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fb95b2cb-d8f7-40c2-be94-2450595e46b4' class='xr-var-data-in' type='checkbox'><label for='data-fb95b2cb-d8f7-40c2-be94-2450595e46b4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[1.3668407e-01, 3.9868617e-01, 3.9868617e-01, ...,
         3.1475224e-02, 3.1475224e-02, 5.8870330e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        [8.1573296e-01, 1.0453855e+00, 1.0453855e+00, ...,
         2.5355043e-02, 2.5355043e-02, 6.7904882e-02],
        ...,
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.1190025e+01, 8.2750702e+00, 8.2750702e+00, ...,
         1.8943423e-02, 1.8943423e-02, 2.3023544e-02],
        [1.0786386e+01, 9.8406706e+00, 9.8406706e+00, ...,
         2.9726602e-02, 2.9726602e-02, 1.0404311e-01]],

       [[8.8159776e-01, 7.8338337e-01, 7.8338337e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
        [7.0090663e-01, 8.0465829e-01, 8.0465829e-01, ...,
         3.6998399e-15, 3.6998399e-15, 3.6998399e-15],
...
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.4181972e-01, 8.9844418e-01, 8.9844418e-01, ...,
         9.2847853e+00, 9.2847853e+00, 1.0145202e+01],
        [6.7751950e-01, 6.9692153e-01, 6.9692153e-01, ...,
         7.1722903e+00, 7.1722903e+00, 7.7952251e+00]],

       [[9.2095047e-01, 9.3828297e-01, 9.3828297e-01, ...,
         1.2160686e+01, 1.2160686e+01, 1.5352452e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        [1.5516464e+00, 1.8519901e+00, 1.8519901e+00, ...,
         8.2983847e+00, 8.2983847e+00, 1.1352267e+01],
        ...,
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [6.7022433e+00, 6.5478029e+00, 6.5478029e+00, ...,
         1.2934698e-02, 1.2934698e-02, 3.2854132e-02],
        [9.4371557e+00, 8.2243986e+00, 8.2243986e+00, ...,
         1.0347758e-02, 1.0347758e-02, 5.3290959e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>256.5 256.6 256.6 ... 243.3 243.5</div><input id='attrs-149a7c3e-51a0-40c5-a9f5-d96c6ce5fa3a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-149a7c3e-51a0-40c5-a9f5-d96c6ce5fa3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9193e116-4186-413d-a44a-5de7a96e39d3' class='xr-var-data-in' type='checkbox'><label for='data-9193e116-4186-413d-a44a-5de7a96e39d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[256.49066, 256.55716, 256.55716, ..., 253.0052 , 253.0052 ,
         252.8964 ],
        [256.3024 , 256.37775, 256.37775, ..., 252.967  , 252.967  ,
         252.8425 ],
        [256.3024 , 256.37775, 256.37775, ..., 252.967  , 252.967  ,
         252.8425 ],
        ...,
        [253.51062, 253.58298, 253.58298, ..., 249.6429 , 249.6429 ,
         249.37024],
        [253.51062, 253.58298, 253.58298, ..., 249.6429 , 249.6429 ,
         249.37024],
        [253.46223, 253.53143, 253.53143, ..., 249.55763, 249.55763,
         249.29507]],

       [[250.23323, 250.36234, 250.36234, ..., 256.82962, 256.82962,
         256.794  ],
        [249.84349, 249.96606, 249.96606, ..., 256.63492, 256.63492,
         256.6397 ],
        [249.84349, 249.96606, 249.96606, ..., 256.63492, 256.63492,
         256.6397 ],
...
        [240.7823 , 240.72282, 240.72282, ..., 244.64058, 244.64058,
         244.82233],
        [240.7823 , 240.72282, 240.72282, ..., 244.64058, 244.64058,
         244.82233],
        [240.81447, 240.75978, 240.75978, ..., 244.45679, 244.45679,
         244.63727]],

       [[244.8327 , 244.82104, 244.82104, ..., 245.76154, 245.76154,
         245.93304],
        [244.73772, 244.7326 , 244.7326 , ..., 245.59546, 245.59546,
         245.74634],
        [244.73772, 244.7326 , 244.7326 , ..., 245.59546, 245.59546,
         245.74634],
        ...,
        [243.22255, 243.1899 , 243.1899 , ..., 243.45236, 243.45236,
         243.61055],
        [243.22255, 243.1899 , 243.1899 , ..., 243.45236, 243.45236,
         243.61055],
        [243.14436, 243.11359, 243.11359, ..., 243.3091 , 243.3091 ,
         243.47261]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>20.11 19.95 19.95 ... 7.23 6.83</div><input id='attrs-0df23afc-8ccb-4fca-bacb-7d4850d96abb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0df23afc-8ccb-4fca-bacb-7d4850d96abb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-09fe6c6a-6635-4b61-8eed-734ac01ffe76' class='xr-var-data-in' type='checkbox'><label for='data-09fe6c6a-6635-4b61-8eed-734ac01ffe76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>long_name :</span></dt><dd>U component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[20.108004 , 19.954151 , 19.954151 , ...,  3.0157864,
          3.0157864,  2.8875213],
        [20.012627 , 19.833845 , 19.833845 , ...,  3.5658135,
          3.5658135,  3.3602605],
        [20.012627 , 19.833845 , 19.833845 , ...,  3.5658135,
          3.5658135,  3.3602605],
        ...,
        [20.374466 , 20.11675  , 20.11675  , ...,  6.796845 ,
          6.796845 ,  6.548471 ],
        [20.374466 , 20.11675  , 20.11675  , ...,  6.796845 ,
          6.796845 ,  6.548471 ],
        [20.499376 , 20.28547  , 20.28547  , ...,  6.7144265,
          6.7144265,  6.4787474]],

       [[20.784979 , 21.070978 , 21.070978 , ..., 12.162143 ,
         12.162143 , 11.474379 ],
        [19.814507 , 20.141943 , 20.141943 , ..., 11.756627 ,
         11.756627 , 11.308094 ],
        [19.814507 , 20.141943 , 20.141943 , ..., 11.756627 ,
         11.756627 , 11.308094 ],
...
        [ 9.120344 ,  9.079311 ,  9.079311 , ...,  9.823612 ,
          9.823612 , 10.284766 ],
        [ 9.120344 ,  9.079311 ,  9.079311 , ...,  9.823612 ,
          9.823612 , 10.284766 ],
        [ 9.412321 ,  9.313931 ,  9.313931 , ...,  9.398668 ,
          9.398668 ,  9.8454275]],

       [[11.067429 , 11.066463 , 11.066463 , ..., 11.471893 ,
         11.471893 , 11.6907835],
        [11.268584 , 11.259829 , 11.259829 , ..., 11.427002 ,
         11.427002 , 11.534369 ],
        [11.268584 , 11.259829 , 11.259829 , ..., 11.427002 ,
         11.427002 , 11.534369 ],
        ...,
        [12.826935 , 12.874274 , 12.874274 , ...,  6.6019187,
          6.6019187,  6.245313 ],
        [12.826935 , 12.874274 , 12.874274 , ...,  6.6019187,
          6.6019187,  6.245313 ],
        [12.332169 , 12.405997 , 12.405997 , ...,  7.2296515,
          7.2296515,  6.8303065]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>6.344 5.785 5.785 ... 10.44 10.05</div><input id='attrs-833f4ef5-b956-434c-a9b0-4de85c0a2b97' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-833f4ef5-b956-434c-a9b0-4de85c0a2b97' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f9c114f9-c0bd-4c0d-b95e-652f1d76d338' class='xr-var-data-in' type='checkbox'><label for='data-f9c114f9-c0bd-4c0d-b95e-652f1d76d338' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>northward_wind</dd><dt><span>long_name :</span></dt><dd>V component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[[  6.3441896 ,   5.784615  ,   5.784615  , ..., -12.864283  ,
         -12.864283  , -12.383464  ],
        [  6.9686565 ,   6.3644724 ,   6.3644724 , ..., -12.986172  ,
         -12.986172  , -12.606511  ],
        [  6.9686565 ,   6.3644724 ,   6.3644724 , ..., -12.986172  ,
         -12.986172  , -12.606511  ],
        ...,
        [ 16.116722  ,  15.465233  ,  15.465233  , ..., -13.588623  ,
         -13.588623  , -13.552743  ],
        [ 16.116722  ,  15.465233  ,  15.465233  , ..., -13.588623  ,
         -13.588623  , -13.552743  ],
        [ 16.76744   ,  16.132448  ,  16.132448  , ..., -13.333484  ,
         -13.333484  , -13.337399  ]],

       [[ 14.833962  ,  15.567546  ,  15.567546  , ...,  -2.4402611 ,
          -2.4402611 ,  -2.8993204 ],
        [ 15.215612  ,  15.922046  ,  15.922046  , ...,  -1.9712529 ,
          -1.9712529 ,  -2.2977679 ],
        [ 15.215612  ,  15.922046  ,  15.922046  , ...,  -1.9712529 ,
          -1.9712529 ,  -2.2977679 ],
...
        [ -3.5205407 ,  -3.2907648 ,  -3.2907648 , ...,  14.277745  ,
          14.277745  ,  14.76931   ],
        [ -3.5205407 ,  -3.2907648 ,  -3.2907648 , ...,  14.277745  ,
          14.277745  ,  14.76931   ],
        [ -3.5959318 ,  -3.3709369 ,  -3.3709369 , ...,  13.863788  ,
          13.863788  ,  14.258135  ]],

       [[ -0.47725597,  -0.46984163,  -0.46984163, ...,   9.522158  ,
           9.522158  ,   9.881096  ],
        [ -0.5962323 ,  -0.6097444 ,  -0.6097444 , ...,   9.097391  ,
           9.097391  ,   9.500954  ],
        [ -0.5962323 ,  -0.6097444 ,  -0.6097444 , ...,   9.097391  ,
           9.097391  ,   9.500954  ],
        ...,
        [  4.752296  ,   4.976113  ,   4.976113  , ...,   9.918306  ,
           9.918306  ,   9.614942  ],
        [  4.752296  ,   4.976113  ,   4.976113  , ...,   9.918306  ,
           9.918306  ,   9.614942  ],
        [  4.716541  ,   4.961631  ,   4.961631  , ...,  10.436342  ,
          10.436342  ,  10.045598  ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001835 0.001866 ... 0.0008634</div><input id='attrs-12c8c976-9f7e-48f5-984a-edc672c729bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-12c8c976-9f7e-48f5-984a-edc672c729bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2abd694c-58b5-4354-877e-2b696f1eb3f9' class='xr-var-data-in' type='checkbox'><label for='data-2abd694c-58b5-4354-877e-2b696f1eb3f9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00183537, 0.00186572, 0.00186572, ..., 0.00054247,
         0.00054247, 0.00051925],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        [0.00186921, 0.0018869 , 0.0018869 , ..., 0.00051476,
         0.00051476, 0.00049849],
        ...,
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00199499, 0.00198691, 0.00198691, ..., 0.00033613,
         0.00033613, 0.0003181 ],
        [0.00198949, 0.00198537, 0.00198537, ..., 0.00033977,
         0.00033977, 0.00031719]],

       [[0.00152829, 0.00154093, 0.00154093, ..., 0.00087483,
         0.00087483, 0.00082731],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
        [0.00157849, 0.00162612, 0.00162612, ..., 0.00087545,
         0.00087545, 0.000829  ],
...
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092307, 0.00092708, 0.00092708, ..., 0.00115983,
         0.00115983, 0.00113628],
        [0.00092696, 0.0009305 , 0.0009305 , ..., 0.00113349,
         0.00113349, 0.00110327]],

       [[0.00129985, 0.00131616, 0.00131616, ..., 0.00086787,
         0.00086787, 0.00082671],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        [0.00135112, 0.00135134, 0.00135134, ..., 0.00084236,
         0.00084236, 0.00080194],
        ...,
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00108715, 0.00110153, 0.00110153, ..., 0.00091241,
         0.00091241, 0.00092467],
        [0.00107646, 0.0010876 , 0.0010876 , ..., 0.0008558 ,
         0.0008558 , 0.00086335]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-a44f21d4-227a-4b34-8818-9b4cf41c37d8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a44f21d4-227a-4b34-8818-9b4cf41c37d8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fa941b3d-d701-432c-8f02-90c3125702f0' class='xr-var-data-in' type='checkbox'><label for='data-fa941b3d-d701-432c-8f02-90c3125702f0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1367 0.3332 ... 0.02108 0.05329</div><input id='attrs-eb35ff33-e857-47d4-be2c-5123cf215d31' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-eb35ff33-e857-47d4-be2c-5123cf215d31' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6ec4233b-4590-4bfa-84fb-8170840b7cd6' class='xr-var-data-in' type='checkbox'><label for='data-6ec4233b-4590-4bfa-84fb-8170840b7cd6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[1.36684075e-01, 3.33186150e-01, 3.98686171e-01, ...,
         3.14752236e-02, 3.83242071e-02, 5.88703305e-02],
        [6.45866632e-01, 8.24175656e-01, 8.83611500e-01, ...,
         2.68860273e-02, 3.65760289e-02, 6.56448528e-02],
        [8.15732956e-01, 9.87972856e-01, 1.04538548e+00, ...,
         2.53550429e-02, 3.59928273e-02, 6.79048821e-02],
        ...,
        [1.11900253e+01, 9.00380325e+00, 8.27507019e+00, ...,
         1.89434234e-02, 1.99634824e-02, 2.30235439e-02],
        [1.10891905e+01, 9.27192497e+00, 8.66617775e+00, ...,
         2.16371994e-02, 2.70438790e-02, 4.32632640e-02],
        [1.07863855e+01, 1.00770979e+01, 9.84067059e+00, ...,
         2.97266021e-02, 4.83062938e-02, 1.04043111e-01]],

       [[8.81597757e-01, 8.07936788e-01, 7.83383369e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.46107101e-01, 7.86029100e-01, 7.99336314e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
        [7.00906634e-01, 7.78720617e-01, 8.04658294e-01, ...,
         3.69983991e-15, 3.69983991e-15, 3.69983991e-15],
...
        [6.41819715e-01, 8.34288538e-01, 8.98444176e-01, ...,
         9.28478527e+00, 9.49989510e+00, 1.01452017e+01],
        [6.50737941e-01, 7.98760772e-01, 8.48101199e-01, ...,
         8.75705624e+00, 8.95733547e+00, 9.55814743e+00],
        [6.77519500e-01, 6.92071021e-01, 6.96921527e-01, ...,
         7.17229033e+00, 7.32802868e+00, 7.79522514e+00]],

       [[9.20950472e-01, 9.33949888e-01, 9.38282967e-01, ...,
         1.21606855e+01, 1.29586525e+01, 1.53524523e+01],
        [1.39387572e+00, 1.56603670e+00, 1.62342322e+00, ...,
         9.26455212e+00, 1.00366697e+01, 1.23529272e+01],
        [1.55164635e+00, 1.77690482e+00, 1.85199010e+00, ...,
         8.29838467e+00, 9.06187820e+00, 1.13522673e+01],
        ...,
        [6.70224333e+00, 6.58641291e+00, 6.54780293e+00, ...,
         1.29346978e-02, 1.79147087e-02, 3.28541324e-02],
        [7.38545942e+00, 7.07134295e+00, 6.96663809e+00, ...,
         1.22884475e-02, 1.87064093e-02, 3.79595123e-02],
        [9.43715572e+00, 8.52758598e+00, 8.22439861e+00, ...,
         1.03477584e-02, 2.10838839e-02, 5.32909594e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.61 1.58 2.02 ... 0.145 0.035</div><input id='attrs-32ebb1c3-d68d-4d4e-87d3-a9fb1dfaed07' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-32ebb1c3-d68d-4d4e-87d3-a9fb1dfaed07' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a85ce0c-e42e-448c-9148-59c2f3e397ee' class='xr-var-data-in' type='checkbox'><label for='data-6a85ce0c-e42e-448c-9148-59c2f3e397ee' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[6.1000001e-01, 1.5799999e+00, 2.0200000e+00, ...,
         4.2000002e-01, 3.8499999e-01, 4.9999999e-03],
        [5.8999997e-01, 9.2999995e-01, 1.2150000e+00, ...,
         4.9999999e-03, 4.4999998e-02, 1.5000001e-01],
        [4.9999997e-01, 1.1899999e+00, 2.2049999e+00, ...,
         4.9999999e-03, 3.5599999e+00, 5.9649997e+00],
        ...,
        [1.6609999e+01, 1.5525002e+01, 1.7244999e+01, ...,
         6.4999998e-02, 1.2500000e-01, 2.1500000e-01],
        [1.7240000e+01, 1.7229998e+01, 1.8010000e+01, ...,
         6.4999998e-02, 1.3000000e-01, 2.4499999e-01],
        [1.8300001e+01, 1.8120001e+01, 1.6420000e+01, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00]],

       [[2.2499999e-01, 1.1249999e+00, 1.2649999e+00, ...,
         2.3000000e+00, 7.1000004e-01, 9.7499996e-01],
        [1.1150000e+00, 1.3800000e+00, 6.9999993e-01, ...,
         0.0000000e+00, 1.0799999e+00, 1.2550000e+00],
        [1.2550000e+00, 1.3750000e+00, 6.9499993e-01, ...,
         2.2599998e+00, 2.3750000e+00, 3.2000002e-01],
...
        [0.0000000e+00, 3.5000000e-02, 3.5000000e-02, ...,
         5.3499997e-01, 2.6900001e+00, 1.6500001e+00],
        [0.0000000e+00, 2.4999999e-02, 2.4999999e-02, ...,
         4.8499995e-01, 1.4999999e-01, 9.9500000e-01],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.2099999e+00, 7.2999990e-01, 4.7499999e-01]],

       [[3.6499998e-01, 9.2499995e-01, 5.6500000e-01, ...,
         2.1639997e+01, 1.0120000e+01, 5.6199999e+00],
        [1.1350000e+00, 1.9250002e+00, 1.6949999e+00, ...,
         2.4250000e+01, 1.9094999e+01, 8.8450003e+00],
        [7.6499999e-01, 2.0149999e+00, 3.5400000e+00, ...,
         1.5814999e+01, 1.9750000e+01, 1.4844999e+01],
        ...,
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         0.0000000e+00, 0.0000000e+00, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         3.9999999e-02, 1.5000000e-02, 0.0000000e+00],
        [0.0000000e+00, 0.0000000e+00, 0.0000000e+00, ...,
         1.5000000e-02, 1.4500000e-01, 3.5000000e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Seasonal Mask</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;winter&#x27; &#x27;winter&#x27; ... &#x27;winter&#x27;</div><input id='attrs-e6f8d8d8-ea75-43f1-bfe6-760177d132b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6f8d8d8-ea75-43f1-bfe6-760177d132b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36c6b45e-e34b-4f5c-a3c7-c9038bc46931' class='xr-var-data-in' type='checkbox'><label for='data-36c6b45e-e34b-4f5c-a3c7-c9038bc46931' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;, ..., &#x27;winter&#x27;, &#x27;winter&#x27;, &#x27;winter&#x27;],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Rain/No rain threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>0 1 1 1 1 0 0 0 ... 0 0 0 0 0 0 0 0</div><input id='attrs-1d220cfb-2680-424b-b792-d6964eb3d946' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1d220cfb-2680-424b-b792-d6964eb3d946' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-08485fb3-3605-48ec-8aab-dc819ef6628d' class='xr-var-data-in' type='checkbox'><label for='data-08485fb3-3605-48ec-8aab-dc819ef6628d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0, 1, 1, ..., 0, 0, 0],
        [0, 0, 1, ..., 0, 0, 0],
        [0, 1, 1, ..., 0, 1, 1],
        ...,
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0],
        [1, 1, 1, ..., 0, 0, 0]],

       [[0, 1, 1, ..., 1, 0, 0],
        [1, 1, 0, ..., 0, 1, 1],
        [1, 1, 0, ..., 1, 1, 0],
        ...,
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
...
        ...,
        [1, 1, 0, ..., 1, 1, 1],
        [1, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1]],

       [[0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        [0, 0, 0, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 1, 1],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 1, 0, 0]],

       [[0, 0, 0, ..., 1, 1, 1],
        [1, 1, 1, ..., 1, 1, 1],
        [0, 1, 1, ..., 1, 1, 1],
        ...,
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0],
        [0, 0, 0, ..., 0, 0, 0]]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg P with threshold</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 1.58 2.02 2.445 ... 0.0 0.0 0.0</div><input id='attrs-7e50624f-24c9-4fce-bc95-52c5a3500aee' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e50624f-24c9-4fce-bc95-52c5a3500aee' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c233560-d16b-4a59-8a39-afde7fd11e67' class='xr-var-data-in' type='checkbox'><label for='data-7c233560-d16b-4a59-8a39-afde7fd11e67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.       ,  1.5799999,  2.02     , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  1.215    , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  1.1899999,  2.205    , ...,  0.       ,
          3.56     ,  5.9649997],
        ...,
        [16.609999 , 15.525002 , 17.244999 , ...,  0.       ,
          0.       ,  0.       ],
        [17.24     , 17.229998 , 18.01     , ...,  0.       ,
          0.       ,  0.       ],
        [18.300001 , 18.12     , 16.42     , ...,  0.       ,
          0.       ,  0.       ]],

       [[ 0.       ,  1.1249999,  1.2649999, ...,  2.3      ,
          0.       ,  0.       ],
        [ 1.115    ,  1.38     ,  0.       , ...,  0.       ,
          1.0799999,  1.255    ],
        [ 1.255    ,  1.375    ,  0.       , ...,  2.2599998,
          2.375    ,  0.       ],
...
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          2.69     ,  1.6500001],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  1.2099999,
          0.       ,  0.       ]],

       [[ 0.       ,  0.       ,  0.       , ..., 21.639997 ,
         10.12     ,  5.62     ],
        [ 1.135    ,  1.9250002,  1.6949999, ..., 24.25     ,
         19.095    ,  8.845    ],
        [ 0.       ,  2.0149999,  3.54     , ..., 15.814999 ,
         19.75     , 14.844999 ],
        ...,
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ],
        [ 0.       ,  0.       ,  0.       , ...,  0.       ,
          0.       ,  0.       ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitationQualityIndex</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.6412 0.6368 ... 0.7227 0.7227</div><input id='attrs-34c43209-39e2-4a0e-88a3-9162e657e997' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-34c43209-39e2-4a0e-88a3-9162e657e997' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a489997e-142d-4093-a8dc-4bfd4a381336' class='xr-var-data-in' type='checkbox'><label for='data-a489997e-142d-4093-a8dc-4bfd4a381336' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>DimensionNames :</span></dt><dd>time,lon,lat</dd><dt><span>CodeMissingValue :</span></dt><dd>-9999.9</dd><dt><span>LongName :</span></dt><dd>
Precipitation quality index; qualitative indicator
                        of skill based on the microwave-infrared merging process
</dd></dl></div><div class='xr-var-data'><pre>array([[[0.64120835, 0.63681257, 0.63681257, ..., 0.35652086,
         0.35514584, 0.63293755],
        [0.64385426, 0.64385426, 0.6419167 , ..., 0.3548125 ,
         0.6085208 , 0.35270834],
        [0.6399168 , 0.6399168 , 0.6379792 , ..., 0.34964585,
         0.63293755, 0.35514584],
        ...,
        [0.5837709 , 0.5837709 , 0.579625  , ..., 0.58214587,
         0.36610416, 0.36610416],
        [0.5837709 , 0.5837709 , 0.58064586, ..., 0.3666875 ,
         0.36610416, 0.36589587],
        [0.5852917 , 0.5811458 , 0.58064586, ..., 0.3666875 ,
         0.36589584, 0.36568752]],

       [[0.6909583 , 0.69037503, 0.69037503, ..., 0.5888542 ,
         0.3633542 , 0.5888542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.3633542 ,
         0.5888542 , 0.3633542 ],
        [0.6917084 , 0.6917084 , 0.6909583 , ..., 0.5888542 ,
         0.5888542 , 0.3633542 ],
...
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.7248542 ,
         0.7247917 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72572917,
         0.7250208 , 0.7246042 ],
        [0.72585416, 0.7289583 , 0.733125  , ..., 0.72775   ,
         0.72572917, 0.72554165]],

       [[0.7024792 , 0.6986251 , 0.6899584 , ..., 0.707375  ,
         0.37502083, 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.37502083],
        [0.6986251 , 0.6914792 , 0.6829376 , ..., 0.37502083,
         0.707375  , 0.707375  ],
        ...,
        [0.7012709 , 0.7006251 , 0.70210415, ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7039167 , 0.70210415, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ],
        [0.7019376 , 0.70308334, 0.7049792 , ..., 0.7226875 ,
         0.7226875 , 0.7226875 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Train/Valid/Test indices</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;test&#x27; &#x27;test&#x27; ... &#x27;train&#x27; &#x27;train&#x27;</div><input id='attrs-c419606d-899c-4ee6-b89a-57f2d9301e8c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c419606d-899c-4ee6-b89a-57f2d9301e8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-aba09be0-689e-4146-be02-6f77d002538c' class='xr-var-data-in' type='checkbox'><label for='data-aba09be0-689e-4146-be02-6f77d002538c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        ...,
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;],
        [&#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;, ..., &#x27;test&#x27;, &#x27;test&#x27;, &#x27;test&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
...
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]],

       [[&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        ...,
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;],
        [&#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;, ..., &#x27;train&#x27;, &#x27;train&#x27;, &#x27;train&#x27;]]],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XGB</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.2473 0.2627 ... 0.3281 0.4109</div><input id='attrs-c1c01bcb-6d39-4ab2-a3d0-8677dd85cfd9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1c01bcb-6d39-4ab2-a3d0-8677dd85cfd9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0e93c25d-0b14-490e-98c4-d2ad376e60fa' class='xr-var-data-in' type='checkbox'><label for='data-0e93c25d-0b14-490e-98c4-d2ad376e60fa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[ 0.24732324,  0.26269162,  0.26269162, ...,  0.3851464 ,
          0.3851464 ,  0.39618757],
        [ 0.39167458,  0.47198793,  0.5513218 , ...,  0.38631782,
          0.40761706,  0.4595224 ],
        [ 0.47198793,  0.5513218 ,  0.5513218 , ...,  0.38631782,
          0.40761706,  0.4595224 ],
        ...,
        [18.118355  , 16.037098  , 14.440579  , ...,  0.15804331,
          0.15804331,  0.16411786],
        [18.118355  , 16.214687  , 14.575089  , ...,  0.15804331,
          0.18051544,  0.17340927],
        [18.085691  , 17.438374  , 17.438374  , ...,  0.18051544,
          0.20395152,  0.14014997]],

       [[ 0.6629803 ,  0.6629803 ,  0.6629803 , ...,  0.24914932,
          0.24914932,  0.2546678 ],
        [ 0.64970183,  0.74130785,  0.74130785, ...,  0.24914932,
          0.24914932,  0.2546678 ],
        [ 0.64970183,  0.74130785,  0.74130785, ...,  0.24914932,
          0.24914932,  0.2546678 ],
...
        [ 0.6119468 ,  0.62479043,  0.62479043, ...,  5.2527876 ,
          5.322145  ,  5.6378565 ],
        [ 0.6119468 ,  0.62479043,  0.62479043, ...,  4.709033  ,
          5.2256327 ,  5.423979  ],
        [ 0.74571466,  0.7679962 ,  0.7679962 , ...,  3.2684886 ,
          3.486782  ,  4.3122964 ]],

       [[ 0.9921837 ,  0.93443674,  0.93443674, ...,  5.4613833 ,
          5.37484   ,  5.388532  ],
        [ 1.6640289 ,  1.5659462 ,  1.5700445 , ...,  4.2018476 ,
          4.455406  ,  5.2435036 ],
        [ 1.6916648 ,  1.5832984 ,  1.5832984 , ...,  3.849972  ,
          4.1746926 ,  4.8850408 ],
        ...,
        [ 1.3431462 ,  1.4402862 ,  1.4402862 , ...,  0.44122648,
          0.44122648,  0.48231432],
        [ 1.518772  ,  1.5730064 ,  1.5730064 , ...,  0.44122648,
          0.44122648,  0.48231432],
        [ 1.8865509 ,  1.836851  ,  1.8111199 , ...,  0.3281491 ,
          0.3281491 ,  0.41089818]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Z 100 percentile class</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>13.0 13.0 13.0 ... 71.0 58.0 71.0</div><input id='attrs-c0999623-5d44-4ca9-b5b9-e2bdef045f1c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c0999623-5d44-4ca9-b5b9-e2bdef045f1c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-47c4173e-12c9-4de7-8978-2ae7d4f46ea1' class='xr-var-data-in' type='checkbox'><label for='data-47c4173e-12c9-4de7-8978-2ae7d4f46ea1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
...
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]],

       [[13., 13., 13., ..., 91., 87., 91.],
        [13., 13., 13., ..., 90., 84., 93.],
        [13., 13., 13., ..., 95., 89., 89.],
        ...,
        [26., 28., 29., ..., 64., 74., 80.],
        [24., 23., 24., ..., 67., 63., 79.],
        [21., 19., 20., ..., 71., 58., 71.]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres 100 percentile class</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>62.0 72.0 75.0 ... 43.0 50.0 44.0</div><input id='attrs-67968f81-31f7-4eee-addc-6194e42786c9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-67968f81-31f7-4eee-addc-6194e42786c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1219ec7c-5276-4039-98c3-be77dd7ae09f' class='xr-var-data-in' type='checkbox'><label for='data-1219ec7c-5276-4039-98c3-be77dd7ae09f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[ 62.,  72.,  75., ...,  58.,  58.,  42.],
        [ 61.,  66.,  69., ...,  42.,  45.,  51.],
        [ 60.,  69.,  76., ...,  42.,  82.,  87.],
        ...,
        [ 96.,  96.,  97., ...,  46.,  50.,  53.],
        [ 97.,  97.,  97., ...,  46.,  50.,  54.],
        [ 97.,  97.,  96., ...,  41.,  41.,  41.]],

       [[ 53.,  68.,  69., ...,  76.,  63.,  67.],
        [ 68.,  70.,  63., ...,  41.,  68.,  69.],
        [ 69.,  70.,  63., ...,  76.,  77.,  56.],
        ...,
        [ 74.,  74.,  76., ...,  80.,  80.,  86.],
        [ 80.,  80.,  77., ...,  78.,  81.,  86.],
        [ 78.,  80.,  78., ...,  80.,  82.,  77.]],

       [[ 44.,  45.,  47., ...,  84.,  71.,  88.],
        [ 47.,  44.,  43., ...,  65.,  77.,  81.],
        [ 51.,  46.,  42., ...,  77.,  89.,  79.],
        ...,
...
        ...,
        [ 74.,  70.,  58., ...,  93.,  88.,  96.],
        [ 68.,  56.,  48., ...,  87.,  92.,  93.],
        [ 41.,  41.,  41., ...,  85.,  87.,  91.]],

       [[ 41.,  41.,  41., ..., 100., 100., 100.],
        [ 41.,  41.,  41., ..., 100., 100., 100.],
        [ 41.,  41.,  41., ...,  98.,  96.,  95.],
        ...,
        [ 41.,  44.,  44., ...,  61.,  78.,  72.],
        [ 41.,  43.,  43., ...,  60.,  51.,  67.],
        [ 41.,  41.,  41., ...,  69.,  63.,  59.]],

       [[ 57.,  66.,  61., ...,  98.,  93.,  87.],
        [ 68.,  74.,  73., ...,  98.,  97.,  91.],
        [ 64.,  75.,  81., ...,  96.,  97.,  96.],
        ...,
        [ 41.,  41.,  41., ...,  41.,  41.,  41.],
        [ 41.,  41.,  41., ...,  44.,  43.,  41.],
        [ 41.,  41.,  41., ...,  43.,  50.,  44.]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-66168eef-e3b2-4b77-ad38-3b01c660577b' class='xr-section-summary-in' type='checkbox'  ><label for='section-66168eef-e3b2-4b77-ad38-3b01c660577b' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-1b59f047-4269-4e19-ae55-919276ce55f7' class='xr-index-data-in' type='checkbox'/><label for='index-1b59f047-4269-4e19-ae55-919276ce55f7' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01 11:00:00&#x27;, &#x27;2001-01-02 11:00:00&#x27;,
               &#x27;2001-01-03 11:00:00&#x27;, &#x27;2001-01-04 11:00:00&#x27;,
               &#x27;2001-01-05 11:00:00&#x27;, &#x27;2001-01-06 11:00:00&#x27;,
               &#x27;2001-01-07 11:00:00&#x27;, &#x27;2001-01-08 11:00:00&#x27;,
               &#x27;2001-01-09 11:00:00&#x27;, &#x27;2001-01-10 11:00:00&#x27;,
               ...
               &#x27;2020-12-22 11:00:00&#x27;, &#x27;2020-12-23 11:00:00&#x27;,
               &#x27;2020-12-24 11:00:00&#x27;, &#x27;2020-12-25 11:00:00&#x27;,
               &#x27;2020-12-26 11:00:00&#x27;, &#x27;2020-12-27 11:00:00&#x27;,
               &#x27;2020-12-28 11:00:00&#x27;, &#x27;2020-12-29 11:00:00&#x27;,
               &#x27;2020-12-30 11:00:00&#x27;, &#x27;2020-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=7300, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-320c4727-a295-4ebb-92dc-3ab7cfc994d5' class='xr-index-data-in' type='checkbox'/><label for='index-320c4727-a295-4ebb-92dc-3ab7cfc994d5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-34ffcc8e-2a82-4fee-b49c-32bb9ad30b6f' class='xr-index-data-in' type='checkbox'/><label for='index-34ffcc8e-2a82-4fee-b49c-32bb9ad30b6f' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-3e7e4f80-c651-49df-9760-f83e5462f959' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3e7e4f80-c651-49df-9760-f83e5462f959' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/convective_available_potential_energy_daymax_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/convective_available_potential_energy_daymax_2001_NearestN.nc
Sun Aug 04 14:09:21 2024: cdo -b F32 -daymax -selname,cape /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_convective_available_potential_energy_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/convective_available_potential_energy_daymax_2001.nc
2024-08-03 21:46:28 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722721563.4663277-31296-1-8733f443-6fe5-4260-83b2-9aa5b12398a5.nc /cache/tmp/8733f443-6fe5-4260-83b2-9aa5b12398a5-adaptor.mars.internal-1722720636.4191825-31296-1-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
# Define percentile bins
percentile_bins = [(0, 50), (50, 55), (55, 60), (60, 65), (65, 70), (70, 75), (75, 80), (80, 85), (85, 90), (90, 95), (95, 100)]

# Initialize list to collect results
results = []

for lower, upper in percentile_bins:
    mask = (
        (era5_Imerg['Imerg_orgres 100 percentile class'] > lower) &
        (era5_Imerg['Imerg_orgres 100 percentile class'] <= upper) &
        (era5_Imerg['precipitationQualityIndex'] >= 0.6) &
        (era5_Imerg['Train/Valid/Test indices'] == 'test')
    )

    A = era5_Imerg['Imerg_orgres'].where(mask).values.flatten()
    B = era5_Imerg['XGB'].where(mask).values.flatten()
    C = era5_Imerg['ppt_era5'].where(mask).values.flatten()

    rmse_xgb = np.sqrt(np.nanmean((A - B) ** 2))
    rmse_era5 = np.sqrt(np.nanmean((A - C) ** 2))
    mean_Imerg = np.nanmean(A)

    lower_elev = np.percentile(era5_Imerg['Imerg_orgres'].values.flatten(), lower)
    upper_elev = np.percentile(era5_Imerg['Imerg_orgres'].values.flatten(), upper)

    results.append({
        'lower_percentile': lower,
        'upper_percentile': upper,
        'lower_elev': lower_elev,
        'upper_elev': upper_elev,
        'rmse_xgb': rmse_xgb,
        'rmse_era5': rmse_era5,
        'mean_Imerg': mean_Imerg
    })

# Create DataFrame
df_pclass = pd.DataFrame(results)

# Plotting
fig, ax1 = plt.subplots(figsize=(10, 6))

# Plot RMSE
ax1.errorbar(range(len(df_pclass)), df_pclass['rmse_era5'], fmt='o-', color='blue', label='ERA5')
ax1.errorbar(range(len(df_pclass)), df_pclass['rmse_xgb'], fmt='o-', color='purple', label='XGB')
ax1.set_ylabel('RMSE (mm/d)', color='black', fontsize=20)
ax1.set_xticks(range(len(df_pclass)))
xticklabels = [f"({l},{u}]" for l, u in zip(df_pclass['lower_percentile'], df_pclass['upper_percentile'])]
elev_classes = [f"({l:.1f},{u:.1f})" for l, u in zip(df_pclass['lower_elev'], df_pclass['upper_elev'])]
ax1.set_xticklabels(xticklabels, rotation=45, fontsize=20)
ax1.set_xlabel('IMERG Precipitation percentile', fontsize=20)
ax1.grid(True, which='both', linestyle='--', alpha=0.6)

# Secondary axis for mean IMERG precipitation
ax2 = ax1.twinx()
ax2.plot(range(len(df_pclass)), df_pclass['mean_Imerg'], 'g--o', label='Mean IMERG Precipitation')
ax2.set_ylabel('Mean IMERG Precipitation (mm/d)', color='green', fontsize=20)

# Legend
lines, labels = ax1.get_legend_handles_labels()
lines2, labels2 = ax2.get_legend_handles_labels()
ax1.legend(lines + lines2, labels + labels2, loc='upper left', fontsize=15)

# Elevation classes as secondary x-axis
ax3 = ax1.twiny()
ax3.set_xlim(ax1.get_xlim())
ax3.set_xticks(range(len(df_pclass)))
ax3.set_xticklabels(elev_classes, rotation=45, fontsize=20)
ax3.set_xlabel('IMERG Precipitation (mm/d)', fontsize=20)

plt.tight_layout()
plt.show()

```


    
![png](output_63_0.png)
    



```python
plt.hist(era5_Imerg['Imerg_orgres 100 percentile class'].values.flatten(), bins=100)
# Add labels and title
plt.xlabel('Imerg_orgres 100 Percentile Class')
plt.ylabel('Frequency')
plt.title('Histogram of Imerg_orgres 100 Percentile Class')

# Show the plot
plt.show()
```


    
![png](output_64_0.png)
    


<h1>HISTALP</h1>


```python
histalp = xr.open_dataset(f"{path}/HISTALP/HISTALP_precipitation_all_abs_1801-2014_reconsmapped.nc", decode_times=False)

# Extract raw time values
time_raw = histalp['time'].values

# Define the start date
start_date = pd.Timestamp("1801-01-01")

# Convert "months since" to datetime
decoded_time = [start_date + pd.DateOffset(months=int(month)) for month in time_raw]

# Replace the time variable in the dataset
histalp['time'] = ('time', decoded_time)

histalp = histalp.sel(time=slice("1960-01-01", None))

histalp = histalp.rename({'TOT_PREC': 'PREC_HISTALP'})

Histalp_long = histalp.variables["lon"][:]
Histalp_lat  = histalp.variables["lat"][:]
Histalp_elev= era5_Imerg['ETOPO_consmap_z'][0,:,:]

def Histalp_mask(ds, histalp):
    # Create a 2D mask by taking the mean along the 'time' dimension
    lat_lon_mask = histalp['PREC_HISTALP'].mean(dim='time', skipna=True)
    # Expand the mask to match ds dimensions and mark missing values
    expanded_mask = lat_lon_mask.broadcast_like(ds).isnull()
    # Apply the mask to filter out unwanted values
    filtered_ds = ds.where(~expanded_mask)
    return filtered_ds

histalp['lat'] = histalp['lat'].round(2).astype(float)
histalp['lon'] = histalp['lon'].round(2).astype(float)

```


```python

```


```python

```


```python
selected_variables_backintime= ['camr','surface_pressure', 'total_column_cloud_ice_water', 'total_column_water_vapour']
```


```python
############1960-1983################
merged_datasets = []
for var in selected_variables_backintime:
    datasets = []
    for year in range (1960,1984): 
        ds=xr.open_dataset(f"{path}/ERA5_hourly_backintime/{var}_{year}_daymean_NN.nc")
        ds = ds.isel(bnds=0)
        ds = ds.rename({"valid_time": "time"})
        datasets.append(ds)
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)
    
# Combine all merged variable datasets into a single xarray.Dataset
era5_backintime_1960_1983 = xr.merge(merged_datasets)
```


```python
############1983-2000################
merged_datasets = []
for var in selected_variables_backintime:
    datasets = []
    for year in range (1984,2001): 
        ds=xr.open_dataset(f"{path}/ERA5_NearestN/{var}_daymean_{year}_NearestN.nc") #,chunks={"time": 1}
        ds = ds.isel(bnds=0)
        #ds = ds.rename({"valid_time": "time"})
        datasets.append(ds)
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)
    
# Combine all merged variable datasets into a single xarray.Dataset
era5_backintime_1984_2000 = xr.merge(merged_datasets)
############1960-2000################
era5_backintime = xr.merge([era5_backintime_1960_1983, era5_backintime_1984_2000]) #, compat='override'
    
```


```python
############1960-1983################
merged_datasets = []
for var in ['total_precipitation']:
    datasets = []
    for year in range (1960,1984):
        ds=xr.open_dataset(f"{path}/ERA5_hourly_backintime/{var}_{year}_daysum_consmap.nc")
        ds = ds.isel(bnds=0)
        ds = ds.rename({"valid_time": "time"})
        ds = ds.rename({'tp': 'ppt_era5'})
        ds['ppt_era5']=ds['ppt_era5']*1000   #convert to mm/d
        ds["ppt_era5"].attrs["units"] = "mm"
        datasets.append(ds)
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)
# Combine all merged variable datasets into a single xarray.Dataset
era5_tp_backintime_1960_1983 = xr.merge(merged_datasets)
```


```python
############1984-2000################
merged_datasets = []
for var in ['total_precipitation']:
    datasets = []
    for year in range (1984,2001):
        ds=xr.open_dataset(f"{path}/ERA5_consmap/{var}_daycum_{year}_consmap.nc")
        ds = ds.isel(bnds=0)
        #ds = ds.rename({"valid_time": "time"})
        ds = ds.rename({'tp': 'ppt_era5'})
        ds['ppt_era5']=ds['ppt_era5']*1000   #convert to mm/d
        ds["ppt_era5"].attrs["units"] = "mm"
        datasets.append(ds)
    # Merge all datasets for the current variable
    merged_var_dataset = xr.merge(datasets)
    merged_datasets.append(merged_var_dataset)
# Combine all merged variable datasets into a single xarray.Dataset
era5_tp_backintime_1984_2000 = xr.merge(merged_datasets)
############1960-2000################
era5_tp_backintime = xr.merge([era5_tp_backintime_1960_1983, era5_tp_backintime_1984_2000]) #, compat='override'
```


```python
# Define the Z from ETOPO

ds = xr.open_dataset(f"{path}/ETOPO_2022_v1_30s_N90W180_surface_Imerg_conservative_remapped.nc", engine="netcdf4")
# Select the latitude and longitude ranges
ETOPO_consmap_Z = ds.sel(lat=slice(43, 49), lon=slice(4, 19))




# Repeat the z data along the time dimension to match the length of era5_data_daily time dimension
expanded_z = xr.concat([ETOPO_consmap_Z['z']] * len(era5_tp_backintime.time), dim='time')

# Create a new DataArray 
new_data_array = xr.DataArray(
    expanded_z,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_tp_backintime.coords['time'],
        'lat': era5_tp_backintime.coords['lat'],
        'lon': era5_tp_backintime.coords['lon']
    }
)

# Assign the new DataArray to the dataset
era5_tp_backintime['ETOPO_consmap_z'] = new_data_array
era5_tp_backintime['ETOPO_consmap_z'] = era5_tp_backintime['ETOPO_consmap_z'].where(era5_tp_backintime['ETOPO_consmap_z'] >= 0, 0)
```


```python
era5_backintime = xr.merge([era5_backintime, era5_tp_backintime]) #, compat='override'
#removing 29th of Feb to have a same data for all years
era5_backintime = era5_backintime.sel(time=~((era5_backintime['time'].dt.month == 2) & (era5_backintime['time'].dt.day == 29)))
era5_backintime["camr"].attrs["units"] = "unitless"
era5_backintime = era5_backintime.drop_vars('valid_time_bnds')

# Round to 6 decimal places
era5_backintime['lat'] = era5_backintime['lat'].round(6).astype(float)
era5_backintime['lon'] = era5_backintime['lon'].round(6).astype(float)

era5_backintime

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 3GB
Dimensions:          (time: 14965, lon: 150, lat: 60)
Coordinates:
  * time             (time) datetime64[ns] 120kB 1960-01-01T11:30:00 ... 2000...
  * lon              (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.75 18.85 18.95
  * lat              (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
Data variables:
    camr             (time, lat, lon) float32 539MB 0.001481 ... 0.0004967
    sp               (time, lat, lon) float32 539MB 1.02e+05 ... 9.279e+04
    tciw             (time, lat, lon) float32 539MB 0.0001221 ... 0.0119
    tcwv             (time, lat, lon) float32 539MB 15.4 15.16 ... 5.006 4.699
    time_bnds        (time) datetime64[ns] 120kB NaT NaT ... 2000-12-31
    ppt_era5         (time, lat, lon) float32 539MB 0.1159 0.1323 ... 1.014
    ETOPO_consmap_z  (time, lat, lon) float32 539MB 0.0 0.0 0.0 ... 471.2 672.8
Attributes:
    CDI:                     Climate Data Interface version 2.0.4 (https://mp...
    Conventions:             CF-1.7
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    history:                 Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Ima...
    frequency:               day
    CDO:                     Climate Data Operators version 2.0.4 (https://mp...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-edde59c8-0a0a-45e8-aed9-1bed07dd10a4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-edde59c8-0a0a-45e8-aed9-1bed07dd10a4' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 14965</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-6127cb1b-8a0b-4cae-9e6f-a2199d33b77a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6127cb1b-8a0b-4cae-9e6f-a2199d33b77a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01T11:30:00 ... 2000-12-...</div><input id='attrs-8f5fc757-9b1b-493e-b173-0135f135b496' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8f5fc757-9b1b-493e-b173-0135f135b496' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a93312d0-99ce-43ee-87a8-a5a9bccf51b1' class='xr-var-data-in' type='checkbox'><label for='data-a93312d0-99ce-43ee-87a8-a5a9bccf51b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>valid_time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T11:30:00.000000000&#x27;, &#x27;1960-01-02T11:30:00.000000000&#x27;,
       &#x27;1960-01-03T11:30:00.000000000&#x27;, ..., &#x27;2000-12-29T11:00:00.000000000&#x27;,
       &#x27;2000-12-30T11:00:00.000000000&#x27;, &#x27;2000-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-3ccd28ef-041f-4144-b466-738fc83691d6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3ccd28ef-041f-4144-b466-738fc83691d6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d1a86634-f3df-4a2d-bdfe-d211699ff19a' class='xr-var-data-in' type='checkbox'><label for='data-d1a86634-f3df-4a2d-bdfe-d211699ff19a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-85f63290-eaa1-4e3f-9a80-5f152ef710d4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85f63290-eaa1-4e3f-9a80-5f152ef710d4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac54919b-04ce-418a-a115-21ac7d51805d' class='xr-var-data-in' type='checkbox'><label for='data-ac54919b-04ce-418a-a115-21ac7d51805d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-09c1eda2-4386-46b8-a456-8ff0775e4109' class='xr-section-summary-in' type='checkbox'  checked><label for='section-09c1eda2-4386-46b8-a456-8ff0775e4109' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001481 0.001459 ... 0.0004967</div><input id='attrs-0418ab9e-e758-4da0-b12d-3de52775a9aa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0418ab9e-e758-4da0-b12d-3de52775a9aa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f20cb44c-05f0-4c54-8a7e-8ceb60c2c761' class='xr-var-data-in' type='checkbox'><label for='data-f20cb44c-05f0-4c54-8a7e-8ceb60c2c761' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00148146, 0.00145884, 0.00145884, ..., 0.00083154,
         0.00083154, 0.00076189],
        [0.00145324, 0.00143656, 0.00143656, ..., 0.00086501,
         0.00086501, 0.00079696],
        [0.00145324, 0.00143656, 0.00143656, ..., 0.00086501,
         0.00086501, 0.00079696],
        ...,
        [0.00168732, 0.00168962, 0.00168962, ..., 0.00096552,
         0.00096552, 0.0009518 ],
        [0.00168732, 0.00168962, 0.00168962, ..., 0.00096552,
         0.00096552, 0.0009518 ],
        [0.0016833 , 0.0016894 , 0.0016894 , ..., 0.00095499,
         0.00095499, 0.00093492]],

       [[0.0019556 , 0.00191964, 0.00191964, ..., 0.00092242,
         0.00092242, 0.00087133],
        [0.00189879, 0.00187403, 0.00187403, ..., 0.00092695,
         0.00092695, 0.00087908],
        [0.00189879, 0.00187403, 0.00187403, ..., 0.00092695,
         0.00092695, 0.00087908],
...
        [0.00058987, 0.00060858, 0.00060858, ..., 0.00103518,
         0.00103518, 0.0010371 ],
        [0.00058987, 0.00060858, 0.00060858, ..., 0.00103518,
         0.00103518, 0.0010371 ],
        [0.00058103, 0.00059769, 0.00059769, ..., 0.00101668,
         0.00101668, 0.00100982]],

       [[0.00054325, 0.00053727, 0.00053727, ..., 0.00079068,
         0.00079068, 0.00074822],
        [0.00052184, 0.00051446, 0.00051446, ..., 0.00074314,
         0.00074314, 0.0007067 ],
        [0.00052184, 0.00051446, 0.00051446, ..., 0.00074314,
         0.00074314, 0.0007067 ],
        ...,
        [0.00078496, 0.00077546, 0.00077546, ..., 0.00051305,
         0.00051305, 0.0004898 ],
        [0.00078496, 0.00077546, 0.00077546, ..., 0.00051305,
         0.00051305, 0.0004898 ],
        [0.00078814, 0.00077848, 0.00077848, ..., 0.00052299,
         0.00052299, 0.00049673]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.02e+05 1.019e+05 ... 9.279e+04</div><input id='attrs-f9a57438-e095-4297-8025-6f835e6b861b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f9a57438-e095-4297-8025-6f835e6b861b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d03e54b2-a17f-45db-bb00-f18e8ba0eef7' class='xr-var-data-in' type='checkbox'><label for='data-d03e54b2-a17f-45db-bb00-f18e8ba0eef7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_air_pressure</dd><dt><span>long_name :</span></dt><dd>Surface pressure</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>surface_air_pressure</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Surface pressure</dd><dt><span>GRIB_shortName :</span></dt><dd>sp</dd><dt><span>GRIB_units :</span></dt><dd>Pa</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[101985.77 , 101936.98 , 101936.98 , ...,  87865.81 ,
          87865.81 ,  86256.06 ],
        [101881.15 , 101948.81 , 101948.81 , ...,  87962.48 ,
          87962.48 ,  86461.15 ],
        [101881.15 , 101948.81 , 101948.81 , ...,  87962.48 ,
          87962.48 ,  86461.15 ],
        ...,
        [ 99381.73 ,  99586.65 ,  99586.65 , ...,  94777.44 ,
          94777.44 ,  93997.06 ],
        [ 99381.73 ,  99586.65 ,  99586.65 , ...,  94777.44 ,
          94777.44 ,  93997.06 ],
        [ 99228.52 ,  99425.98 ,  99425.98 , ...,  94426.23 ,
          94426.23 ,  93355.56 ]],

       [[101786.75 , 101745.875, 101745.875, ...,  87655.914,
          87655.914,  86044.875],
        [101656.125, 101734.   , 101734.   , ...,  87726.336,
          87726.336,  86221.5  ],
        [101656.125, 101734.   , 101734.   , ...,  87726.336,
          87726.336,  86221.5  ],
...
        [ 98880.99 ,  99063.125,  99063.125, ...,  92772.53 ,
          92772.53 ,  91967.37 ],
        [ 98880.99 ,  99063.125,  99063.125, ...,  92772.53 ,
          92772.53 ,  91967.37 ],
        [ 98777.55 ,  98950.56 ,  98950.56 , ...,  92466.82 ,
          92466.82 ,  91387.68 ]],

       [[101482.9  , 101407.88 , 101407.88 , ...,  87020.414,
          87020.414,  85466.164],
        [101371.04 , 101414.45 , 101414.45 , ...,  87223.15 ,
          87223.15 ,  85772.25 ],
        [101371.04 , 101414.45 , 101414.45 , ...,  87223.15 ,
          87223.15 ,  85772.25 ],
        ...,
        [ 99808.29 , 100022.18 , 100022.18 , ...,  94245.47 ,
          94245.47 ,  93421.266],
        [ 99808.29 , 100022.18 , 100022.18 , ...,  94245.47 ,
          94245.47 ,  93421.266],
        [ 99698.836,  99908.22 ,  99908.22 , ...,  93898.94 ,
          93898.94 ,  92790.89 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0001221 0.0001284 ... 0.0119</div><input id='attrs-6efd3253-c2d0-4716-9dbf-b0bed5a841a1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6efd3253-c2d0-4716-9dbf-b0bed5a841a1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4376298c-373c-4fcf-815b-6de2da1246e0' class='xr-var-data-in' type='checkbox'><label for='data-4376298c-373c-4fcf-815b-6de2da1246e0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[1.22070312e-04, 1.28428146e-04, 1.28428146e-04, ...,
         4.12114477e-03, 4.12114477e-03, 4.85356664e-03],
        [1.28428146e-04, 1.22070312e-04, 1.22070312e-04, ...,
         4.78871679e-03, 4.78871679e-03, 5.46010351e-03],
        [1.28428146e-04, 1.22070312e-04, 1.22070312e-04, ...,
         4.78871679e-03, 4.78871679e-03, 5.46010351e-03],
        ...,
        [2.24062596e-02, 2.23795567e-02, 2.23795567e-02, ...,
         1.15051270e-02, 1.15051270e-02, 1.05120344e-02],
        [2.24062596e-02, 2.23795567e-02, 2.23795567e-02, ...,
         1.15051270e-02, 1.15051270e-02, 1.05120344e-02],
        [2.05128994e-02, 2.18073521e-02, 2.18073521e-02, ...,
         1.21917725e-02, 1.21917725e-02, 1.07727051e-02]],

       [[3.98381567e-03, 3.90497851e-03, 3.90497851e-03, ...,
         7.82521535e-03, 7.82521535e-03, 1.16869612e-02],
        [4.90061427e-03, 4.65393066e-03, 4.65393066e-03, ...,
         9.41594411e-03, 9.41594411e-03, 1.31123858e-02],
        [4.90061427e-03, 4.65393066e-03, 4.65393066e-03, ...,
         9.41594411e-03, 9.41594411e-03, 1.31123858e-02],
...
        [5.05585084e-03, 8.96991696e-03, 8.96991696e-03, ...,
         1.20453916e-01, 1.20453916e-01, 1.22222543e-01],
        [5.05585084e-03, 8.96991696e-03, 8.96991696e-03, ...,
         1.20453916e-01, 1.20453916e-01, 1.22222543e-01],
        [4.30660928e-03, 5.99917816e-03, 5.99917816e-03, ...,
         1.23376571e-01, 1.23376571e-01, 1.25056028e-01]],

       [[3.05117050e-04, 2.18565227e-04, 2.18565227e-04, ...,
         4.29192148e-02, 4.29192148e-02, 4.02203724e-02],
        [3.40087485e-04, 2.47415825e-04, 2.47415825e-04, ...,
         3.75084132e-02, 3.75084132e-02, 3.68903130e-02],
        [3.40087485e-04, 2.47415825e-04, 2.47415825e-04, ...,
         3.75084132e-02, 3.75084132e-02, 3.68903130e-02],
        ...,
        [1.97172053e-02, 1.81837529e-02, 1.81837529e-02, ...,
         9.07745026e-03, 9.07745026e-03, 8.39815009e-03],
        [1.97172053e-02, 1.81837529e-02, 1.81837529e-02, ...,
         9.07745026e-03, 9.07745026e-03, 8.39815009e-03],
        [1.82160996e-02, 1.70568302e-02, 1.70568302e-02, ...,
         1.04684001e-02, 1.04684001e-02, 1.19048106e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.4 15.16 15.16 ... 5.006 4.699</div><input id='attrs-995102f0-fdd9-44ad-a705-eed9d53af140' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-995102f0-fdd9-44ad-a705-eed9d53af140' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f2923573-1758-41b9-b1ae-5cc1eafe8f52' class='xr-var-data-in' type='checkbox'><label for='data-f2923573-1758-41b9-b1ae-5cc1eafe8f52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tcwv</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>GRIB_shortName :</span></dt><dd>tcwv</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[15.401105 , 15.158673 , 15.158673 , ...,  7.4480615,
          7.4480615,  6.6988754],
        [15.092186 , 14.928856 , 14.928856 , ...,  7.756655 ,
          7.756655 ,  7.0240707],
        [15.092186 , 14.928856 , 14.928856 , ...,  7.756655 ,
          7.756655 ,  7.0240707],
        ...,
        [17.092756 , 17.15135  , 17.15135  , ...,  9.328189 ,
          9.328189 ,  9.119855 ],
        [17.092756 , 17.15135  , 17.15135  , ...,  9.328189 ,
          9.328189 ,  9.119855 ],
        [17.025454 , 17.121239 , 17.121239 , ...,  9.192284 ,
          9.192284 ,  8.896955 ]],

       [[20.290466 , 19.909119 , 19.909119 , ...,  8.2422085,
          8.2422085,  7.6425996],
        [19.676128 , 19.434021 , 19.434021 , ...,  8.28941  ,
          8.28941  ,  7.726421 ],
        [19.676128 , 19.434021 , 19.434021 , ...,  8.28941  ,
          8.28941  ,  7.726421 ],
...
        [ 5.9480915,  6.1473556,  6.1473556, ...,  9.781617 ,
          9.781617 ,  9.714992 ],
        [ 5.9480915,  6.1473556,  6.1473556, ...,  9.781617 ,
          9.781617 ,  9.714992 ],
        [ 5.8538437,  6.0316277,  6.0316277, ...,  9.575833 ,
          9.575833 ,  9.400319 ]],

       [[ 5.62134  ,  5.5553837,  5.5553837, ...,  7.0157537,
          7.0157537,  6.520736 ],
        [ 5.3941035,  5.319998 ,  5.319998 , ...,  6.609512 ,
          6.609512 ,  6.181294 ],
        [ 5.3941035,  5.319998 ,  5.319998 , ...,  6.609512 ,
          6.609512 ,  6.181294 ],
        ...,
        [ 7.97936  ,  7.900772 ,  7.900772 , ...,  4.928979 ,
          4.928979 ,  4.6646028],
        [ 7.97936  ,  7.900772 ,  7.900772 , ...,  4.928979 ,
          4.928979 ,  4.6646028],
        [ 8.0025   ,  7.9222817,  7.9222817, ...,  5.0058494,
          5.0058494,  4.698512 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>NaT NaT ... 2000-12-30 2000-12-31</div><input id='attrs-45e9d5d5-de2b-4317-a2f2-0194078e6b6c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-45e9d5d5-de2b-4317-a2f2-0194078e6b6c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-82a71d6d-c08c-4f15-92e8-f2e6d7529048' class='xr-var-data-in' type='checkbox'><label for='data-82a71d6d-c08c-4f15-92e8-f2e6d7529048' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([                          &#x27;NaT&#x27;,                           &#x27;NaT&#x27;,
                                 &#x27;NaT&#x27;, ...,
       &#x27;2000-12-29T00:00:00.000000000&#x27;, &#x27;2000-12-30T00:00:00.000000000&#x27;,
       &#x27;2000-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1159 0.1323 ... 0.9324 1.014</div><input id='attrs-bc1010da-42a3-4a0f-9f19-85d525373dad' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc1010da-42a3-4a0f-9f19-85d525373dad' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5baa6fcd-bd45-46b9-b661-630051c7aef4' class='xr-var-data-in' type='checkbox'><label for='data-5baa6fcd-bd45-46b9-b661-630051c7aef4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[ 1.15871429e-01,  1.32322356e-01,  1.37805939e-01, ...,
          4.29153442e-03,  5.24523761e-03,  8.10623169e-03],
        [ 1.27670735e-01,  1.25618160e-01,  1.24933973e-01, ...,
          7.50952680e-03,  8.73140432e-03,  1.23968888e-02],
        [ 1.31607056e-01,  1.23381600e-01,  1.20639801e-01, ...,
          8.58306885e-03,  9.89441108e-03,  1.38282776e-02],
        ...,
        [ 3.67236137e+00,  2.97981310e+00,  2.74896622e+00, ...,
          5.72204590e-03,  6.91417465e-03,  1.04904175e-02],
        [ 3.71310043e+00,  3.16756153e+00,  2.98571730e+00, ...,
          7.98532646e-03,  9.38592106e-03,  1.35875372e-02],
        [ 3.83543968e+00,  3.73136973e+00,  3.69668007e+00, ...,
          1.47819519e-02,  1.68085713e-02,  2.28881836e-02]],

       [[ 2.89916992e-01,  3.20315450e-01,  3.30448151e-01, ...,
          2.09808350e-02,  1.90734286e-02,  1.33514404e-02],
        [ 4.09697860e-01,  4.33928430e-01,  4.42005217e-01, ...,
          1.63326226e-02,  1.49615658e-02,  1.08485576e-02],
        [ 4.49657440e-01,  4.71830428e-01,  4.79221344e-01, ...,
          1.47819519e-02,  1.35898227e-02,  1.00135803e-02],
...
          1.61323166e+01,  1.61639957e+01,  1.62590294e+01],
        [ 4.19180878e-02,  8.45626891e-02,  9.87774059e-02, ...,
          1.60885677e+01,  1.61137638e+01,  1.61893520e+01],
        [ 3.09053175e-02,  5.42775206e-02,  6.20681755e-02, ...,
          1.59571877e+01,  1.59629192e+01,  1.59801092e+01]],

       [[-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          3.44851851e-01,  3.67645204e-01,  4.36022520e-01],
        [-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          1.85528874e-01,  2.24061891e-01,  3.39656293e-01],
        [-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          1.32377774e-01,  1.76161632e-01,  3.07507902e-01],
        ...,
        [ 2.06035445e-03,  3.60562443e-03,  4.12070891e-03, ...,
          6.33043945e-01,  6.13791943e-01,  5.56038141e-01],
        [ 4.37651714e-03,  4.08815360e-03,  3.99203319e-03, ...,
          7.01049030e-01,  6.93394303e-01,  6.70430899e-01],
        [ 1.13319494e-02,  5.53718815e-03,  3.60562024e-03, ...,
          9.05268252e-01,  9.32439983e-01,  1.01395202e+00]]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-a1dba71f-ccf4-49d4-9328-40548bb8a12b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a1dba71f-ccf4-49d4-9328-40548bb8a12b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1b31674-dd64-48a3-ba42-6422546b766c' class='xr-var-data-in' type='checkbox'><label for='data-f1b31674-dd64-48a3-ba42-6422546b766c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c6a21482-f6e9-4188-9eae-079dd7777ce2' class='xr-section-summary-in' type='checkbox'  ><label for='section-c6a21482-f6e9-4188-9eae-079dd7777ce2' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ab491f3a-cce2-4bed-aa04-a14894ef06c0' class='xr-index-data-in' type='checkbox'/><label for='index-ab491f3a-cce2-4bed-aa04-a14894ef06c0' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01 11:30:00&#x27;, &#x27;1960-01-02 11:30:00&#x27;,
               &#x27;1960-01-03 11:30:00&#x27;, &#x27;1960-01-04 11:30:00&#x27;,
               &#x27;1960-01-05 11:30:00&#x27;, &#x27;1960-01-06 11:30:00&#x27;,
               &#x27;1960-01-07 11:30:00&#x27;, &#x27;1960-01-08 11:30:00&#x27;,
               &#x27;1960-01-09 11:30:00&#x27;, &#x27;1960-01-10 11:30:00&#x27;,
               ...
               &#x27;2000-12-22 11:00:00&#x27;, &#x27;2000-12-23 11:00:00&#x27;,
               &#x27;2000-12-24 11:00:00&#x27;, &#x27;2000-12-25 11:00:00&#x27;,
               &#x27;2000-12-26 11:00:00&#x27;, &#x27;2000-12-27 11:00:00&#x27;,
               &#x27;2000-12-28 11:00:00&#x27;, &#x27;2000-12-29 11:00:00&#x27;,
               &#x27;2000-12-30 11:00:00&#x27;, &#x27;2000-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=14965, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-ca1146ed-e75f-4053-9210-2e859a6cef10' class='xr-index-data-in' type='checkbox'/><label for='index-ca1146ed-e75f-4053-9210-2e859a6cef10' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([     4.05,      4.15,      4.25,      4.35,      4.45,      4.55,
            4.65,      4.75,      4.85,      4.95,
       ...
       18.050001, 18.150001, 18.250001, 18.350001, 18.450001, 18.550001,
       18.650001, 18.750001, 18.850001, 18.950001],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-2472e5be-f30a-4fa3-a09b-57387a0c8919' class='xr-index-data-in' type='checkbox'/><label for='index-2472e5be-f30a-4fa3-a09b-57387a0c8919' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a75c6311-1fc9-40be-b99a-2e08fd6f4419' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a75c6311-1fc9-40be-b99a-2e08fd6f4419' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean_NN.nc
Tue Jan 28 09:58:16 2025: cdo -b F32 -daymean -expr,camr=tcwv/(sp/9.81) /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc
Tue Jan 28 09:07:49 2025: cdo merge /mnt/c/Iman/Maxm/ERA5_hourly_backintime/total_column_water_vapour_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/surface_pressure_1960.nc /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc
2025-01-27T07:24 GRIB to CDM+CF via cfgrib-0.9.15.0/ecCodes-2.39.0 with {&quot;source&quot;: &quot;tmpyzz0lrjl/data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;stream&quot;: [&quot;oper&quot;], &quot;stepType&quot;: [&quot;instant&quot;]}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



XGB_back in time


```python
#selected_variables= ['tciw','ppt_era5', 'camr']
X_back = np.stack([era5_backintime[var].values for var in selected_variables], axis=-1) 
internal = xgb.predict(X_back.reshape(-1, X_back.shape[-1]))
internal = internal.reshape(-1,Y.shape[1],Y.shape[2])

new_data_array = xr.DataArray(
    internal,
    dims=['time', 'lat', 'lon'],
    coords={
        'time': era5_backintime.coords['time'],
        'lat': era5_backintime.coords['lat'],
        'lon': era5_backintime.coords['lon']
    }
)
era5_backintime['XGB']= new_data_array
era5_backintime
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 4GB
Dimensions:          (time: 14965, lon: 150, lat: 60)
Coordinates:
  * time             (time) datetime64[ns] 120kB 1960-01-01T11:30:00 ... 2000...
  * lon              (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.75 18.85 18.95
  * lat              (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
Data variables:
    camr             (time, lat, lon) float32 539MB 0.001481 ... 0.0004967
    sp               (time, lat, lon) float32 539MB 1.02e+05 ... 9.279e+04
    tciw             (time, lat, lon) float32 539MB 0.0001221 ... 0.0119
    tcwv             (time, lat, lon) float32 539MB 15.4 15.16 ... 5.006 4.699
    time_bnds        (time) datetime64[ns] 120kB NaT NaT ... 2000-12-31
    ppt_era5         (time, lat, lon) float32 539MB 0.1159 0.1323 ... 1.014
    ETOPO_consmap_z  (time, lat, lon) float32 539MB 0.0 0.0 0.0 ... 471.2 672.8
    XGB              (time, lat, lon) float32 539MB 0.07464 0.08674 ... 0.4931
Attributes:
    CDI:                     Climate Data Interface version 2.0.4 (https://mp...
    Conventions:             CF-1.7
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    history:                 Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Ima...
    frequency:               day
    CDO:                     Climate Data Operators version 2.0.4 (https://mp...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-d704702f-1ddf-418a-9a14-487e3e976e2a' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-d704702f-1ddf-418a-9a14-487e3e976e2a' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 14965</li><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-408a6320-2dad-4d1b-be6f-50797cee4b8f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-408a6320-2dad-4d1b-be6f-50797cee4b8f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01T11:30:00 ... 2000-12-...</div><input id='attrs-3152423a-5075-4c5d-8d3a-2da9b6f1f4f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3152423a-5075-4c5d-8d3a-2da9b6f1f4f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-831bcf83-2454-46b3-a9d0-74112291e7e7' class='xr-var-data-in' type='checkbox'><label for='data-831bcf83-2454-46b3-a9d0-74112291e7e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>valid_time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T11:30:00.000000000&#x27;, &#x27;1960-01-02T11:30:00.000000000&#x27;,
       &#x27;1960-01-03T11:30:00.000000000&#x27;, ..., &#x27;2000-12-29T11:00:00.000000000&#x27;,
       &#x27;2000-12-30T11:00:00.000000000&#x27;, &#x27;2000-12-31T11:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-0ad6fccd-a1a2-427c-bcc5-ccdc65971e23' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0ad6fccd-a1a2-427c-bcc5-ccdc65971e23' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-431d24b1-2cef-4fa9-862e-efbca16ea46b' class='xr-var-data-in' type='checkbox'><label for='data-431d24b1-2cef-4fa9-862e-efbca16ea46b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05    ,  4.15    ,  4.25    ,  4.35    ,  4.45    ,  4.55    ,
        4.65    ,  4.75    ,  4.85    ,  4.95    ,  5.05    ,  5.15    ,
        5.25    ,  5.35    ,  5.45    ,  5.55    ,  5.65    ,  5.75    ,
        5.85    ,  5.95    ,  6.05    ,  6.15    ,  6.25    ,  6.35    ,
        6.45    ,  6.55    ,  6.65    ,  6.75    ,  6.85    ,  6.95    ,
        7.05    ,  7.15    ,  7.25    ,  7.35    ,  7.45    ,  7.55    ,
        7.65    ,  7.75    ,  7.85    ,  7.95    ,  8.05    ,  8.15    ,
        8.25    ,  8.35    ,  8.45    ,  8.55    ,  8.65    ,  8.75    ,
        8.85    ,  8.95    ,  9.05    ,  9.15    ,  9.25    ,  9.35    ,
        9.45    ,  9.55    ,  9.65    ,  9.75    ,  9.85    ,  9.95    ,
       10.05    , 10.15    , 10.25    , 10.35    , 10.45    , 10.55    ,
       10.65    , 10.75    , 10.85    , 10.95    , 11.05    , 11.15    ,
       11.25    , 11.35    , 11.45    , 11.55    , 11.65    , 11.75    ,
       11.85    , 11.95    , 12.05    , 12.150001, 12.250001, 12.350001,
       12.450001, 12.550001, 12.650001, 12.750001, 12.850001, 12.950001,
       13.050001, 13.150001, 13.250001, 13.350001, 13.450001, 13.550001,
       13.650001, 13.750001, 13.850001, 13.950001, 14.050001, 14.150001,
       14.250001, 14.350001, 14.450001, 14.550001, 14.650001, 14.750001,
       14.850001, 14.950001, 15.050001, 15.150001, 15.250001, 15.350001,
       15.450001, 15.550001, 15.650001, 15.750001, 15.850001, 15.950001,
       16.050001, 16.150001, 16.250001, 16.350001, 16.450001, 16.550001,
       16.650001, 16.750001, 16.850001, 16.950001, 17.050001, 17.150001,
       17.250001, 17.350001, 17.450001, 17.550001, 17.650001, 17.750001,
       17.850001, 17.950001, 18.050001, 18.150001, 18.250001, 18.350001,
       18.450001, 18.550001, 18.650001, 18.750001, 18.850001, 18.950001])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-0b9862aa-e078-4729-afbf-8568d65f895c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0b9862aa-e078-4729-afbf-8568d65f895c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f70968e-86d6-4b6d-b8e2-b7c947f660a4' class='xr-var-data-in' type='checkbox'><label for='data-2f70968e-86d6-4b6d-b8e2-b7c947f660a4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-18741786-63af-43b2-8212-b2cd59f70899' class='xr-section-summary-in' type='checkbox'  checked><label for='section-18741786-63af-43b2-8212-b2cd59f70899' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001481 0.001459 ... 0.0004967</div><input id='attrs-ab5df24a-aef8-498b-97ba-101068c2d590' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ab5df24a-aef8-498b-97ba-101068c2d590' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a2807b9d-7b6d-4d0f-b45e-0f61f39db95b' class='xr-var-data-in' type='checkbox'><label for='data-a2807b9d-7b6d-4d0f-b45e-0f61f39db95b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00148146, 0.00145884, 0.00145884, ..., 0.00083154,
         0.00083154, 0.00076189],
        [0.00145324, 0.00143656, 0.00143656, ..., 0.00086501,
         0.00086501, 0.00079696],
        [0.00145324, 0.00143656, 0.00143656, ..., 0.00086501,
         0.00086501, 0.00079696],
        ...,
        [0.00168732, 0.00168962, 0.00168962, ..., 0.00096552,
         0.00096552, 0.0009518 ],
        [0.00168732, 0.00168962, 0.00168962, ..., 0.00096552,
         0.00096552, 0.0009518 ],
        [0.0016833 , 0.0016894 , 0.0016894 , ..., 0.00095499,
         0.00095499, 0.00093492]],

       [[0.0019556 , 0.00191964, 0.00191964, ..., 0.00092242,
         0.00092242, 0.00087133],
        [0.00189879, 0.00187403, 0.00187403, ..., 0.00092695,
         0.00092695, 0.00087908],
        [0.00189879, 0.00187403, 0.00187403, ..., 0.00092695,
         0.00092695, 0.00087908],
...
        [0.00058987, 0.00060858, 0.00060858, ..., 0.00103518,
         0.00103518, 0.0010371 ],
        [0.00058987, 0.00060858, 0.00060858, ..., 0.00103518,
         0.00103518, 0.0010371 ],
        [0.00058103, 0.00059769, 0.00059769, ..., 0.00101668,
         0.00101668, 0.00100982]],

       [[0.00054325, 0.00053727, 0.00053727, ..., 0.00079068,
         0.00079068, 0.00074822],
        [0.00052184, 0.00051446, 0.00051446, ..., 0.00074314,
         0.00074314, 0.0007067 ],
        [0.00052184, 0.00051446, 0.00051446, ..., 0.00074314,
         0.00074314, 0.0007067 ],
        ...,
        [0.00078496, 0.00077546, 0.00077546, ..., 0.00051305,
         0.00051305, 0.0004898 ],
        [0.00078496, 0.00077546, 0.00077546, ..., 0.00051305,
         0.00051305, 0.0004898 ],
        [0.00078814, 0.00077848, 0.00077848, ..., 0.00052299,
         0.00052299, 0.00049673]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.02e+05 1.019e+05 ... 9.279e+04</div><input id='attrs-f63c7751-1158-4236-8158-9dc3b1384fb5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f63c7751-1158-4236-8158-9dc3b1384fb5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12c38801-7a6e-45da-bf52-052da5890700' class='xr-var-data-in' type='checkbox'><label for='data-12c38801-7a6e-45da-bf52-052da5890700' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_air_pressure</dd><dt><span>long_name :</span></dt><dd>Surface pressure</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>surface_air_pressure</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Surface pressure</dd><dt><span>GRIB_shortName :</span></dt><dd>sp</dd><dt><span>GRIB_units :</span></dt><dd>Pa</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[101985.77 , 101936.98 , 101936.98 , ...,  87865.81 ,
          87865.81 ,  86256.06 ],
        [101881.15 , 101948.81 , 101948.81 , ...,  87962.48 ,
          87962.48 ,  86461.15 ],
        [101881.15 , 101948.81 , 101948.81 , ...,  87962.48 ,
          87962.48 ,  86461.15 ],
        ...,
        [ 99381.73 ,  99586.65 ,  99586.65 , ...,  94777.44 ,
          94777.44 ,  93997.06 ],
        [ 99381.73 ,  99586.65 ,  99586.65 , ...,  94777.44 ,
          94777.44 ,  93997.06 ],
        [ 99228.52 ,  99425.98 ,  99425.98 , ...,  94426.23 ,
          94426.23 ,  93355.56 ]],

       [[101786.75 , 101745.875, 101745.875, ...,  87655.914,
          87655.914,  86044.875],
        [101656.125, 101734.   , 101734.   , ...,  87726.336,
          87726.336,  86221.5  ],
        [101656.125, 101734.   , 101734.   , ...,  87726.336,
          87726.336,  86221.5  ],
...
        [ 98880.99 ,  99063.125,  99063.125, ...,  92772.53 ,
          92772.53 ,  91967.37 ],
        [ 98880.99 ,  99063.125,  99063.125, ...,  92772.53 ,
          92772.53 ,  91967.37 ],
        [ 98777.55 ,  98950.56 ,  98950.56 , ...,  92466.82 ,
          92466.82 ,  91387.68 ]],

       [[101482.9  , 101407.88 , 101407.88 , ...,  87020.414,
          87020.414,  85466.164],
        [101371.04 , 101414.45 , 101414.45 , ...,  87223.15 ,
          87223.15 ,  85772.25 ],
        [101371.04 , 101414.45 , 101414.45 , ...,  87223.15 ,
          87223.15 ,  85772.25 ],
        ...,
        [ 99808.29 , 100022.18 , 100022.18 , ...,  94245.47 ,
          94245.47 ,  93421.266],
        [ 99808.29 , 100022.18 , 100022.18 , ...,  94245.47 ,
          94245.47 ,  93421.266],
        [ 99698.836,  99908.22 ,  99908.22 , ...,  93898.94 ,
          93898.94 ,  92790.89 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0001221 0.0001284 ... 0.0119</div><input id='attrs-43376703-b1e0-4202-85ee-248b58587eb6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-43376703-b1e0-4202-85ee-248b58587eb6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d476dd14-75bf-4391-809f-29a006b11acb' class='xr-var-data-in' type='checkbox'><label for='data-d476dd14-75bf-4391-809f-29a006b11acb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[1.22070312e-04, 1.28428146e-04, 1.28428146e-04, ...,
         4.12114477e-03, 4.12114477e-03, 4.85356664e-03],
        [1.28428146e-04, 1.22070312e-04, 1.22070312e-04, ...,
         4.78871679e-03, 4.78871679e-03, 5.46010351e-03],
        [1.28428146e-04, 1.22070312e-04, 1.22070312e-04, ...,
         4.78871679e-03, 4.78871679e-03, 5.46010351e-03],
        ...,
        [2.24062596e-02, 2.23795567e-02, 2.23795567e-02, ...,
         1.15051270e-02, 1.15051270e-02, 1.05120344e-02],
        [2.24062596e-02, 2.23795567e-02, 2.23795567e-02, ...,
         1.15051270e-02, 1.15051270e-02, 1.05120344e-02],
        [2.05128994e-02, 2.18073521e-02, 2.18073521e-02, ...,
         1.21917725e-02, 1.21917725e-02, 1.07727051e-02]],

       [[3.98381567e-03, 3.90497851e-03, 3.90497851e-03, ...,
         7.82521535e-03, 7.82521535e-03, 1.16869612e-02],
        [4.90061427e-03, 4.65393066e-03, 4.65393066e-03, ...,
         9.41594411e-03, 9.41594411e-03, 1.31123858e-02],
        [4.90061427e-03, 4.65393066e-03, 4.65393066e-03, ...,
         9.41594411e-03, 9.41594411e-03, 1.31123858e-02],
...
        [5.05585084e-03, 8.96991696e-03, 8.96991696e-03, ...,
         1.20453916e-01, 1.20453916e-01, 1.22222543e-01],
        [5.05585084e-03, 8.96991696e-03, 8.96991696e-03, ...,
         1.20453916e-01, 1.20453916e-01, 1.22222543e-01],
        [4.30660928e-03, 5.99917816e-03, 5.99917816e-03, ...,
         1.23376571e-01, 1.23376571e-01, 1.25056028e-01]],

       [[3.05117050e-04, 2.18565227e-04, 2.18565227e-04, ...,
         4.29192148e-02, 4.29192148e-02, 4.02203724e-02],
        [3.40087485e-04, 2.47415825e-04, 2.47415825e-04, ...,
         3.75084132e-02, 3.75084132e-02, 3.68903130e-02],
        [3.40087485e-04, 2.47415825e-04, 2.47415825e-04, ...,
         3.75084132e-02, 3.75084132e-02, 3.68903130e-02],
        ...,
        [1.97172053e-02, 1.81837529e-02, 1.81837529e-02, ...,
         9.07745026e-03, 9.07745026e-03, 8.39815009e-03],
        [1.97172053e-02, 1.81837529e-02, 1.81837529e-02, ...,
         9.07745026e-03, 9.07745026e-03, 8.39815009e-03],
        [1.82160996e-02, 1.70568302e-02, 1.70568302e-02, ...,
         1.04684001e-02, 1.04684001e-02, 1.19048106e-02]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>15.4 15.16 15.16 ... 5.006 4.699</div><input id='attrs-7fdf2be8-1f5e-47a9-a52c-f5420e332565' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7fdf2be8-1f5e-47a9-a52c-f5420e332565' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40398dd2-2e2d-465b-a81c-0f3e4ff4ea59' class='xr-var-data-in' type='checkbox'><label for='data-40398dd2-2e2d-465b-a81c-0f3e4ff4ea59' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tcwv</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>GRIB_shortName :</span></dt><dd>tcwv</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[15.401105 , 15.158673 , 15.158673 , ...,  7.4480615,
          7.4480615,  6.6988754],
        [15.092186 , 14.928856 , 14.928856 , ...,  7.756655 ,
          7.756655 ,  7.0240707],
        [15.092186 , 14.928856 , 14.928856 , ...,  7.756655 ,
          7.756655 ,  7.0240707],
        ...,
        [17.092756 , 17.15135  , 17.15135  , ...,  9.328189 ,
          9.328189 ,  9.119855 ],
        [17.092756 , 17.15135  , 17.15135  , ...,  9.328189 ,
          9.328189 ,  9.119855 ],
        [17.025454 , 17.121239 , 17.121239 , ...,  9.192284 ,
          9.192284 ,  8.896955 ]],

       [[20.290466 , 19.909119 , 19.909119 , ...,  8.2422085,
          8.2422085,  7.6425996],
        [19.676128 , 19.434021 , 19.434021 , ...,  8.28941  ,
          8.28941  ,  7.726421 ],
        [19.676128 , 19.434021 , 19.434021 , ...,  8.28941  ,
          8.28941  ,  7.726421 ],
...
        [ 5.9480915,  6.1473556,  6.1473556, ...,  9.781617 ,
          9.781617 ,  9.714992 ],
        [ 5.9480915,  6.1473556,  6.1473556, ...,  9.781617 ,
          9.781617 ,  9.714992 ],
        [ 5.8538437,  6.0316277,  6.0316277, ...,  9.575833 ,
          9.575833 ,  9.400319 ]],

       [[ 5.62134  ,  5.5553837,  5.5553837, ...,  7.0157537,
          7.0157537,  6.520736 ],
        [ 5.3941035,  5.319998 ,  5.319998 , ...,  6.609512 ,
          6.609512 ,  6.181294 ],
        [ 5.3941035,  5.319998 ,  5.319998 , ...,  6.609512 ,
          6.609512 ,  6.181294 ],
        ...,
        [ 7.97936  ,  7.900772 ,  7.900772 , ...,  4.928979 ,
          4.928979 ,  4.6646028],
        [ 7.97936  ,  7.900772 ,  7.900772 , ...,  4.928979 ,
          4.928979 ,  4.6646028],
        [ 8.0025   ,  7.9222817,  7.9222817, ...,  5.0058494,
          5.0058494,  4.698512 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_bnds</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>NaT NaT ... 2000-12-30 2000-12-31</div><input id='attrs-3b83c582-abfa-43a1-be7b-c6500172cf5c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3b83c582-abfa-43a1-be7b-c6500172cf5c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-55bd45c4-de1f-4872-9e3e-ff3310218f80' class='xr-var-data-in' type='checkbox'><label for='data-55bd45c4-de1f-4872-9e3e-ff3310218f80' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([                          &#x27;NaT&#x27;,                           &#x27;NaT&#x27;,
                                 &#x27;NaT&#x27;, ...,
       &#x27;2000-12-29T00:00:00.000000000&#x27;, &#x27;2000-12-30T00:00:00.000000000&#x27;,
       &#x27;2000-12-31T00:00:00.000000000&#x27;], dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.1159 0.1323 ... 0.9324 1.014</div><input id='attrs-e8c12d6f-7d83-4358-8dd6-1cf61d23e809' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e8c12d6f-7d83-4358-8dd6-1cf61d23e809' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8c9d0ce9-16f0-411c-9457-61be85c80454' class='xr-var-data-in' type='checkbox'><label for='data-8c9d0ce9-16f0-411c-9457-61be85c80454' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[ 1.15871429e-01,  1.32322356e-01,  1.37805939e-01, ...,
          4.29153442e-03,  5.24523761e-03,  8.10623169e-03],
        [ 1.27670735e-01,  1.25618160e-01,  1.24933973e-01, ...,
          7.50952680e-03,  8.73140432e-03,  1.23968888e-02],
        [ 1.31607056e-01,  1.23381600e-01,  1.20639801e-01, ...,
          8.58306885e-03,  9.89441108e-03,  1.38282776e-02],
        ...,
        [ 3.67236137e+00,  2.97981310e+00,  2.74896622e+00, ...,
          5.72204590e-03,  6.91417465e-03,  1.04904175e-02],
        [ 3.71310043e+00,  3.16756153e+00,  2.98571730e+00, ...,
          7.98532646e-03,  9.38592106e-03,  1.35875372e-02],
        [ 3.83543968e+00,  3.73136973e+00,  3.69668007e+00, ...,
          1.47819519e-02,  1.68085713e-02,  2.28881836e-02]],

       [[ 2.89916992e-01,  3.20315450e-01,  3.30448151e-01, ...,
          2.09808350e-02,  1.90734286e-02,  1.33514404e-02],
        [ 4.09697860e-01,  4.33928430e-01,  4.42005217e-01, ...,
          1.63326226e-02,  1.49615658e-02,  1.08485576e-02],
        [ 4.49657440e-01,  4.71830428e-01,  4.79221344e-01, ...,
          1.47819519e-02,  1.35898227e-02,  1.00135803e-02],
...
          1.61323166e+01,  1.61639957e+01,  1.62590294e+01],
        [ 4.19180878e-02,  8.45626891e-02,  9.87774059e-02, ...,
          1.60885677e+01,  1.61137638e+01,  1.61893520e+01],
        [ 3.09053175e-02,  5.42775206e-02,  6.20681755e-02, ...,
          1.59571877e+01,  1.59629192e+01,  1.59801092e+01]],

       [[-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          3.44851851e-01,  3.67645204e-01,  4.36022520e-01],
        [-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          1.85528874e-01,  2.24061891e-01,  3.39656293e-01],
        [-3.30469904e-14, -3.30469904e-14, -3.30469904e-14, ...,
          1.32377774e-01,  1.76161632e-01,  3.07507902e-01],
        ...,
        [ 2.06035445e-03,  3.60562443e-03,  4.12070891e-03, ...,
          6.33043945e-01,  6.13791943e-01,  5.56038141e-01],
        [ 4.37651714e-03,  4.08815360e-03,  3.99203319e-03, ...,
          7.01049030e-01,  6.93394303e-01,  6.70430899e-01],
        [ 1.13319494e-02,  5.53718815e-03,  3.60562024e-03, ...,
          9.05268252e-01,  9.32439983e-01,  1.01395202e+00]]],
      dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 675.7 471.2 672.8</div><input id='attrs-2a73d5a7-7a2f-45bc-90ea-023531acc650' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a73d5a7-7a2f-45bc-90ea-023531acc650' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36b2cacd-b35a-40e3-9a8c-c865199ce8c6' class='xr-var-data-in' type='checkbox'><label for='data-36b2cacd-b35a-40e3-9a8c-c865199ce8c6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
...
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]],

       [[   0.      ,    0.      ,    0.      , ..., 1429.432   ,
         1157.492   , 1434.3738  ],
        [   0.      ,    0.      ,    0.      , ..., 1377.1447  ,
         1056.0112  , 1618.0994  ],
        [   0.      ,    0.      ,    0.      , ..., 1781.3185  ,
         1257.3567  , 1310.5697  ],
        ...,
        [ 150.28276 ,  166.67923 ,  173.16833 , ...,  545.91797 ,
          735.03455 ,  916.79803 ],
        [ 132.20848 ,  125.575584,  132.34067 , ...,  587.58514 ,
          534.9267  ,  867.8491  ],
        [ 113.36413 ,   95.91243 ,  101.60886 , ...,  675.6738  ,
          471.16226 ,  672.83344 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XGB</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.07464 0.08674 ... 0.5426 0.4931</div><input id='attrs-451e7ac1-8fac-4dd3-9525-d97093b43ab5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-451e7ac1-8fac-4dd3-9525-d97093b43ab5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-659e9c28-d7ae-40e9-9a7f-7b0883c30755' class='xr-var-data-in' type='checkbox'><label for='data-659e9c28-d7ae-40e9-9a7f-7b0883c30755' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[0.07463783, 0.08674458, 0.08674458, ..., 0.3307095 ,
         0.3307095 , 0.35009387],
        [0.08674458, 0.07463783, 0.07463783, ..., 0.3307095 ,
         0.3307095 , 0.31997338],
        [0.08674458, 0.07463783, 0.07463783, ..., 0.3307095 ,
         0.3307095 , 0.31997338],
        ...,
        [2.113116  , 2.0108895 , 2.0108895 , ..., 0.4499043 ,
         0.4499043 , 0.44122648],
        [2.113116  , 2.0108895 , 2.0108895 , ..., 0.4499043 ,
         0.4499043 , 0.44122648],
        [2.2142699 , 2.113116  , 2.113116  , ..., 0.454119  ,
         0.454119  , 0.44122648]],

       [[0.2822244 , 0.2822244 , 0.2822244 , ..., 0.38519168,
         0.38519168, 0.45606714],
        [0.3679208 , 0.30858293, 0.30858293, ..., 0.38478777,
         0.38478777, 0.4734847 ],
        [0.3679208 , 0.30599895, 0.30599895, ..., 0.38478777,
         0.38478777, 0.4734847 ],
...
        [0.3851464 , 0.4339058 , 0.4339058 , ..., 9.259439  ,
         9.259439  , 9.259439  ],
        [0.3851464 , 0.4339058 , 0.4339058 , ..., 9.259439  ,
         9.259439  , 9.259439  ],
        [0.35870925, 0.38760552, 0.38760552, ..., 9.382472  ,
         9.382472  , 9.382472  ]],

       [[0.1562943 , 0.1527693 , 0.1527693 , ..., 1.01582   ,
         1.01582   , 0.9344095 ],
        [0.16590938, 0.1527693 , 0.1527693 , ..., 0.90737146,
         0.90737146, 0.835334  ],
        [0.16590938, 0.1527693 , 0.1527693 , ..., 0.90737146,
         0.90737146, 0.835334  ],
        ...,
        [0.63214594, 0.574399  , 0.574399  , ..., 0.44110972,
         0.44110972, 0.44702712],
        [0.63214594, 0.574399  , 0.574399  , ..., 0.46645418,
         0.46645418, 0.44702712],
        [0.574399  , 0.53316087, 0.53316087, ..., 0.5426445 ,
         0.5426445 , 0.49311152]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-43cfbb43-7a8c-47bb-af55-422e4d0b198f' class='xr-section-summary-in' type='checkbox'  ><label for='section-43cfbb43-7a8c-47bb-af55-422e4d0b198f' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f7284fbb-9ca6-4a1c-bed5-73cae85f9740' class='xr-index-data-in' type='checkbox'/><label for='index-f7284fbb-9ca6-4a1c-bed5-73cae85f9740' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01 11:30:00&#x27;, &#x27;1960-01-02 11:30:00&#x27;,
               &#x27;1960-01-03 11:30:00&#x27;, &#x27;1960-01-04 11:30:00&#x27;,
               &#x27;1960-01-05 11:30:00&#x27;, &#x27;1960-01-06 11:30:00&#x27;,
               &#x27;1960-01-07 11:30:00&#x27;, &#x27;1960-01-08 11:30:00&#x27;,
               &#x27;1960-01-09 11:30:00&#x27;, &#x27;1960-01-10 11:30:00&#x27;,
               ...
               &#x27;2000-12-22 11:00:00&#x27;, &#x27;2000-12-23 11:00:00&#x27;,
               &#x27;2000-12-24 11:00:00&#x27;, &#x27;2000-12-25 11:00:00&#x27;,
               &#x27;2000-12-26 11:00:00&#x27;, &#x27;2000-12-27 11:00:00&#x27;,
               &#x27;2000-12-28 11:00:00&#x27;, &#x27;2000-12-29 11:00:00&#x27;,
               &#x27;2000-12-30 11:00:00&#x27;, &#x27;2000-12-31 11:00:00&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=14965, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-56ac019c-8056-464d-8580-f175bb889ca6' class='xr-index-data-in' type='checkbox'/><label for='index-56ac019c-8056-464d-8580-f175bb889ca6' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([     4.05,      4.15,      4.25,      4.35,      4.45,      4.55,
            4.65,      4.75,      4.85,      4.95,
       ...
       18.050001, 18.150001, 18.250001, 18.350001, 18.450001, 18.550001,
       18.650001, 18.750001, 18.850001, 18.950001],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4b7e4b50-5066-4cca-a258-9c8ba3ea8a8c' class='xr-index-data-in' type='checkbox'/><label for='index-4b7e4b50-5066-4cca-a258-9c8ba3ea8a8c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7a0378df-9600-4506-a075-8a223d3ada9c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7a0378df-9600-4506-a075-8a223d3ada9c' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean_NN.nc
Tue Jan 28 09:58:16 2025: cdo -b F32 -daymean -expr,camr=tcwv/(sp/9.81) /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc
Tue Jan 28 09:07:49 2025: cdo merge /mnt/c/Iman/Maxm/ERA5_hourly_backintime/total_column_water_vapour_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/surface_pressure_1960.nc /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc
2025-01-27T07:24 GRIB to CDM+CF via cfgrib-0.9.15.0/ecCodes-2.39.0 with {&quot;source&quot;: &quot;tmpyzz0lrjl/data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;stream&quot;: [&quot;oper&quot;], &quot;stepType&quot;: [&quot;instant&quot;]}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>



Stationary HISTALP DATA


```python
loc_list = [
    "AT_BMU", "AT_FRE", "AT_KOL", "AT_LAD", "AT_SPO", "AT_WIE",
    "BA_JAJ", "DE_KMF", "DE_LHU", "DE_ULM", "HR_POZ", "HR_ZAD", "HU_PAP",
    "IT_BAR", "IT_FOR", "IT_IMP", "IT_MIL", "IT_UDI", "IT_VAL", "SI_LJU", 
    "AT_ADM", "SI_CEL", "IT_ROV", "IT_BRX", "DE_OBS","IT_TOM",
    "IT_BOZ", "HU_SZO", "HR_KVA", "DE_STU", "DE_ROS","IT_PAR",
    "BA_BIH", "AT_WAI", "AT_TAM", "AT_SSB", "AT_KAL","IT_VEN",
    "AT_SAL", "AT_RAU", "AT_OFK", "AT_LAG", "AT_KRE", "AT_KOR", 
    "AT_BST", "AT_BRE", "AT_FLA", "AT_INN", "AT_VIL", "AT_RET",    
    ]
```


```python
all_dfs = []

for loc in loc_list: 
    # Define the data directory
    data_dir = f"{path}/HISTALP_stations/HISTALP_{loc}_R01_1760_2025.csv"

    # Read raw data to extract metadata
    with open(data_dir, "r") as f:
        raw_lines = f.readlines()

    # Extract metadata from comment lines
    metadata = {}
    data_start_idx = 0  # Default index to locate actual data start

    for i, line in enumerate(raw_lines):
        if line.startswith("#"):
            key_value = line.replace("#", "").strip().split(": ", 1)  # Ensure only 1 split
            if len(key_value) == 2:
                metadata[key_value[0].strip()] = key_value[1].strip()
        else:
            data_start_idx = i  # Identify where actual data starts
            break

    # Read CSV with proper delimiter (;)
    df = pd.read_csv(data_dir, delimiter=";", skiprows=data_start_idx)

    # Rename the first column as 'Year'
    df.rename(columns={df.columns[0]: "Year"}, inplace=True)

    # Convert 'Year' to integer and replace missing values
    df["Year"] = df["Year"].astype(int)
    df.replace(999999, float("nan"), inplace=True)

    # Add longitude from metadata (handle missing key safely)
    df["longitude"] = float(metadata.get("longitude", "nan"))  # Default to NaN if missing
    df["latitude"] = float(metadata.get("latitude", "nan"))
    df["height"] = float(metadata.get("height", "nan"))
    df["station"] = str(metadata.get("station", "nan"))

    columns_to_remove = ["mar-may", "jun-aug", "sep-nov", "dec-feb", "apr-sep", "oct-mar", "jan-dec"]
    df.drop(columns=columns_to_remove, inplace=True, errors='ignore')  # 'errors="ignore"' prevents errors if columns don't exist

    # Filter rows where 'Year' is between 1960 and 2014
    df = df[(df["Year"] >= 1960) & (df["Year"] <= 2020)] 
    
    all_dfs.append(df)

# Concatenate all DataFrames into one
Histalp_stations_df = pd.concat(all_dfs, ignore_index=True)
#print(Histalp_stations_df.isnull().sum())
Histalp_stations_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>jan</th>
      <th>feb</th>
      <th>mar</th>
      <th>apr</th>
      <th>may</th>
      <th>jun</th>
      <th>jul</th>
      <th>aug</th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height</th>
      <th>station</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>18.0</td>
      <td>17.0</td>
      <td>43.0</td>
      <td>16.0</td>
      <td>48.0</td>
      <td>95.0</td>
      <td>145.0</td>
      <td>135.0</td>
      <td>118.0</td>
      <td>83.0</td>
      <td>46.0</td>
      <td>86.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>12.0</td>
      <td>48.0</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>83.0</td>
      <td>51.0</td>
      <td>94.0</td>
      <td>91.0</td>
      <td>13.0</td>
      <td>146.0</td>
      <td>85.0</td>
      <td>53.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>33.0</td>
      <td>49.0</td>
      <td>29.0</td>
      <td>16.0</td>
      <td>106.0</td>
      <td>116.0</td>
      <td>92.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>73.0</td>
      <td>82.0</td>
      <td>37.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>29.0</td>
      <td>28.0</td>
      <td>62.0</td>
      <td>50.0</td>
      <td>98.0</td>
      <td>134.0</td>
      <td>93.0</td>
      <td>162.0</td>
      <td>37.0</td>
      <td>11.0</td>
      <td>76.0</td>
      <td>30.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>60.0</td>
      <td>42.0</td>
      <td>65.0</td>
      <td>96.0</td>
      <td>56.0</td>
      <td>79.0</td>
      <td>50.0</td>
      <td>176.0</td>
      <td>51.0</td>
      <td>54.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>2016</td>
      <td>18.0</td>
      <td>51.0</td>
      <td>10.0</td>
      <td>41.0</td>
      <td>59.0</td>
      <td>94.0</td>
      <td>110.0</td>
      <td>53.0</td>
      <td>8.0</td>
      <td>52.0</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>2017</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>53.0</td>
      <td>40.0</td>
      <td>69.0</td>
      <td>34.0</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
    </tr>
    <tr>
      <th>3047</th>
      <td>2018</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>9.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>28.0</td>
      <td>40.0</td>
      <td>78.0</td>
      <td>11.0</td>
      <td>23.0</td>
      <td>32.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
    </tr>
    <tr>
      <th>3048</th>
      <td>2019</td>
      <td>14.0</td>
      <td>8.0</td>
      <td>20.0</td>
      <td>18.0</td>
      <td>127.0</td>
      <td>29.0</td>
      <td>99.0</td>
      <td>104.0</td>
      <td>52.0</td>
      <td>37.0</td>
      <td>25.0</td>
      <td>39.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
    </tr>
    <tr>
      <th>3049</th>
      <td>2020</td>
      <td>13.0</td>
      <td>23.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>54.0</td>
      <td>96.0</td>
      <td>67.0</td>
      <td>86.0</td>
      <td>84.0</td>
      <td>70.0</td>
      <td>12.0</td>
      <td>27.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
    </tr>
  </tbody>
</table>
<p>3050 rows × 17 columns</p>
</div>



for Mean of 20 stations


```python
from geopy.distance import geodesic
################################################################################
def calculate_distance(lat1, lon1, lat2, lon2):
    return geodesic((lat1, lon1), (lat2, lon2)).km
################################################################################
def find_closest_point(Imerg, station_latitude, station_longitude):
    closest_lat, closest_lon = None, None
    min_distance = float("inf")  # Start with a very large distance

    for lat in Imerg['lat']:  # Loop through all latitudes
        for lon in Imerg['lon']:  # Loop through all longitudes
            distance = calculate_distance(lat, lon, station_latitude, station_longitude)

            if distance < min_distance:
                min_distance = distance
                closest_lat, closest_lon = lat, lon

    return float(closest_lat), float(closest_lon)  # Return the closest point found
```


```python
#closest Grid point of era5_Imerg based on stations' positions
df_lon_lat= Histalp_stations_df[['latitude', 'longitude']].drop_duplicates()

# Loop through each row 
closest_latitudes = []
closest_longitudes = []

for index, row in tqdm(df_lon_lat.iterrows()):
    closest_lat, closest_lon = find_closest_point(era5_Imerg, row['latitude'], row['longitude'])
    closest_latitudes.append(closest_lat)
    closest_longitudes.append(closest_lon)

# Add the new columns to the DataFrame
df_lon_lat['closest_Imerg_lat'] = closest_latitudes
df_lon_lat['closest_Imerg_lon'] = closest_longitudes
#####################################################################################################
# Merge Histalp_stations_df with df_lon_lat on latitude and longitude
Histalp_stations_df = Histalp_stations_df.merge(
    df_lon_lat[['latitude', 'longitude', 'closest_Imerg_lat', 'closest_Imerg_lon']],
    on=['latitude', 'longitude'], 
    how='left'  # Use 'left' to keep all Histalp_stations_df rows
)
#####################################################################################################
#round the long and lat to be sure
Histalp_stations_df['closest_Imerg_lat'] = Histalp_stations_df['closest_Imerg_lat'].round(6)
Histalp_stations_df['closest_Imerg_lon'] = Histalp_stations_df['closest_Imerg_lon'].round(6)

#Histalp_stations_df['closest_Imerg_lat'] = Histalp_stations_df['closest_Imerg_lat'].apply(lambda x: float(format(x, '.6f')))
#Histalp_stations_df['closest_Imerg_lon'] = Histalp_stations_df['closest_Imerg_lon'].apply(lambda x: float(format(x, '.6f')))

Histalp_stations_df
```

    50it [02:29,  2.99s/it]





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>jan</th>
      <th>feb</th>
      <th>mar</th>
      <th>apr</th>
      <th>may</th>
      <th>jun</th>
      <th>jul</th>
      <th>aug</th>
      <th>sep</th>
      <th>oct</th>
      <th>nov</th>
      <th>dec</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height</th>
      <th>station</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>18.0</td>
      <td>17.0</td>
      <td>43.0</td>
      <td>16.0</td>
      <td>48.0</td>
      <td>95.0</td>
      <td>145.0</td>
      <td>135.0</td>
      <td>118.0</td>
      <td>83.0</td>
      <td>46.0</td>
      <td>86.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>12.0</td>
      <td>48.0</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>83.0</td>
      <td>51.0</td>
      <td>94.0</td>
      <td>91.0</td>
      <td>13.0</td>
      <td>146.0</td>
      <td>85.0</td>
      <td>53.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>33.0</td>
      <td>49.0</td>
      <td>29.0</td>
      <td>16.0</td>
      <td>106.0</td>
      <td>116.0</td>
      <td>92.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>73.0</td>
      <td>82.0</td>
      <td>37.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>29.0</td>
      <td>28.0</td>
      <td>62.0</td>
      <td>50.0</td>
      <td>98.0</td>
      <td>134.0</td>
      <td>93.0</td>
      <td>162.0</td>
      <td>37.0</td>
      <td>11.0</td>
      <td>76.0</td>
      <td>30.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>60.0</td>
      <td>42.0</td>
      <td>65.0</td>
      <td>96.0</td>
      <td>56.0</td>
      <td>79.0</td>
      <td>50.0</td>
      <td>176.0</td>
      <td>51.0</td>
      <td>54.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>2016</td>
      <td>18.0</td>
      <td>51.0</td>
      <td>10.0</td>
      <td>41.0</td>
      <td>59.0</td>
      <td>94.0</td>
      <td>110.0</td>
      <td>53.0</td>
      <td>8.0</td>
      <td>52.0</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>2017</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>53.0</td>
      <td>40.0</td>
      <td>69.0</td>
      <td>34.0</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
    </tr>
    <tr>
      <th>3047</th>
      <td>2018</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>9.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>28.0</td>
      <td>40.0</td>
      <td>78.0</td>
      <td>11.0</td>
      <td>23.0</td>
      <td>32.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
    </tr>
    <tr>
      <th>3048</th>
      <td>2019</td>
      <td>14.0</td>
      <td>8.0</td>
      <td>20.0</td>
      <td>18.0</td>
      <td>127.0</td>
      <td>29.0</td>
      <td>99.0</td>
      <td>104.0</td>
      <td>52.0</td>
      <td>37.0</td>
      <td>25.0</td>
      <td>39.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
    </tr>
    <tr>
      <th>3049</th>
      <td>2020</td>
      <td>13.0</td>
      <td>23.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>54.0</td>
      <td>96.0</td>
      <td>67.0</td>
      <td>86.0</td>
      <td>84.0</td>
      <td>70.0</td>
      <td>12.0</td>
      <td>27.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
    </tr>
  </tbody>
</table>
<p>3050 rows × 19 columns</p>
</div>




```python
Histalp_stations_df_overallstations=Histalp_stations_df.drop(columns= ['longitude', 'latitude', 'station','closest_Imerg_lat','closest_Imerg_lon','height']).groupby('Year').mean()
Histalp_stations_df_overallstations = Histalp_stations_df_overallstations.reset_index()
# Convert wide format (monthly columns) to long format
Histalp_df_long = Histalp_stations_df_overallstations.melt(id_vars=["Year"],var_name="Month", value_name="Value")
# Map month names to numeric values for proper datetime conversion
month_map = {'jan': 1, 'feb': 2, 'mar': 3, 'apr': 4, 'may': 5, 'jun': 6,
             'jul': 7, 'aug': 8, 'sep': 9, 'oct': 10, 'nov': 11, 'dec': 12}

Histalp_df_long["Month"] = Histalp_df_long["Month"].map(month_map)

# Create a datetime column
Histalp_df_long["Date"] = pd.to_datetime(Histalp_df_long[["Year", "Month"]].assign(day=1))

# Sort the DataFrame for proper plotting
Histalp_df_long = Histalp_df_long.sort_values(["Date"])
Histalp_df_long
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Month</th>
      <th>Value</th>
      <th>Date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>1</td>
      <td>55.700000</td>
      <td>1960-01-01</td>
    </tr>
    <tr>
      <th>61</th>
      <td>1960</td>
      <td>2</td>
      <td>67.820000</td>
      <td>1960-02-01</td>
    </tr>
    <tr>
      <th>122</th>
      <td>1960</td>
      <td>3</td>
      <td>80.040000</td>
      <td>1960-03-01</td>
    </tr>
    <tr>
      <th>183</th>
      <td>1960</td>
      <td>4</td>
      <td>48.840000</td>
      <td>1960-04-01</td>
    </tr>
    <tr>
      <th>244</th>
      <td>1960</td>
      <td>5</td>
      <td>62.760000</td>
      <td>1960-05-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>487</th>
      <td>2020</td>
      <td>8</td>
      <td>187.904762</td>
      <td>2020-08-01</td>
    </tr>
    <tr>
      <th>548</th>
      <td>2020</td>
      <td>9</td>
      <td>108.619048</td>
      <td>2020-09-01</td>
    </tr>
    <tr>
      <th>609</th>
      <td>2020</td>
      <td>10</td>
      <td>110.476190</td>
      <td>2020-10-01</td>
    </tr>
    <tr>
      <th>670</th>
      <td>2020</td>
      <td>11</td>
      <td>16.190476</td>
      <td>2020-11-01</td>
    </tr>
    <tr>
      <th>731</th>
      <td>2020</td>
      <td>12</td>
      <td>90.952381</td>
      <td>2020-12-01</td>
    </tr>
  </tbody>
</table>
<p>732 rows × 4 columns</p>
</div>




```python

era5_Imerg['lat'] = era5_Imerg['lat'].round(2).astype(float)
era5_Imerg['lon'] = era5_Imerg['lon'].round(2).astype(float)
era5_backintime['lat'] = era5_backintime['lat'].round(2).astype(float)
era5_backintime['lon'] = era5_backintime['lon'].round(2).astype(float)


# According to Histalp NA (sea) & monthly aggregation
#era5_Imerg_filt_month= Histalp_mask(era5_Imerg, histalp).resample(time="1MS").sum()
#era5_backintime_filt_month=Histalp_mask(era5_backintime, histalp).resample(time="1MS").sum()
#era5_backintime_filt_month

era5_Imerg_filt_month= era5_Imerg.resample(time="1MS").sum()
era5_backintime_filt_month=era5_backintime.resample(time="1MS").sum()
era5_backintime_filt_month
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 124MB
Dimensions:          (time: 492, lat: 60, lon: 150)
Coordinates:
  * lon              (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.75 18.85 18.95
  * lat              (lat) float64 480B 43.05 43.15 43.25 ... 48.75 48.85 48.95
  * time             (time) datetime64[ns] 4kB 1960-01-01 ... 2000-12-01
Data variables:
    camr             (time, lat, lon) float32 18MB 0.0 0.0 ... 0.03119 0.03025
    sp               (time, lat, lon) float32 18MB 0.0 0.0 ... 2.886e+06
    tciw             (time, lat, lon) float32 18MB 0.0 0.0 0.0 ... 0.8955 0.9025
    tcwv             (time, lat, lon) float32 18MB 0.0 0.0 0.0 ... 299.2 286.8
    ppt_era5         (time, lat, lon) float32 18MB 0.0 0.0 0.0 ... 69.25 71.39
    ETOPO_consmap_z  (time, lat, lon) float32 18MB 0.0 0.0 ... 2.086e+04
    XGB              (time, lat, lon) float32 18MB 0.0 0.0 0.0 ... 55.67 54.8
Attributes:
    CDI:                     Climate Data Interface version 2.0.4 (https://mp...
    Conventions:             CF-1.7
    GRIB_centre:             ecmf
    GRIB_centreDescription:  European Centre for Medium-Range Weather Forecasts
    history:                 Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Ima...
    frequency:               day
    CDO:                     Climate Data Operators version 2.0.4 (https://mp...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f35d0d57-a8f6-47a5-883b-703052ea5d1d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f35d0d57-a8f6-47a5-883b-703052ea5d1d' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 492</li><li><span class='xr-has-index'>lat</span>: 60</li><li><span class='xr-has-index'>lon</span>: 150</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-52abc713-c31f-45df-a6d2-9710ee04a1e5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-52abc713-c31f-45df-a6d2-9710ee04a1e5' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-60a591aa-5bd8-4743-a673-9e572e1da05e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-60a591aa-5bd8-4743-a673-9e572e1da05e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d0aa6f7-b599-46ac-8104-b26df589e1f1' class='xr-var-data-in' type='checkbox'><label for='data-3d0aa6f7-b599-46ac-8104-b26df589e1f1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-0a9bdf3c-0c83-485f-947b-da0b77140ba9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0a9bdf3c-0c83-485f-947b-da0b77140ba9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7de04c4e-8cbc-4d26-a756-fa451c3f8c1a' class='xr-var-data-in' type='checkbox'><label for='data-7de04c4e-8cbc-4d26-a756-fa451c3f8c1a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01 ... 2000-12-01</div><input id='attrs-19923469-26aa-4359-bf42-82153eb9adcc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-19923469-26aa-4359-bf42-82153eb9adcc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-75f5fd57-3b42-49db-a0bc-15813b1b7c67' class='xr-var-data-in' type='checkbox'><label for='data-75f5fd57-3b42-49db-a0bc-15813b1b7c67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>valid_time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T00:00:00.000000000&#x27;, &#x27;1960-02-01T00:00:00.000000000&#x27;,
       &#x27;1960-03-01T00:00:00.000000000&#x27;, ..., &#x27;2000-10-01T00:00:00.000000000&#x27;,
       &#x27;2000-11-01T00:00:00.000000000&#x27;, &#x27;2000-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8b09440b-0eb9-4320-b712-6ce28fe5d18c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8b09440b-0eb9-4320-b712-6ce28fe5d18c' class='xr-section-summary' >Data variables: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.03119 0.03025</div><input id='attrs-80e0c0a0-5151-457d-9726-a01694eeb50c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-80e0c0a0-5151-457d-9726-a01694eeb50c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e5c85beb-b5b1-45e6-ac20-e8641d99eeae' class='xr-var-data-in' type='checkbox'><label for='data-e5c85beb-b5b1-45e6-ac20-e8641d99eeae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.        , 0.        , 0.        , ..., 0.02327537,
         0.02327537, 0.02222649],
        [0.        , 0.        , 0.        , ..., 0.02288014,
         0.02288014, 0.02188271],
        [0.        , 0.        , 0.        , ..., 0.02288014,
         0.02288014, 0.02188271],
        ...,
        [0.03426288, 0.03438152, 0.03438152, ..., 0.02403006,
         0.02403006, 0.02352335],
        [0.03426288, 0.03438152, 0.03438152, ..., 0.02403006,
         0.02403006, 0.02352335],
        [0.03421957, 0.03432352, 0.03432352, ..., 0.02361134,
         0.02361134, 0.02294092]],

       [[0.        , 0.        , 0.        , ..., 0.02442425,
         0.02442425, 0.02313584],
        [0.        , 0.        , 0.        , ..., 0.02382131,
         0.02382131, 0.02256831],
        [0.        , 0.        , 0.        , ..., 0.02382131,
         0.02382131, 0.02256831],
...
        [0.04209049, 0.04249435, 0.04249435, ..., 0.04388579,
         0.04388579, 0.04308593],
        [0.04209049, 0.04249435, 0.04249435, ..., 0.04388579,
         0.04388579, 0.04308593],
        [0.0417444 , 0.04210739, 0.04210739, ..., 0.0428506 ,
         0.0428506 , 0.0417992 ]],

       [[0.        , 0.        , 0.        , ..., 0.02696956,
         0.02696956, 0.02539347],
        [0.        , 0.        , 0.        , ..., 0.02678917,
         0.02678917, 0.02526414],
        [0.        , 0.        , 0.        , ..., 0.02678917,
         0.02678917, 0.02526414],
        ...,
        [0.04347637, 0.04351437, 0.04351437, ..., 0.03161766,
         0.03161766, 0.03088908],
        [0.04347637, 0.04351437, 0.04351437, ..., 0.03161766,
         0.03161766, 0.03088908],
        [0.04302143, 0.04308132, 0.04308132, ..., 0.03119043,
         0.03119043, 0.03024861]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sp</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 2.92e+06 2.886e+06</div><input id='attrs-d6d82630-3f18-481a-98de-b63263c648d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d6d82630-3f18-481a-98de-b63263c648d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-80856e06-4486-4498-8747-15f20eed5815' class='xr-var-data-in' type='checkbox'><label for='data-80856e06-4486-4498-8747-15f20eed5815' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>surface_air_pressure</dd><dt><span>long_name :</span></dt><dd>Surface pressure</dd><dt><span>units :</span></dt><dd>Pa</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>surface_air_pressure</dd><dt><span>GRIB_cfVarName :</span></dt><dd>sp</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Surface pressure</dd><dt><span>GRIB_shortName :</span></dt><dd>sp</dd><dt><span>GRIB_units :</span></dt><dd>Pa</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[      0. ,       0. ,       0. , ..., 2714172. , 2714172. ,
         2664210.5],
        [      0. ,       0. ,       0. , ..., 2717036.2, 2717036.2,
         2670323.2],
        [      0. ,       0. ,       0. , ..., 2717036.2, 2717036.2,
         2670323.2],
        ...,
        [3096131.2, 3102319.8, 3102319.8, ..., 2928812.8, 2928812.8,
         2903827.2],
        [3096131.2, 3102319.8, 3102319.8, ..., 2928812.8, 2928812.8,
         2903827.2],
        [3093039.2, 3098970.5, 3098970.5, ..., 2918266.5, 2918266.5,
         2884301.2]],

       [[      0. ,       0. ,       0. , ..., 2453058.2, 2453058.2,
         2407932.5],
        [      0. ,       0. ,       0. , ..., 2455229.2, 2455229.2,
         2413019.8],
        [      0. ,       0. ,       0. , ..., 2455229.2, 2455229.2,
         2413019.8],
...
        [2965914. , 2972192.8, 2972192.8, ..., 2833457.5, 2833457.5,
         2811112.2],
        [2965914. , 2972192.8, 2972192.8, ..., 2833457.5, 2833457.5,
         2811112.2],
        [2962193. , 2968289. , 2968289. , ..., 2823041.8, 2823041.8,
         2792127.8]],

       [[      0. ,       0. ,       0. , ..., 2724344.5, 2724344.5,
         2674686.5],
        [      0. ,       0. ,       0. , ..., 2726376.8, 2726376.8,
         2679950.5],
        [      0. ,       0. ,       0. , ..., 2726376.8, 2726376.8,
         2679950.5],
        ...,
        [3077890.8, 3084317.8, 3084317.8, ..., 2930305.5, 2930305.5,
         2905953. ],
        [3077890.8, 3084317.8, 3084317.8, ..., 2930305.5, 2930305.5,
         2905953. ],
        [3074532.8, 3080756.2, 3080756.2, ..., 2919629. , 2919629. ,
         2886397.8]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 0.8955 0.9025</div><input id='attrs-80803acf-5419-40cc-ac36-f4f3e4387abd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-80803acf-5419-40cc-ac36-f4f3e4387abd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cd70b248-2f08-4fe3-b8f3-5daa0c84b736' class='xr-var-data-in' type='checkbox'><label for='data-cd70b248-2f08-4fe3-b8f3-5daa0c84b736' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[0.        , 0.        , 0.        , ..., 1.0037594 ,
         1.0037594 , 1.1088219 ],
        [0.        , 0.        , 0.        , ..., 0.96363515,
         0.96363515, 1.0772196 ],
        [0.        , 0.        , 0.        , ..., 0.96363515,
         0.96363515, 1.0772196 ],
        ...,
        [0.67507935, 0.6623516 , 0.6623516 , ..., 0.88900244,
         0.88900244, 0.8548582 ],
        [0.67507935, 0.6623516 , 0.6623516 , ..., 0.88900244,
         0.88900244, 0.8548582 ],
        [0.6995608 , 0.6933009 , 0.6933009 , ..., 0.9199092 ,
         0.9199092 , 0.91905016]],

       [[0.        , 0.        , 0.        , ..., 1.1219356 ,
         1.1219356 , 1.1413906 ],
        [0.        , 0.        , 0.        , ..., 0.9474125 ,
         0.9474125 , 0.9729411 ],
        [0.        , 0.        , 0.        , ..., 0.9474125 ,
         0.9474125 , 0.9729411 ],
...
        [1.2720966 , 1.274883  , 1.274883  , ..., 0.87413484,
         0.87413484, 0.83893305],
        [1.2720966 , 1.274883  , 1.274883  , ..., 0.87413484,
         0.87413484, 0.83893305],
        [1.2792324 , 1.2826736 , 1.2826736 , ..., 0.8385613 ,
         0.8385613 , 0.80127597]],

       [[0.        , 0.        , 0.        , ..., 1.008327  ,
         1.008327  , 0.97755915],
        [0.        , 0.        , 0.        , ..., 0.8194377 ,
         0.8194377 , 0.8055702 ],
        [0.        , 0.        , 0.        , ..., 0.8194377 ,
         0.8194377 , 0.8055702 ],
        ...,
        [0.9981392 , 1.0199109 , 1.0199109 , ..., 0.85497636,
         0.85497636, 0.8587009 ],
        [0.9981392 , 1.0199109 , 1.0199109 , ..., 0.85497636,
         0.85497636, 0.8587009 ],
        [1.0336422 , 1.0529014 , 1.0529014 , ..., 0.8954573 ,
         0.8954573 , 0.90245754]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 299.2 299.2 286.8</div><input id='attrs-c671319c-e84a-4ea8-b2a9-6577dee13c9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c671319c-e84a-4ea8-b2a9-6577dee13c9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8109329a-723d-4f64-a54e-60baa5d4b9c3' class='xr-var-data-in' type='checkbox'><label for='data-8109329a-723d-4f64-a54e-60baa5d4b9c3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tcwv</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>GRIB_shortName :</span></dt><dd>tcwv</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[  0.     ,   0.     ,   0.     , ..., 207.57735, 207.57735,
         194.571  ],
        [  0.     ,   0.     ,   0.     , ..., 204.312  , 204.312  ,
         192.04283],
        [  0.     ,   0.     ,   0.     , ..., 204.312  , 204.312  ,
         192.04283],
        ...,
        [348.70035, 350.6123 , 350.6123 , ..., 231.56758, 231.56758,
         224.75877],
        [348.70035, 350.6123 , 350.6123 , ..., 231.56758, 231.56758,
         224.75877],
        [347.901  , 349.6325 , 349.6325 , ..., 226.71913, 226.71913,
         217.72641]],

       [[  0.     ,   0.     ,   0.     , ..., 217.70415, 217.70415,
         202.43436],
        [  0.     ,   0.     ,   0.     , ..., 212.46965, 212.46965,
         197.84068],
        [  0.     ,   0.     ,   0.     , ..., 212.46965, 212.46965,
         197.84068],
...
        [423.8529 , 428.82526, 428.82526, ..., 422.16226, 422.16226,
         411.21902],
        [423.8529 , 428.82526, 428.82526, ..., 422.16226, 422.16226,
         411.21902],
        [419.83704, 424.35822, 424.35822, ..., 410.6917 , 410.6917 ,
         396.24567]],

       [[  0.     ,   0.     ,   0.     , ..., 241.29004, 241.29004,
         223.03777],
        [  0.     ,   0.     ,   0.     , ..., 239.85335, 239.85335,
         222.33727],
        [  0.     ,   0.     ,   0.     , ..., 239.85335, 239.85335,
         222.33727],
        ...,
        [439.99078, 441.286  , 441.286  , ..., 304.3685 , 304.3685 ,
         294.89114],
        [439.99078, 441.286  , 441.286  , ..., 304.3685 , 304.3685 ,
         294.89114],
        [434.9143 , 436.39157, 436.39157, ..., 299.17667, 299.17667,
         286.84515]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 68.54 69.25 71.39</div><input id='attrs-fe02171e-2438-4752-9697-74785d3875d5' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fe02171e-2438-4752-9697-74785d3875d5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b069125-90c7-4375-ae13-3c5200c55eb8' class='xr-var-data-in' type='checkbox'><label for='data-9b069125-90c7-4375-ae13-3c5200c55eb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[  0.      ,   0.      ,   0.      , ..., 160.52295 ,
         165.74084 , 181.39386 ],
        [  0.      ,   0.      ,   0.      , ..., 138.03722 ,
         142.09933 , 154.28513 ],
        [  0.      ,   0.      ,   0.      , ..., 130.53586 ,
         134.21239 , 145.24152 ],
        ...,
        [ 58.360577,  59.63785 ,  60.0636  , ...,  54.507492,
          54.809525,  55.71556 ],
        [ 58.482315,  59.59239 ,  59.96241 , ...,  55.269325,
          55.64573 ,  56.774895],
        [ 58.847904,  59.45587 ,  59.658527, ...,  57.557106,
          58.156868,  59.956074]],

       [[  0.      ,   0.      ,   0.      , ..., 226.23444 ,
         224.3547  , 218.71591 ],
        [  0.      ,   0.      ,   0.      , ..., 176.42044 ,
         172.46544 , 160.60094 ],
        [  0.      ,   0.      ,   0.      , ..., 159.80219 ,
         155.15486 , 141.21342 ],
...
        [125.91882 , 134.3473  , 137.15675 , ..., 104.51431 ,
         105.89416 , 110.03349 ],
        [125.54474 , 133.18677 , 135.73405 , ..., 103.97433 ,
         104.86237 , 107.5263  ],
        [124.421455, 129.70163 , 131.46169 , ..., 102.352745,
         101.76387 ,  99.99723 ]],

       [[  0.      ,   0.      ,   0.      , ..., 162.42984 ,
         166.73735 , 179.6593  ],
        [  0.      ,   0.      ,   0.      , ..., 122.07286 ,
         124.49733 , 131.77051 ],
        [  0.      ,   0.      ,   0.      , ..., 108.60953 ,
         110.40582 , 115.794495],
        ...,
        [ 79.36099 ,  78.02317 ,  77.57723 , ...,  66.61615 ,
          67.45467 ,  69.970146],
        [ 79.23372 ,  78.03904 ,  77.640816, ...,  67.097595,
          67.90416 ,  70.32376 ],
        [ 78.85156 ,  78.08667 ,  77.83169 , ...,  68.54336 ,
          69.25395 ,  71.38562 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 1.461e+04 2.086e+04</div><input id='attrs-99711bb2-f755-45ae-a0ad-5fcccd058cfc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-99711bb2-f755-45ae-a0ad-5fcccd058cfc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-89f880cd-45fa-4fc9-ae9c-d40266e79c79' class='xr-var-data-in' type='checkbox'><label for='data-89f880cd-45fa-4fc9-ae9c-d40266e79c79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[[    0.    ,     0.    ,     0.    , ..., 44312.4   ,
         35882.254 , 44465.59  ],
        [    0.    ,     0.    ,     0.    , ..., 42691.484 ,
         32736.36  , 50161.066 ],
        [    0.    ,     0.    ,     0.    , ..., 55220.895 ,
         38978.06  , 40627.668 ],
        ...,
        [ 4658.7646,  5167.0557,  5368.2207, ..., 16923.457 ,
         22786.072 , 28420.748 ],
        [ 4098.463 ,  3892.8442,  4102.5596, ..., 18215.139 ,
         16582.729 , 26903.332 ],
        [ 3514.2866,  2973.285 ,  3149.8752, ..., 20945.889 ,
         14606.027 , 20857.836 ]],

       [[    0.    ,     0.    ,     0.    , ..., 40024.098 ,
         32409.78  , 40162.465 ],
        [    0.    ,     0.    ,     0.    , ..., 38560.05  ,
         29568.324 , 45306.773 ],
        [    0.    ,     0.    ,     0.    , ..., 49876.934 ,
         35205.992 , 36695.957 ],
...
        [ 4508.482 ,  5000.3765,  5195.0522, ..., 16377.539 ,
         22051.037 , 27503.95  ],
        [ 3966.2546,  3767.2686,  3970.219 , ..., 17627.553 ,
         16047.802 , 26035.482 ],
        [ 3400.9226,  2877.3726,  3048.2664, ..., 20270.215 ,
         14134.865 , 20185.002 ]],

       [[    0.    ,     0.    ,     0.    , ..., 44312.4   ,
         35882.254 , 44465.59  ],
        [    0.    ,     0.    ,     0.    , ..., 42691.484 ,
         32736.36  , 50161.066 ],
        [    0.    ,     0.    ,     0.    , ..., 55220.895 ,
         38978.06  , 40627.668 ],
        ...,
        [ 4658.7646,  5167.0557,  5368.2207, ..., 16923.457 ,
         22786.072 , 28420.748 ],
        [ 4098.463 ,  3892.8442,  4102.5596, ..., 18215.139 ,
         16582.729 , 26903.332 ],
        [ 3514.2866,  2973.285 ,  3149.8752, ..., 20945.889 ,
         14606.027 , 20857.836 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XGB</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 ... 55.92 55.67 54.8</div><input id='attrs-50935109-d673-4949-99ec-f97e9b0b97cd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-50935109-d673-4949-99ec-f97e9b0b97cd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b6380e3f-d768-4277-a534-8349dae8b53b' class='xr-var-data-in' type='checkbox'><label for='data-b6380e3f-d768-4277-a534-8349dae8b53b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[[  0.      ,   0.      ,   0.      , ...,  71.3769  ,
          72.23867 ,  68.85586 ],
        [  0.      ,   0.      ,   0.      , ...,  61.150135,
          61.34123 ,  58.928635],
        [  0.      ,   0.      ,   0.      , ...,  57.011642,
          56.154522,  56.868355],
        ...,
        [ 53.979404,  52.737843,  52.688644, ...,  29.018312,
          28.75469 ,  27.322748],
        [ 54.130096,  52.091797,  52.6762  , ...,  29.2198  ,
          29.27414 ,  27.816448],
        [ 54.540295,  53.90158 ,  53.960297, ...,  30.62152 ,
          30.849234,  29.407122]],

       [[  0.      ,   0.      ,   0.      , ..., 110.86507 ,
         112.227234,  95.5483  ],
        [  0.      ,   0.      ,   0.      , ...,  75.73246 ,
          73.95908 ,  62.499207],
        [  0.      ,   0.      ,   0.      , ...,  68.752205,
          68.63454 ,  58.762306],
...
        [120.18801 , 125.26729 , 126.38701 , ...,  95.73254 ,
          97.52476 ,  93.79496 ],
        [119.312706, 124.95618 , 125.24615 , ...,  96.075356,
          96.34104 ,  92.57548 ],
        [117.83134 , 122.845085, 123.16877 , ...,  93.24342 ,
          92.50162 ,  86.823456]],

       [[  0.      ,   0.      ,   0.      , ..., 115.05079 ,
         117.389084, 117.25282 ],
        [  0.      ,   0.      ,   0.      , ...,  82.12239 ,
          84.575874,  75.764244],
        [  0.      ,   0.      ,   0.      , ...,  79.81055 ,
          81.59592 ,  70.93645 ],
        ...,
        [ 83.38174 ,  83.05581 ,  81.976746, ...,  54.119385,
          54.157166,  54.806248],
        [ 84.65596 ,  84.734344,  83.89012 , ...,  53.963707,
          53.947258,  54.623615],
        [ 88.09697 ,  89.48297 ,  88.83147 , ...,  55.917587,
          55.672375,  54.796562]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-938e6733-f09c-4f1f-bb43-84bf04c998d7' class='xr-section-summary-in' type='checkbox'  ><label for='section-938e6733-f09c-4f1f-bb43-84bf04c998d7' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e97036ed-80d2-4f6f-a781-84a3778e61c2' class='xr-index-data-in' type='checkbox'/><label for='index-e97036ed-80d2-4f6f-a781-84a3778e61c2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b7e674be-d16b-4944-9483-a8591b774540' class='xr-index-data-in' type='checkbox'/><label for='index-b7e674be-d16b-4944-9483-a8591b774540' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-4c714e69-b59a-414c-aaf5-f127a2219649' class='xr-index-data-in' type='checkbox'/><label for='index-4c714e69-b59a-414c-aaf5-f127a2219649' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01&#x27;, &#x27;1960-02-01&#x27;, &#x27;1960-03-01&#x27;, &#x27;1960-04-01&#x27;,
               &#x27;1960-05-01&#x27;, &#x27;1960-06-01&#x27;, &#x27;1960-07-01&#x27;, &#x27;1960-08-01&#x27;,
               &#x27;1960-09-01&#x27;, &#x27;1960-10-01&#x27;,
               ...
               &#x27;2000-03-01&#x27;, &#x27;2000-04-01&#x27;, &#x27;2000-05-01&#x27;, &#x27;2000-06-01&#x27;,
               &#x27;2000-07-01&#x27;, &#x27;2000-08-01&#x27;, &#x27;2000-09-01&#x27;, &#x27;2000-10-01&#x27;,
               &#x27;2000-11-01&#x27;, &#x27;2000-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=492, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5c1a34ce-7285-4fa0-bf2f-92b4ec809a6d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c1a34ce-7285-4fa0-bf2f-92b4ec809a6d' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.7</dd><dt><span>GRIB_centre :</span></dt><dd>ecmf</dd><dt><span>GRIB_centreDescription :</span></dt><dd>European Centre for Medium-Range Weather Forecasts</dd><dt><span>history :</span></dt><dd>Tue Jan 28 09:58:22 2025: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean_NN.nc
Tue Jan 28 09:58:16 2025: cdo -b F32 -daymean -expr,camr=tcwv/(sp/9.81) /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/camr_1960_daymean.nc
Tue Jan 28 09:07:49 2025: cdo merge /mnt/c/Iman/Maxm/ERA5_hourly_backintime/total_column_water_vapour_1960.nc /mnt/c/Iman/Maxm/ERA5_hourly_backintime/surface_pressure_1960.nc /mnt/c/Iman/Maxm/Temporary/merged_tcwv_sp_1960.nc
2025-01-27T07:24 GRIB to CDM+CF via cfgrib-0.9.15.0/ecCodes-2.39.0 with {&quot;source&quot;: &quot;tmpyzz0lrjl/data.grib&quot;, &quot;filter_by_keys&quot;: {&quot;stream&quot;: [&quot;oper&quot;], &quot;stepType&quot;: [&quot;instant&quot;]}, &quot;encode_cf&quot;: [&quot;parameter&quot;, &quot;time&quot;, &quot;geography&quot;, &quot;vertical&quot;]}</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
lat_points = xr.DataArray(Histalp_stations_df[['closest_Imerg_lat', 'closest_Imerg_lon']].drop_duplicates()['closest_Imerg_lat'].values, dims="points")
lon_points = xr.DataArray(Histalp_stations_df[['closest_Imerg_lat', 'closest_Imerg_lon']].drop_duplicates()['closest_Imerg_lon'].values, dims="points")

# Select only matching lat/lon pairs
era5_backintime_filt_month_stations = era5_backintime_filt_month.sel(lat=lat_points, lon=lon_points, method=None) # No nearest
era5_Imerg_filt_month_stations = era5_Imerg_filt_month.sel(lat=lat_points, lon=lon_points, method=None)  # No nearest

era5_Imerg_filt_month_stations

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 915kB
Dimensions:                            (time: 240, points: 50)
Coordinates:
    lon                                (points) float64 400B 15.25 ... 15.95
    lat                                (points) float64 400B 47.45 ... 48.75
  * time                               (time) datetime64[ns] 2kB 2001-01-01 ....
Dimensions without coordinates: points
Data variables: (12/18)
    cape                               (time, points) float32 48kB 231.5 ... ...
    tciw                               (time, points) float32 48kB 1.049 ... ...
    tcwv                               (time, points) float32 48kB 224.6 ... ...
    p71.162                            (time, points) float32 48kB 1.492e+03 ...
    tp_NearestN                        (time, points) float32 48kB 56.9 ... 4...
    t                                  (time, points) float32 48kB 7.706e+03 ...
    ...                                 ...
    Rain/No rain threshold             (time, points) float64 96kB 19.0 ... 6.0
    Imerg P with threshold             (time, points) float32 48kB 59.51 ... ...
    precipitationQualityIndex          (time, points) float32 48kB 14.67 ... ...
    XGB                                (time, points) float32 48kB 47.79 ... ...
    Z 100 percentile class             (time, points) float32 48kB 2.325e+03 ...
    Imerg_orgres 100 percentile class  (time, points) float32 48kB 2.088e+03 ...
Attributes:
    CDI:          Climate Data Interface version 2.0.4 (https://mpimet.mpg.de...
    Conventions:  CF-1.6
    history:      Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imer...
    frequency:    day
    CDO:          Climate Data Operators version 2.0.4 (https://mpimet.mpg.de...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-471015f9-e7d9-4a9d-ada2-33d02d265e14' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-471015f9-e7d9-4a9d-ada2-33d02d265e14' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time</span>: 240</li><li><span>points</span>: 50</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-4312b9dd-f60c-446e-86c4-66f43e774746' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4312b9dd-f60c-446e-86c4-66f43e774746' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.25 14.55 13.85 ... 13.85 15.95</div><input id='attrs-d0344de2-2083-45a3-8de3-de605dbc9c62' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d0344de2-2083-45a3-8de3-de605dbc9c62' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dbc702f8-d0d8-48a2-adb7-93fa0b6b8630' class='xr-var-data-in' type='checkbox'><label for='data-dbc702f8-d0d8-48a2-adb7-93fa0b6b8630' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([15.25, 14.55, 13.85, 10.55, 15.65, 16.35, 17.25,  9.15, 12.15,  9.95,
       17.65, 15.25, 17.45,  6.65,  8.45,  8.05,  9.15, 13.25, 11.55, 14.55,
       14.45, 15.25, 11.05, 11.65, 10.25,  7.65, 11.35, 16.65, 15.55,  9.15,
       12.15, 10.35, 15.85, 14.75, 13.85, 15.35, 12.65, 12.35, 13.05, 12.95,
       13.25, 10.15, 14.15, 12.85, 16.25,  9.75, 13.15, 11.35, 13.85, 15.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>47.45 48.45 48.65 ... 46.65 48.75</div><input id='attrs-7ce1cc70-e84f-4333-b4a8-4fac68d28720' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ce1cc70-e84f-4333-b4a8-4fac68d28720' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb10e506-362e-4386-b08b-1fa002f87ab8' class='xr-var-data-in' type='checkbox'><label for='data-cb10e506-362e-4386-b08b-1fa002f87ab8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([47.45, 48.45, 48.65, 47.15, 48.15, 48.25, 44.35, 47.65, 48.55, 48.35,
       45.35, 44.15, 47.35, 45.05, 46.35, 43.95, 45.45, 46.05, 43.75, 46.05,
       47.55, 46.25, 45.85, 46.75, 47.45, 45.05, 46.55, 47.25, 45.45, 48.85,
       47.85, 44.85, 44.85, 47.95, 47.15, 47.75, 47.05, 45.45, 47.85, 47.25,
       46.95, 47.15, 48.05, 46.65, 47.45, 47.55, 46.95, 47.25, 46.65, 48.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2001-01-01 ... 2020-12-01</div><input id='attrs-015860a1-d25d-4b09-8cd9-4df1c8e1d661' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-015860a1-d25d-4b09-8cd9-4df1c8e1d661' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c569b75d-9dbb-4b39-badb-5fdb3183f161' class='xr-var-data-in' type='checkbox'><label for='data-c569b75d-9dbb-4b39-badb-5fdb3183f161' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2001-01-01T00:00:00.000000000&#x27;, &#x27;2001-02-01T00:00:00.000000000&#x27;,
       &#x27;2001-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1fdd432f-2196-40fc-8a1d-d80285f67cd4' class='xr-section-summary-in' type='checkbox'  ><label for='section-1fdd432f-2196-40fc-8a1d-d80285f67cd4' class='xr-section-summary' >Data variables: <span>(18)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>cape</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>231.5 189.2 ... 1.273e+03 569.7</div><input id='attrs-c8fa289c-5dfc-42eb-9fba-4e20bf3f3225' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c8fa289c-5dfc-42eb-9fba-4e20bf3f3225' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1faafe2a-b42a-44da-b562-2e195fe2e792' class='xr-var-data-in' type='checkbox'><label for='data-1faafe2a-b42a-44da-b562-2e195fe2e792' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>J kg**-1</dd></dl></div><div class='xr-var-data'><pre>array([[ 231.4848 ,  189.16801,  235.3119 , ...,  330.33328,  358.9819 ,
         212.56798],
       [ 635.4077 ,  648.3105 ,  652.6842 , ...,  776.6824 ,  446.56772,
         267.89694],
       [1291.5912 , 1122.8706 , 1598.1965 , ..., 1529.8551 , 2127.976  ,
         626.66   ],
       ...,
       [1885.1111 ,  939.7944 , 1209.5343 , ..., 1672.5592 , 1915.6688 ,
        1976.0474 ],
       [ 476.89233,  649.9284 ,  700.12115, ...,  746.01855,  194.26671,
         646.124  ],
       [ 564.6375 ,  420.6863 ,  656.8007 , ..., 1189.04   , 1273.3494 ,
         569.66907]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.049 0.963 0.9616 ... 1.838 1.039</div><input id='attrs-0c67fa1b-06ab-4213-aed2-6a492de90f0a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0c67fa1b-06ab-4213-aed2-6a492de90f0a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fcf53ea9-93ab-48ad-b55f-cd53d0944870' class='xr-var-data-in' type='checkbox'><label for='data-fcf53ea9-93ab-48ad-b55f-cd53d0944870' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>kg m**-2</dd></dl></div><div class='xr-var-data'><pre>array([[1.048778  , 0.96299064, 0.9616448 , ..., 1.4909117 , 1.0769284 ,
        0.98254925],
       [0.6326833 , 0.7760295 , 0.7462122 , ..., 1.5005672 , 0.4593309 ,
        0.6395264 ],
       [1.0341022 , 1.291177  , 1.4172293 , ..., 1.9594514 , 1.1035359 ,
        1.0555166 ],
       ...,
       [1.34797   , 1.3815961 , 1.2835835 , ..., 1.4732414 , 1.1734958 ,
        1.6067239 ],
       [0.3574986 , 0.41427556, 0.4112482 , ..., 0.432659  , 0.2918663 ,
        0.40716547],
       [1.044904  , 1.0409759 , 1.0192546 , ..., 1.6518588 , 1.8375144 ,
        1.0388268 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tcwv</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>224.6 253.2 247.0 ... 261.0 365.6</div><input id='attrs-fa32a511-6234-42ee-b0d2-4186f498420d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fa32a511-6234-42ee-b0d2-4186f498420d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-706fe74e-7fff-4558-b4d6-16d9221beef4' class='xr-var-data-in' type='checkbox'><label for='data-706fe74e-7fff-4558-b4d6-16d9221beef4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>lwe_thickness_of_atmosphere_mass_content_of_water_vapor</dd><dt><span>long_name :</span></dt><dd>Total column vertically-integrated water vapour</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[224.6046 , 253.24348, 247.01717, ..., 171.6428 , 228.85193,
        297.15662],
       [175.14964, 214.5393 , 212.1942 , ..., 144.36986, 169.41154,
        241.232  ],
       [302.74844, 348.03857, 338.87833, ..., 243.12091, 304.08466,
        387.90314],
       ...,
       [417.7115 , 485.54315, 466.65933, ..., 305.39807, 388.3104 ,
        577.7918 ],
       [272.56104, 332.58746, 326.4765 , ..., 222.39427, 258.07205,
        393.13663],
       [270.0067 , 310.73425, 304.96198, ..., 193.27377, 260.9776 ,
        365.644  ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>p71.162</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.492e+03 1.472e+03 ... 846.7 842.8</div><input id='attrs-e5f6bb37-7b03-4cbd-b2ce-1dc000f16585' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e5f6bb37-7b03-4cbd-b2ce-1dc000f16585' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a0280fb6-3ccd-49d4-8226-2b5af76ed66d' class='xr-var-data-in' type='checkbox'><label for='data-a0280fb6-3ccd-49d4-8226-2b5af76ed66d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Vertical integral of eastward water vapour flux</dd><dt><span>units :</span></dt><dd>kg m**-1 s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[1491.8063 , 1472.2605 , 1636.5012 , ..., 1013.70465, 1594.182  ,
        1261.9231 ],
       [1156.5635 , 1657.8143 , 1706.5015 , ...,  816.554  ,  847.60315,
        1640.4722 ],
       [2720.76   , 3496.8928 , 3622.2876 , ..., 1982.8438 , 2380.0195 ,
        3106.4792 ],
       ...,
       [2314.3638 , 3035.2043 , 3105.6492 , ..., 1413.8184 , 2104.4243 ,
        2933.864  ],
       [1052.8612 , 1764.4806 , 1902.4075 , ...,  615.9977 ,  498.62976,
        1664.8276 ],
       [ 955.7676 , 1190.2681 , 1374.8475 , ...,  689.51587,  846.6801 ,
         842.8265 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tp_NearestN</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>56.9 36.84 43.57 ... 243.9 45.77</div><input id='attrs-ed8a162c-717b-45d0-97aa-c1fbf0f97f4d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ed8a162c-717b-45d0-97aa-c1fbf0f97f4d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9f3e5215-d0bc-4fed-8ff1-375dc55f73c5' class='xr-var-data-in' type='checkbox'><label for='data-9f3e5215-d0bc-4fed-8ff1-375dc55f73c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 56.904285,  36.84    ,  43.568413, ..., 100.06412 , 107.08862 ,
         37.17282 ],
       [ 61.91381 ,  46.21642 ,  66.45469 , ..., 125.520874,  33.280388,
         21.16913 ],
       [ 91.963326, 106.61709 , 136.11752 , ..., 177.11197 , 140.04115 ,
         62.45093 ],
       ...,
       [125.33153 ,  89.800705,  87.14727 , ..., 188.97336 , 133.25195 ,
         86.95248 ],
       [ 21.89741 ,  25.090475,  28.097782, ...,  34.546253,  16.870987,
         24.935768],
       [ 80.51436 ,  40.73421 ,  49.377174, ..., 154.35495 , 243.9386  ,
         45.769176]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>t</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>7.706e+03 7.684e+03 ... 7.736e+03</div><input id='attrs-f3c11f63-7ca0-4d06-a8e7-5682a975b16a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f3c11f63-7ca0-4d06-a8e7-5682a975b16a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2f69bc0e-390d-458b-8d67-c754cd35c374' class='xr-var-data-in' type='checkbox'><label for='data-2f69bc0e-390d-458b-8d67-c754cd35c374' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>long_name :</span></dt><dd>Temperature</dd><dt><span>units :</span></dt><dd>K</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[7706.3022, 7684.226 , 7675.1157, ..., 7699.2456, 7717.9175,
        7683.404 ],
       [6905.705 , 6886.238 , 6888.2515, ..., 6922.829 , 6931.875 ,
        6874.4434],
       [7751.7393, 7731.587 , 7727.7383, ..., 7759.3203, 7771.9844,
        7726.1724],
       ...,
       [7930.0596, 7915.7256, 7909.598 , ..., 7919.3545, 7933.893 ,
        7919.727 ],
       [7646.4443, 7641.2227, 7640.361 , ..., 7644.9985, 7650.35  ,
        7636.5156],
       [7745.2383, 7732.8174, 7728.8447, ..., 7721.33  , 7736.2417,
        7735.755 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>u</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>312.2 312.9 314.4 ... 185.6 177.1</div><input id='attrs-595bc2e0-33da-4849-8183-5ae1afdecd41' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-595bc2e0-33da-4849-8183-5ae1afdecd41' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d2cc912f-8fba-4b34-a725-0041a5d08ea1' class='xr-var-data-in' type='checkbox'><label for='data-d2cc912f-8fba-4b34-a725-0041a5d08ea1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>eastward_wind</dd><dt><span>long_name :</span></dt><dd>U component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[312.24478, 312.91632, 314.4318 , ..., 311.66953, 330.47046,
        312.44833],
       [269.3771 , 272.06696, 270.75998, ..., 241.30333, 244.01318,
        287.70758],
       [478.35144, 512.7267 , 527.3519 , ..., 500.91425, 486.82986,
        507.54523],
       ...,
       [277.78806, 273.33838, 272.61002, ..., 270.85733, 292.3067 ,
        271.04773],
       [144.66646, 174.36238, 183.92303, ..., 127.01774, 114.67531,
        193.60585],
       [166.48985, 174.8099 , 185.35551, ..., 196.46164, 185.58473,
        177.05196]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>v</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>94.8 92.95 93.27 ... 202.2 205.1</div><input id='attrs-8dde1a80-addd-4a85-9b95-1c921eae473b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8dde1a80-addd-4a85-9b95-1c921eae473b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-556fc7e4-e6bf-4560-8613-da8a7115fc2d' class='xr-var-data-in' type='checkbox'><label for='data-556fc7e4-e6bf-4560-8613-da8a7115fc2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>northward_wind</dd><dt><span>long_name :</span></dt><dd>V component of wind</dd><dt><span>units :</span></dt><dd>m s**-1</dd><dt><span>cell_methods :</span></dt><dd>time: mean</dd></dl></div><div class='xr-var-data'><pre>array([[  94.79909  ,   92.95478  ,   93.26839  , ...,   89.649445 ,
          92.05932  ,   93.38406  ],
       [-186.38007  , -203.698    , -202.27965  , ..., -181.51482  ,
        -163.72162  , -200.72542  ],
       [   3.4757032,    9.207007 ,   19.696625 , ...,   -8.523636 ,
          -8.070744 ,    6.337763 ],
       ...,
       [  75.511826 ,   71.619896 ,   72.41878  , ...,   55.483818 ,
          81.68184  ,   79.864746 ],
       [ -57.204933 ,  -56.4188   ,  -42.36026  , ...,  -29.436543 ,
         -29.759373 ,  -98.60874  ],
       [ 202.46397  ,  192.93906  ,  191.34468  , ...,  165.93697  ,
         202.22177  ,  205.06854  ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02471 0.02658 ... 0.02922 0.03677</div><input id='attrs-4db50ac4-9692-4de1-ada9-209f20c4eb9f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4db50ac4-9692-4de1-ada9-209f20c4eb9f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a04404d2-d6d6-4925-a713-58409f35d60c' class='xr-var-data-in' type='checkbox'><label for='data-a04404d2-d6d6-4925-a713-58409f35d60c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[0.02470602, 0.02658433, 0.02612842, ..., 0.0203722 , 0.02557594,
        0.02980692],
       [0.01919578, 0.02242736, 0.02233946, ..., 0.01704404, 0.0188709 ,
        0.02414479],
       [0.03348771, 0.03677575, 0.03607279, ..., 0.02896503, 0.03415854,
        0.03923252],
       ...,
       [0.04582352, 0.05088647, 0.04925838, ..., 0.03605552, 0.04327403,
        0.05802945],
       [0.0295947 , 0.0344953 , 0.03410914, ..., 0.02599172, 0.02847728,
        0.03903557],
       [0.02974532, 0.03268501, 0.03231619, ..., 0.02296976, 0.02922492,
        0.03677347]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ETOPO_consmap_z</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.35e+04 1.893e+04 ... 8.959e+03</div><input id='attrs-4d8f985c-d579-49cd-8a81-85fafc98acb0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4d8f985c-d579-49cd-8a81-85fafc98acb0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f8c53e7c-db22-45a0-ad3d-79b7072a1005' class='xr-var-data-in' type='checkbox'><label for='data-f8c53e7c-db22-45a0-ad3d-79b7072a1005' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[23499.797, 18928.46 , 20640.574, ..., 31556.596, 23097.197,
         8958.974],
       [21225.621, 17096.674, 18643.102, ..., 28502.73 , 20861.986,
         8091.976],
       [23499.797, 18928.46 , 20640.574, ..., 31556.596, 23097.197,
         8958.974],
       ...,
       [23499.797, 18928.46 , 20640.574, ..., 31556.596, 23097.197,
         8958.974],
       [22741.738, 18317.865, 19974.75 , ..., 30538.64 , 22352.127,
         8669.975],
       [23499.797, 18928.46 , 20640.574, ..., 31556.596, 23097.197,
         8958.974]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>56.9 36.84 43.19 ... 250.0 45.77</div><input id='attrs-fc57d06e-9da9-44f7-82ba-a35aeaa277e8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc57d06e-9da9-44f7-82ba-a35aeaa277e8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe3da0ea-5812-4c5c-b256-030659f993cb' class='xr-var-data-in' type='checkbox'><label for='data-fe3da0ea-5812-4c5c-b256-030659f993cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[ 56.904285,  36.84    ,  43.191483, ..., 100.5823  , 123.2146  ,
         37.17282 ],
       [ 61.91381 ,  46.21642 ,  62.033   , ..., 125.41805 ,  34.420673,
         21.16913 ],
       [ 91.963326, 106.61709 , 132.63426 , ..., 174.99728 , 153.64488 ,
         62.45093 ],
       ...,
       [125.33153 ,  89.800705,  87.07151 , ..., 189.24315 , 143.9171  ,
         86.95248 ],
       [ 21.89741 ,  25.090475,  27.540035, ...,  34.52556 ,  19.983315,
         24.935768],
       [ 80.51436 ,  40.73421 ,  48.877247, ..., 157.24481 , 250.01329 ,
         45.769176]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>61.75 48.46 56.25 ... 314.0 36.12</div><input id='attrs-8195cb48-290f-441b-91d2-e4361c8820b3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8195cb48-290f-441b-91d2-e4361c8820b3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a9e0c65a-2d65-42e1-9da9-929c980f1973' class='xr-var-data-in' type='checkbox'><label for='data-a9e0c65a-2d65-42e1-9da9-929c980f1973' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[ 61.754997 ,  48.460007 ,  56.254997 , ...,  34.914993 ,
        128.605    ,  39.789997 ],
       [ 33.805004 ,  48.525005 ,  66.63     , ...,  59.844997 ,
         17.035    ,  14.214999 ],
       [ 76.18     ,  83.445    , 124.39     , ..., 134.85002  ,
        138.14     ,  54.885006 ],
       ...,
       [ 65.60999  ,  61.174995 ,  52.545    , ..., 145.865    ,
        216.79999  , 101.57001  ],
       [ 19.959997 ,  13.834999 ,  24.715    , ...,   6.3799996,
         23.024998 ,  18.295    ],
       [ 86.55     ,  46.99     ,  50.364998 , ..., 106.560005 ,
        314.03     ,  36.125    ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Rain/No rain threshold</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>19.0 13.0 14.0 ... 14.0 24.0 6.0</div><input id='attrs-d3e52bc2-26f2-491d-88a0-e703cf60dbe8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d3e52bc2-26f2-491d-88a0-e703cf60dbe8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1cc31a6f-e439-42b9-8985-e9dcd2087b79' class='xr-var-data-in' type='checkbox'><label for='data-1cc31a6f-e439-42b9-8985-e9dcd2087b79' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[19., 13., 14., ..., 10., 22., 12.],
       [ 7., 11., 18., ..., 12.,  7.,  7.],
       [17., 19., 24., ..., 27., 20., 14.],
       ...,
       [12., 10., 10., ..., 17.,  9., 13.],
       [ 4.,  3.,  7., ...,  3.,  2.,  2.],
       [20., 12., 11., ..., 14., 24.,  6.]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg P with threshold</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>59.51 41.32 49.8 ... 311.0 34.08</div><input id='attrs-7546ea12-4ad5-4329-8bf8-bb4c61891517' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7546ea12-4ad5-4329-8bf8-bb4c61891517' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-12d85313-c7ab-4198-a242-4486d6a313f2' class='xr-var-data-in' type='checkbox'><label for='data-12d85313-c7ab-4198-a242-4486d6a313f2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 59.514996,  41.315002,  49.804996, ...,  30.27    , 127.24499 ,
         36.449997],
       [ 29.05    ,  44.085   ,  64.78999 , ...,  57.359993,  14.615   ,
         11.82    ],
       [ 71.659996,  80.395   , 120.06    , ..., 134.03001 , 136.68001 ,
         50.      ],
       ...,
       [ 64.41999 ,  58.48    ,  47.82    , ..., 143.55    , 213.485   ,
         98.515   ],
       [ 17.359999,  11.619999,  23.21    , ...,   4.87    ,  20.169998,
         16.865   ],
       [ 84.005005,  43.414997,  47.135   , ..., 100.665   , 311.04004 ,
         34.085   ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>precipitationQualityIndex</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>14.67 11.08 11.09 ... 14.72 21.55</div><input id='attrs-b5e7382a-3146-4d27-985e-7baa3e788837' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b5e7382a-3146-4d27-985e-7baa3e788837' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a12f9a4-3bc3-4070-9faa-74b797a2540d' class='xr-var-data-in' type='checkbox'><label for='data-6a12f9a4-3bc3-4070-9faa-74b797a2540d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>time: mean</dd><dt><span>DimensionNames :</span></dt><dd>time,lon,lat</dd><dt><span>CodeMissingValue :</span></dt><dd>-9999.9</dd><dt><span>LongName :</span></dt><dd>
Precipitation quality index; qualitative indicator
                        of skill based on the microwave-infrared merging process
</dd></dl></div><div class='xr-var-data'><pre>array([[14.668002, 11.084502, 11.089542, ..., 15.937544, 15.961377,
        12.925502],
       [15.026166, 10.777687, 11.586522, ..., 12.75475 , 15.077709,
        16.977041],
       [19.43294 , 19.294899, 16.174477, ..., 18.204771, 18.462687,
        19.59177 ],
       ...,
       [21.776356, 21.808395, 21.782747, ..., 21.665459, 21.638084,
        21.881166],
       [21.12352 , 21.200459, 21.257002, ..., 20.831831, 21.002878,
        21.27446 ],
       [17.258688, 19.723484, 17.640396, ..., 18.96827 , 14.722398,
        21.54519 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XGB</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>47.79 42.3 44.19 ... 162.9 57.14</div><input id='attrs-f38b5ab2-05b9-49d4-a41e-6471a1af74ec' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f38b5ab2-05b9-49d4-a41e-6471a1af74ec' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6dac116-caea-4dc8-b0d9-d49e883607b6' class='xr-var-data-in' type='checkbox'><label for='data-e6dac116-caea-4dc8-b0d9-d49e883607b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 47.794693 ,  42.29611  ,  44.191307 , ...,  56.852974 ,
         64.53296  ,  48.14416  ],
       [ 21.55823  ,  31.00933  ,  35.287457 , ...,  48.41534  ,
         15.7452755,  23.868858 ],
       [ 58.584694 ,  94.564926 , 110.47115  , ...,  98.080925 ,
         82.96169  ,  74.57795  ],
       ...,
       [113.104095 , 109.97232  ,  99.497635 , ..., 125.84559  ,
        121.77445  , 133.81023  ],
       [ 20.438658 ,  33.219494 ,  33.723793 , ...,  20.673952 ,
         21.485117 ,  32.969437 ],
       [ 54.53736  ,  51.04945  ,  51.529427 , ...,  82.53248  ,
        162.86865  ,  57.140717 ]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Z 100 percentile class</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.325e+03 2.108e+03 ... 1.302e+03</div><input id='attrs-8392de7b-3312-48b1-8a6a-351cf1d0d4f0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8392de7b-3312-48b1-8a6a-351cf1d0d4f0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0fdc5a89-4b89-4f7c-8a03-f6f8a54a21cc' class='xr-var-data-in' type='checkbox'><label for='data-0fdc5a89-4b89-4f7c-8a03-f6f8a54a21cc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>long_name :</span></dt><dd>z</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>vert_crs_name :</span></dt><dd>EGM2008</dd><dt><span>vert_crs_epsg :</span></dt><dd>EPSG:3855</dd></dl></div><div class='xr-var-data'><pre>array([[2325., 2108., 2201., ..., 2573., 2294., 1302.],
       [2100., 1904., 1988., ..., 2324., 2072., 1176.],
       [2325., 2108., 2201., ..., 2573., 2294., 1302.],
       ...,
       [2325., 2108., 2201., ..., 2573., 2294., 1302.],
       [2250., 2040., 2130., ..., 2490., 2220., 1260.],
       [2325., 2108., 2201., ..., 2573., 2294., 1302.]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>Imerg_orgres 100 percentile class</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.088e+03 1.986e+03 ... 1.621e+03</div><input id='attrs-2984b2bf-06dd-433a-9a2b-2ddb22daa28a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2984b2bf-06dd-433a-9a2b-2ddb22daa28a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c651915-f9b4-450b-ae82-438ba3182a92' class='xr-var-data-in' type='checkbox'><label for='data-4c651915-f9b4-450b-ae82-438ba3182a92' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[2088., 1986., 2036., ..., 1835., 2179., 1829.],
       [1589., 1736., 1904., ..., 1758., 1484., 1457.],
       [2107., 2141., 2372., ..., 2417., 2144., 1980.],
       ...,
       [1796., 1808., 1866., ..., 2087., 1843., 1956.],
       [1506., 1428., 1540., ..., 1387., 1438., 1382.],
       [2164., 1871., 1816., ..., 2061., 2482., 1621.]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5ada1c8e-f27a-40b4-91f1-c627cf3ebee3' class='xr-section-summary-in' type='checkbox'  ><label for='section-5ada1c8e-f27a-40b4-91f1-c627cf3ebee3' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c3381708-0400-45c4-8f7d-fe1f570dbe50' class='xr-index-data-in' type='checkbox'/><label for='index-c3381708-0400-45c4-8f7d-fe1f570dbe50' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2001-01-01&#x27;, &#x27;2001-02-01&#x27;, &#x27;2001-03-01&#x27;, &#x27;2001-04-01&#x27;,
               &#x27;2001-05-01&#x27;, &#x27;2001-06-01&#x27;, &#x27;2001-07-01&#x27;, &#x27;2001-08-01&#x27;,
               &#x27;2001-09-01&#x27;, &#x27;2001-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=240, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-776e7e59-a82f-4348-b00a-3336d949d497' class='xr-section-summary-in' type='checkbox'  checked><label for='section-776e7e59-a82f-4348-b00a-3336d949d497' class='xr-section-summary' >Attributes: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>history :</span></dt><dd>Thu Oct 03 16:35:16 2024: cdo remapnn,/mnt/c/Iman/Maxm/Imerg_grid.txt /mnt/c/Iman/Maxm/ERA5_before_NearestN/convective_available_potential_energy_daymax_2001.nc /mnt/c/Iman/Maxm/ERA5_NearestN/convective_available_potential_energy_daymax_2001_NearestN.nc
Sun Aug 04 14:09:21 2024: cdo -b F32 -daymax -selname,cape /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level/single_level_convective_available_potential_energy_2001.nc /leonardo_work/mBI23_AmbCo_1/igoudarz/ERA5_single_level_CDO/convective_available_potential_energy_daymax_2001.nc
2024-08-03 21:46:28 GMT by grib_to_netcdf-2.28.1: /opt/ecmwf/mars-client/bin/grib_to_netcdf -S param -o /cache/data0/adaptor.mars.internal-1722721563.4663277-31296-1-8733f443-6fe5-4260-83b2-9aa5b12398a5.nc /cache/tmp/8733f443-6fe5-4260-83b2-9aa5b12398a5-adaptor.mars.internal-1722720636.4191825-31296-1-tmp.grib</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
#Select Time
time_start='1995-01-01'   #'1960-01-01'   '1990-01-01'
time_end = '2000-12-31'   #'2020-12-31'   '2005-12-31'
########################################
plt.figure(figsize=(14, 4))

# Histalp Data (1960-2021) - Orange Solid Line
plt.plot(Histalp_df_long["Date"][(Histalp_df_long["Date"] > time_start) & (Histalp_df_long["Date"] < time_end)], Histalp_df_long["Value"][(Histalp_df_long["Date"] > time_start) & (Histalp_df_long["Date"] < time_end)], color='orange',
         linestyle='-', label='Histalp stations (Mean 50)')

# IMERG Data (2001-2021) - Green Dashed Line
plt.plot(era5_Imerg_filt_month_stations['time'].sel(time=slice(time_start, time_end)), era5_Imerg_filt_month_stations['Imerg_orgres'].sel(time=slice(time_start, time_end)).mean(dim='points'), 
         color='green', linestyle='-', label='IMERG closest stations (Mean 50)')

# ERA5 Data
# 1960-2000 (Blue Solid Line)
plt.plot(era5_backintime_filt_month_stations['time'].sel(time=slice(time_start, time_end)), era5_backintime_filt_month_stations['ppt_era5'].sel(time=slice(time_start, time_end)).mean(dim='points'), 
         color='blue', linestyle='-', label='ERA5 closest stations (Mean 50) (1960-2000)')

# 2001-2021 (Blue Dashed Line)
plt.plot(era5_Imerg_filt_month_stations['time'].sel(time=slice(time_start, time_end)), era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start, time_end)).mean(dim='points'), 
         color='blue', linestyle='-', label='ERA5 closest stations (Mean 50) (2001-2021)')

# XGB Data
# 1960-2000 (Purple Solid Line)
plt.plot(era5_backintime_filt_month_stations['time'].sel(time=slice(time_start, time_end)), era5_backintime_filt_month_stations['XGB'].sel(time=slice(time_start, time_end)).mean(dim='points'), 
         color='purple', linestyle='--', label='XGB closest stations (Mean 50) (1960-2000)')

# 2001-2021 (Purple Dashed Line)
plt.plot(era5_Imerg_filt_month_stations['time'].sel(time=slice(time_start, time_end)), era5_Imerg_filt_month_stations['XGB'].sel(time=slice(time_start, time_end)).mean(dim='points'),
         color='purple', linestyle='-', label='XGB closest stations (Mean 50) (2001-2021)')

# Formatting
plt.xlabel("Time (Year-Month)")
plt.ylabel("Precipitation (mm)")
plt.title("Monthly Data for Mean 50 Stations")

plt.legend(loc='upper left', fontsize=5)
plt.xticks(rotation=45)
plt.grid(True, linestyle='--', alpha=0.6)

# Show the plot
plt.show()
```


    
![png](output_87_0.png)
    


RMSE


```python
#Select Time
time_start='1960-01-01'  
time_end = '2000-12-31'   
######################
A= Histalp_df_long["Value"][(Histalp_df_long["Date"] >= time_start ) & (Histalp_df_long["Date"] < time_end)].values
A_df = Histalp_df_long[(Histalp_df_long["Date"] >= time_start) & (Histalp_df_long["Date"] < time_end)][['Date', 'Value']].rename(columns={'Value': 'A'})
B_df = era5_backintime_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='B').reset_index()
merged = pd.merge(A_df, B_df, left_on='Date', right_on='time', how='inner')
# Step 4: Compute RMSE
rmse_his_era5_1960_2000 = np.sqrt(np.nanmean((merged['A'] - merged['B']) ** 2))
r2_his_era5_1960_2000 = r2_score(merged['A'], merged['B'])
print('rmse_his_era5_1960_2000: ', rmse_his_era5_1960_2000)
print('r2_his_era5_1960_2000: ', r2_his_era5_1960_2000)
#####################################################################àà
A_df = Histalp_df_long[(Histalp_df_long["Date"] >= time_start) & (Histalp_df_long["Date"] < time_end)][['Date', 'Value']].rename(columns={'Value': 'A'})
B_df = era5_backintime_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='B').reset_index()
merged = pd.merge(A_df, B_df, left_on='Date', right_on='time', how='inner')
# Step 4: Compute RMSE
rmse_his_xgb_1960_2000 = np.sqrt(np.nanmean((merged['A'] - merged['B']) ** 2))
r2_his_xgb_1960_2000 = r2_score(merged['A'], merged['B'])
print('rmse_his_xgb_1960_2000: ', rmse_his_xgb_1960_2000)
print('r2_his_xgb_1960_2000: ', r2_his_xgb_1960_2000)
####################################################################################################################################
#Select Time
time_start='2001-01-01'  
time_end = '2020-12-31'  
######################
A= Histalp_df_long["Value"][(Histalp_df_long["Date"] >= time_start ) & (Histalp_df_long["Date"] < time_end)].values
A_df = Histalp_df_long[(Histalp_df_long["Date"] >= time_start) & (Histalp_df_long["Date"] < time_end)][['Date', 'Value']].rename(columns={'Value': 'A'})
B_df = era5_Imerg_filt_month_stations['Imerg_orgres'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='B').reset_index()
merged = pd.merge(A_df, B_df, left_on='Date', right_on='time', how='inner')
# Step 4: Compute RMSE
rmse_his_Imerg_2001_2020 = np.sqrt(np.nanmean((merged['A'] - merged['B']) ** 2))
r2_his_Imerg_2001_2020 = r2_score(merged['A'], merged['B'])
print('rmse_his_Imerg_2001_2020: ', rmse_his_Imerg_2001_2020)
print('r2_his_Imerg_2001_2020: ', r2_his_Imerg_2001_2020) 
##################################à
B_df = era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='B').reset_index()
merged = pd.merge(A_df, B_df, left_on='Date', right_on='time', how='inner')
# Step 4: Compute RMSE
rmse_his_era5_2001_2020 = np.sqrt(np.nanmean((merged['A'] - merged['B']) ** 2))
r2_his_era5_2001_2020 = r2_score(merged['A'], merged['B'])
print('rmse_his_era5_2001_2020: ', rmse_his_era5_2001_2020)
print('r2_his_era5_2001_2020: ', r2_his_era5_2001_2020) 

######################
B_df = era5_Imerg_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='B').reset_index()
merged = pd.merge(A_df, B_df, left_on='Date', right_on='time', how='inner')
# Step 4: Compute RMSE
rmse_his_xgb_2001_2020 = np.sqrt(np.nanmean((merged['A'] - merged['B']) ** 2))
r2_his_xgb_2001_2020 = r2_score(merged['A'], merged['B'])
print('rmse_his_xgb_2001_2020: ', rmse_his_xgb_2001_2020)
print('r2_his_xgb_2001_2020: ', r2_his_xgb_2001_2020) 
print('######################')
####################################################################################################################################
#Select Time
time_start='2001-01-01'  
time_end = '2020-12-31'   
######################
A= era5_Imerg_filt_month_stations['Imerg_orgres'].sel(time=slice(time_start , time_end)).mean(dim='points').values
B= era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim='points').values
rmse_Imerg_era5_2001_2020 = np.sqrt(np.nanmean((A - B) ** 2))
r2_Imerg_era5_2001_2020 = r2_score(A, B)
print('rmse_Imerg_era5_2001_2020:', rmse_Imerg_era5_2001_2020)
print('r2_Imerg_era5_2001_2020: ', r2_Imerg_era5_2001_2020)
######################
C= era5_Imerg_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim='points').values
rmse_Imerg_xgb_2001_2020 = np.sqrt(np.nanmean((A - C) ** 2))
r2_Imerg_xgb_2001_2020 = r2_score(A, C)
print('rmse_Imerg_xgb_2001_2020: ', rmse_Imerg_xgb_2001_2020)
print('r2_Imerg_xgb_2001_2020:', r2_Imerg_xgb_2001_2020)


```

    rmse_his_era5_1960_2000:  24.275770964395907
    r2_his_era5_1960_2000:  0.4312575330219022
    rmse_his_xgb_1960_2000:  11.576650004530048
    r2_his_xgb_1960_2000:  0.8706592420224717
    rmse_his_Imerg_2001_2020:  14.970956587395579
    r2_his_Imerg_2001_2020:  0.8177061438201121
    rmse_his_era5_2001_2020:  26.099822783547907
    r2_his_era5_2001_2020:  0.44595116379607147
    rmse_his_xgb_2001_2020:  14.549003475436303
    r2_his_xgb_2001_2020:  0.8278371572194081
    ######################
    rmse_Imerg_era5_2001_2020: 17.768024
    r2_Imerg_era5_2001_2020:  0.7466691732406616
    rmse_Imerg_xgb_2001_2020:  13.318814
    r2_Imerg_xgb_2001_2020: 0.85765540599823





    '\n#Select Time\ntime_start=\'1960-01-01\'  \ntime_end = \'2000-12-31\'   \n######################\nA= Histalp_df_long["Value"][(Histalp_df_long["Date"] >= time_start ) & (Histalp_df_long["Date"] < time_end)].values\nB= era5_backintime_filt_month_stations[\'ppt_era5\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_his_era5_1960_2000 = np.sqrt(np.nanmean((A - B) ** 2))\nr2_his_era5_1960_2000 = r2_score(A, B)\nprint(\'rmse_his_era5_1960_2000: \', rmse_his_era5_1960_2000)\nprint(\'r2_his_era5_1960_2000: \', r2_his_era5_1960_2000)\n######################\nC= era5_backintime_filt_month_stations[\'XGB\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_his_xgb_1960_2000 = np.sqrt(np.nanmean((A - C) ** 2))\nr2_his_xgb_1960_2000 = r2_score(A, C)\nprint(\'rmse_his_xgb_1960_2000: \', rmse_his_xgb_1960_2000)\nprint(\'r2_his_xgb_1960_2000: \', r2_his_xgb_1960_2000)\nprint(\'######################\')\n####################################################################################################################################\n#Select Time\ntime_start=\'2001-01-01\'  \ntime_end = \'2020-12-31\'   \n######################\nA= Histalp_df_long["Value"][(Histalp_df_long["Date"] >= time_start ) & (Histalp_df_long["Date"] < time_end)].values\nB= era5_Imerg_filt_month_stations[\'Imerg_orgres\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_his_Imerg_2001_2020 = np.sqrt(np.nanmean((A - B) ** 2))\nr2_his_Imerg_2001_2020 = r2_score(A, B)\nprint(\'rmse_his_Imerg_2001_2020:\' ,rmse_his_Imerg_2001_2020)\nprint(\'r2_his_Imerg_2001_2020: \', r2_his_Imerg_2001_2020)\n######################\nC= era5_Imerg_filt_month_stations[\'ppt_era5\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_his_era5_2001_2020 = np.sqrt(np.nanmean((A - C) ** 2))\nr2_his_era5_2001_2020 = r2_score(A, C)\nprint(\'rmse_his_era5_2001_2020: \', rmse_his_era5_2001_2020)\nprint(\'r2_his_era5_2001_2020 :\', r2_his_era5_2001_2020)\n######################\nD= era5_Imerg_filt_month_stations[\'XGB\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_his_xgb_2001_2020 = np.sqrt(np.nanmean((A - D) ** 2))\nr2_his_xgb_2001_2020 = r2_score(A, D)\nprint(\'rmse_his_xgb_2001_2020: \', rmse_his_xgb_2001_2020)\nprint(\'r2_his_xgb_2001_2020:\' , r2_his_xgb_2001_2020)\nprint(\'######################\')\n####################################################################################################################################\n#Select Time\ntime_start=\'2001-01-01\'  \ntime_end = \'2020-12-31\'   \n######################\nA= era5_Imerg_filt_month_stations[\'Imerg_orgres\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nB= era5_Imerg_filt_month_stations[\'ppt_era5\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_Imerg_era5_2001_2020 = np.sqrt(np.nanmean((A - B) ** 2))\nr2_Imerg_era5_2001_2020 = r2_score(A, B)\nprint(\'rmse_Imerg_era5_2001_2020:\', rmse_Imerg_era5_2001_2020)\nprint(\'r2_Imerg_era5_2001_2020: \', r2_Imerg_era5_2001_2020)\n######################\nC= era5_Imerg_filt_month_stations[\'XGB\'].sel(time=slice(time_start , time_end)).mean(dim=\'points\').values\nrmse_Imerg_xgb_2001_2020 = np.sqrt(np.nanmean((A - C) ** 2))\nr2_Imerg_xgb_2001_2020 = r2_score(A, C)\nprint(\'rmse_Imerg_xgb_2001_2020: \', rmse_Imerg_xgb_2001_2020)\nprint(\'r2_Imerg_xgb_2001_2020:\', r2_Imerg_xgb_2001_2020)\n'




```python
# Given RMSE values (replace with actual numbers)
rmse_values = [ rmse_his_era5_1960_2000,rmse_his_era5_2001_2020, rmse_his_xgb_1960_2000,rmse_his_xgb_2001_2020,rmse_his_Imerg_2001_2020,rmse_Imerg_era5_2001_2020,rmse_Imerg_xgb_2001_2020]
labels = [ 'Hist_Era5_1960_2000','Hist_Era5_2001_2020','Hist_XGB_1960_2000', 'Hist_XGB_2001_2020','Hist_Imerg_2001_2020','Imerg_Era5_2001_2020','Imerg_XGB_2001_2020' ]

# Create the plot
plt.figure(figsize=(5, 3))
plt.bar(labels, rmse_values, color=[ 'blue','blue', 'purple', 'purple','green','orange','grey'])
plt.ylabel('RMSE')
plt.title('RMSE Comparison')
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Add value labels above bars
for i, value in enumerate(rmse_values):
    plt.text(i, value + 0.02 * max(rmse_values), f'{value:.2f}', ha='center', fontsize=12)

plt.xticks(rotation=90)
# Show the plot
plt.show()
```


    
![png](output_90_0.png)
    



```python
# Given RMSE values (replace with actual numbers)
r2_values = [ r2_his_era5_1960_2000,r2_his_era5_2001_2020, r2_his_xgb_1960_2000,r2_his_xgb_2001_2020,r2_his_Imerg_2001_2020,r2_Imerg_era5_2001_2020,r2_Imerg_xgb_2001_2020]
labels = [ 'Hist_Era5_1960_2000','Hist_Era5_2001_2020','Hist_XGB_1960_2000', 'Hist_XGB_2001_2020','Hist_Imerg_2001_2020','Imerg_Era5_2001_2020','Imerg_XGB_2001_2020' ]

# Create the plot
plt.figure(figsize=(5, 3))
plt.bar(labels, r2_values, color=[ 'blue','blue', 'purple', 'purple','green','orange','grey'])
plt.ylabel('R2')
plt.title('R2 Comparison')
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Add value labels above bars
for i, value in enumerate(r2_values):
    plt.text(i, value + 0.02 * max(r2_values), f'{value:.2f}', ha='center', fontsize=12)

plt.xticks(rotation=90)
# Show the plot
plt.show()
```


    
![png](output_91_0.png)
    


Training On the HISTALP monthly Data


```python
#for the HISTALP (instead of IMERG) training


histalp['lat'] = histalp['lat'].round(6).astype(float)
histalp['lon'] = histalp['lon'].round(6).astype(float)
era5_Imerg['lat'] = era5_Imerg['lat'].round(6).astype(float)
era5_Imerg['lon'] = era5_Imerg['lon'].round(6).astype(float)
era5_backintime['lat'] = era5_backintime['lat'].round(6).astype(float)
era5_backintime['lon'] = era5_backintime['lon'].round(6).astype(float)
########################################################
# Keep only specified variables
internal1 = era5_backintime[['camr', 'tciw', 'ppt_era5']]
internal2 = era5_Imerg[['camr', 'tciw', 'ppt_era5']]
# Merge the datasets
era5_Imerg_totime = xr.merge([internal1, internal2])
#######################################################
# Sum for ppt_era5 over each month
tp_monthly_sum = era5_Imerg_totime['ppt_era5'].resample(time='1MS').sum()
# Mean for camr and tciw over each month
camr_monthly_mean = era5_Imerg_totime[['camr']].resample(time='1MS').max()
tciw_monthly_mean = era5_Imerg_totime[['tciw']].resample(time='1MS').mean()
# Merge the monthly-aggregated datasets
era5_totime_monthly = xr.merge([tp_monthly_sum, camr_monthly_mean, tciw_monthly_mean])

era5_totime_monthly

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 79MB
Dimensions:   (lon: 150, lat: 60, time: 732)
Coordinates:
  * lon       (lon) float64 1kB 4.05 4.15 4.25 4.35 ... 18.65 18.75 18.85 18.95
  * lat       (lat) float64 480B 43.05 43.15 43.25 43.35 ... 48.75 48.85 48.95
  * time      (time) datetime64[ns] 6kB 1960-01-01 1960-02-01 ... 2020-12-01
Data variables:
    ppt_era5  (time, lat, lon) float32 26MB 36.77 41.06 42.5 ... 62.89 66.94
    camr      (time, lat, lon) float32 26MB 0.002244 0.002248 ... 0.001905
    tciw      (time, lat, lon) float32 26MB 0.02416 0.02562 ... 0.02049 0.02105
Attributes:
    units:    mm</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b6d89cf8-e089-4a03-92f6-0cddd55c5852' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b6d89cf8-e089-4a03-92f6-0cddd55c5852' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>lon</span>: 150</li><li><span class='xr-has-index'>lat</span>: 60</li><li><span class='xr-has-index'>time</span>: 732</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-201e258a-b0d9-4aa8-b86e-1c21161ed20f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-201e258a-b0d9-4aa8-b86e-1c21161ed20f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.05 4.15 4.25 ... 18.85 18.95</div><input id='attrs-574be67a-baf5-406f-bae6-508de26bf384' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-574be67a-baf5-406f-bae6-508de26bf384' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-65cb66a3-9eae-4c61-bd4d-cc826988a9e7' class='xr-var-data-in' type='checkbox'><label for='data-65cb66a3-9eae-4c61-bd4d-cc826988a9e7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
        5.05,  5.15,  5.25,  5.35,  5.45,  5.55,  5.65,  5.75,  5.85,  5.95,
        6.05,  6.15,  6.25,  6.35,  6.45,  6.55,  6.65,  6.75,  6.85,  6.95,
        7.05,  7.15,  7.25,  7.35,  7.45,  7.55,  7.65,  7.75,  7.85,  7.95,
        8.05,  8.15,  8.25,  8.35,  8.45,  8.55,  8.65,  8.75,  8.85,  8.95,
        9.05,  9.15,  9.25,  9.35,  9.45,  9.55,  9.65,  9.75,  9.85,  9.95,
       10.05, 10.15, 10.25, 10.35, 10.45, 10.55, 10.65, 10.75, 10.85, 10.95,
       11.05, 11.15, 11.25, 11.35, 11.45, 11.55, 11.65, 11.75, 11.85, 11.95,
       12.05, 12.15, 12.25, 12.35, 12.45, 12.55, 12.65, 12.75, 12.85, 12.95,
       13.05, 13.15, 13.25, 13.35, 13.45, 13.55, 13.65, 13.75, 13.85, 13.95,
       14.05, 14.15, 14.25, 14.35, 14.45, 14.55, 14.65, 14.75, 14.85, 14.95,
       15.05, 15.15, 15.25, 15.35, 15.45, 15.55, 15.65, 15.75, 15.85, 15.95,
       16.05, 16.15, 16.25, 16.35, 16.45, 16.55, 16.65, 16.75, 16.85, 16.95,
       17.05, 17.15, 17.25, 17.35, 17.45, 17.55, 17.65, 17.75, 17.85, 17.95,
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>43.05 43.15 43.25 ... 48.85 48.95</div><input id='attrs-bd45ded9-cfad-4871-9987-1e05b98ad5b2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd45ded9-cfad-4871-9987-1e05b98ad5b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7a450950-5fab-4542-bfcb-0796f7407d45' class='xr-var-data-in' type='checkbox'><label for='data-7a450950-5fab-4542-bfcb-0796f7407d45' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01 ... 2020-12-01</div><input id='attrs-e0d947bf-83d9-4ec2-a330-46fd4f4bbc29' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e0d947bf-83d9-4ec2-a330-46fd4f4bbc29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d88b281a-f24a-4a1c-9c77-3d3cff9f08d0' class='xr-var-data-in' type='checkbox'><label for='data-d88b281a-f24a-4a1c-9c77-3d3cff9f08d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>valid_time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T00:00:00.000000000&#x27;, &#x27;1960-02-01T00:00:00.000000000&#x27;,
       &#x27;1960-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8a009855-67cf-4780-ae84-7c2c1e0d7c90' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8a009855-67cf-4780-ae84-7c2c1e0d7c90' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>36.77 41.06 42.5 ... 62.89 66.94</div><input id='attrs-3354bddc-3160-4bba-a9e2-d5d3779ea29c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3354bddc-3160-4bba-a9e2-d5d3779ea29c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb2c6778-6f31-4fc4-aa45-5f8c214ca041' class='xr-var-data-in' type='checkbox'><label for='data-cb2c6778-6f31-4fc4-aa45-5f8c214ca041' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[[ 36.766052 ,  41.063854 ,  42.496445 , ..., 160.52295  ,
         165.74084  , 181.39386  ],
        [ 39.597706 ,  44.626804 ,  46.303146 , ..., 138.03722  ,
         142.09933  , 154.28513  ],
        [ 40.542366 ,  45.815422 ,  47.57309  , ..., 130.53586  ,
         134.21239  , 145.24152  ],
        ...,
        [ 58.360577 ,  59.63785  ,  60.0636   , ...,  54.507492 ,
          54.809525 ,  55.71556  ],
        [ 58.482315 ,  59.59239  ,  59.96241  , ...,  55.269325 ,
          55.64573  ,  56.774895 ],
        [ 58.847904 ,  59.45587  ,  59.658527 , ...,  57.557106 ,
          58.156868 ,  59.956074 ]],

       [[ 22.197723 ,  25.32447  ,  26.36671  , ..., 226.23444  ,
         224.3547   , 218.71591  ],
        [ 24.516642 ,  27.957283 ,  29.104149 , ..., 176.42044  ,
         172.46544  , 160.60094  ],
        [ 25.29025  ,  28.8356   ,  30.017376 , ..., 159.80219  ,
         155.15486  , 141.21342  ],
...
        [ 22.546732 ,  24.852282 ,  25.620792 , ...,  27.647657 ,
          27.922918 ,  28.74866  ],
        [ 22.722898 ,  24.492191 ,  25.08195  , ...,  27.44816  ,
          27.87453  ,  29.153605 ],
        [ 23.25193  ,  23.410833 ,  23.4638   , ...,  26.849066 ,
          27.729239 ,  30.369635 ]],

       [[ 52.000336 ,  57.497726 ,  59.330166 , ..., 253.7806   ,
         256.49277  , 264.62894  ],
        [ 66.28138  ,  66.55671  ,  66.648476 , ..., 205.64987  ,
         207.07068  , 211.3329   ],
        [ 71.04565  ,  69.578835 ,  69.08992  , ..., 189.59319  ,
         190.58319  , 193.55302  ],
        ...,
        [142.40997  , 149.61942  , 152.02254  , ...,  65.60194  ,
          66.94079  ,  70.95716  ],
        [142.46248  , 148.15402  , 150.05115  , ...,  64.585915 ,
          65.92772  ,  69.95295  ],
        [142.62006  , 143.75334  , 144.13109  , ...,  61.53476  ,
          62.885445 ,  66.937325 ]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.002244 0.002248 ... 0.001905</div><input id='attrs-5943372f-cc39-4309-a734-e7ad8e2443ab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5943372f-cc39-4309-a734-e7ad8e2443ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9501c82-28a0-49ff-a8b9-ed907d6dd029' class='xr-var-data-in' type='checkbox'><label for='data-e9501c82-28a0-49ff-a8b9-ed907d6dd029' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[[0.00224435, 0.0022483 , 0.0022483 , ..., 0.00135121,
         0.00135121, 0.00128921],
        [0.00227141, 0.00227625, 0.00227625, ..., 0.00131523,
         0.00131523, 0.001258  ],
        [0.00227141, 0.00227625, 0.00227625, ..., 0.00131523,
         0.00131523, 0.001258  ],
        ...,
        [0.00200746, 0.00196317, 0.00196317, ..., 0.00142204,
         0.00142204, 0.00139365],
        [0.00200746, 0.00196317, 0.00196317, ..., 0.00142204,
         0.00142204, 0.00139365],
        [0.00201164, 0.00197114, 0.00197114, ..., 0.0013858 ,
         0.0013858 , 0.00134934]],

       [[0.00212912, 0.00215721, 0.00215721, ..., 0.00157007,
         0.00157007, 0.00151592],
        [0.00215834, 0.00219104, 0.00219104, ..., 0.00150681,
         0.00150681, 0.00145416],
        [0.00215834, 0.00219104, 0.00219104, ..., 0.00150681,
         0.00150681, 0.00145416],
...
        [0.00336604, 0.00337526, 0.00337526, ..., 0.00284597,
         0.00284597, 0.00278823],
        [0.00336604, 0.00337526, 0.00337526, ..., 0.00284597,
         0.00284597, 0.00278823],
        [0.0033306 , 0.00333665, 0.00333665, ..., 0.0028141 ,
         0.0028141 , 0.00274822]],

       [[0.00218183, 0.00222297, 0.00222297, ..., 0.00150474,
         0.00150474, 0.0014182 ],
        [0.00223685, 0.00227001, 0.00227001, ..., 0.0014624 ,
         0.0014624 , 0.00137846],
        [0.00223685, 0.00227001, 0.00227001, ..., 0.0014624 ,
         0.0014624 , 0.00137846],
        ...,
        [0.00262606, 0.00263556, 0.00263556, ..., 0.00198405,
         0.00198405, 0.00193339],
        [0.00262606, 0.00263556, 0.00263556, ..., 0.00198405,
         0.00198405, 0.00193339],
        [0.00260733, 0.00262226, 0.00262226, ..., 0.00196969,
         0.00196969, 0.00190493]]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, lat, lon)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.02416 0.02562 ... 0.02049 0.02105</div><input id='attrs-1c6525a4-9df1-4225-8c1b-d22dd899e5f8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1c6525a4-9df1-4225-8c1b-d22dd899e5f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ab8af1cf-4b17-4b76-9d77-d23f55ea8999' class='xr-var-data-in' type='checkbox'><label for='data-ab8af1cf-4b17-4b76-9d77-d23f55ea8999' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[[0.02416053, 0.02562406, 0.02562406, ..., 0.03237934,
         0.03237934, 0.03576845],
        [0.02327888, 0.02395216, 0.02395216, ..., 0.03108501,
         0.03108501, 0.03474902],
        [0.02327888, 0.02395216, 0.02395216, ..., 0.03108501,
         0.03108501, 0.03474902],
        ...,
        [0.02177675, 0.02136618, 0.02136618, ..., 0.0286775 ,
         0.0286775 , 0.02757607],
        [0.02177675, 0.02136618, 0.02136618, ..., 0.0286775 ,
         0.0286775 , 0.02757607],
        [0.02256648, 0.02236455, 0.02236455, ..., 0.02967449,
         0.02967449, 0.02964678]],

       [[0.02074532, 0.0211101 , 0.0211101 , ..., 0.04006913,
         0.04006913, 0.04076395],
        [0.02033622, 0.02127493, 0.02127493, ..., 0.03383616,
         0.03383616, 0.03474789],
        [0.02033622, 0.02127493, 0.02127493, ..., 0.03383616,
         0.03383616, 0.03474789],
...
        [0.01420318, 0.0139015 , 0.0139015 , ..., 0.01085507,
         0.01085507, 0.01089476],
        [0.01420318, 0.0139015 , 0.0139015 , ..., 0.01085507,
         0.01085507, 0.01089476],
        [0.0149162 , 0.01446559, 0.01446559, ..., 0.01101586,
         0.01101586, 0.01107267]],

       [[0.02718993, 0.02845371, 0.02845371, ..., 0.05018261,
         0.05018261, 0.05056543],
        [0.02851636, 0.02923658, 0.02923658, ..., 0.04074324,
         0.04074324, 0.04188308],
        [0.02851636, 0.02923658, 0.02923658, ..., 0.04074324,
         0.04074324, 0.04188308],
        ...,
        [0.04069034, 0.04198056, 0.04198056, ..., 0.02229543,
         0.02229543, 0.02315812],
        [0.04069034, 0.04198056, 0.04198056, ..., 0.02229543,
         0.02229543, 0.02315812],
        [0.04287422, 0.04409407, 0.04409407, ..., 0.02049006,
         0.02049006, 0.02105193]]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-591e4ef9-9559-401a-916c-b22ab33adcd5' class='xr-section-summary-in' type='checkbox'  ><label for='section-591e4ef9-9559-401a-916c-b22ab33adcd5' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lon</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d17d59c1-bf7d-4a0d-b893-dff286e4d046' class='xr-index-data-in' type='checkbox'/><label for='index-d17d59c1-bf7d-4a0d-b893-dff286e4d046' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([ 4.05,  4.15,  4.25,  4.35,  4.45,  4.55,  4.65,  4.75,  4.85,  4.95,
       ...
       18.05, 18.15, 18.25, 18.35, 18.45, 18.55, 18.65, 18.75, 18.85, 18.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lon&#x27;, length=150))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lat</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-065c523e-44a0-40b5-b4b0-d8735369ec63' class='xr-index-data-in' type='checkbox'/><label for='index-065c523e-44a0-40b5-b4b0-d8735369ec63' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([43.05, 43.15, 43.25, 43.35, 43.45, 43.55, 43.65, 43.75, 43.85, 43.95,
       44.05, 44.15, 44.25, 44.35, 44.45, 44.55, 44.65, 44.75, 44.85, 44.95,
       45.05, 45.15, 45.25, 45.35, 45.45, 45.55, 45.65, 45.75, 45.85, 45.95,
       46.05, 46.15, 46.25, 46.35, 46.45, 46.55, 46.65, 46.75, 46.85, 46.95,
       47.05, 47.15, 47.25, 47.35, 47.45, 47.55, 47.65, 47.75, 47.85, 47.95,
       48.05, 48.15, 48.25, 48.35, 48.45, 48.55, 48.65, 48.75, 48.85, 48.95],
      dtype=&#x27;float64&#x27;, name=&#x27;lat&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-26881743-26a5-46fa-96ea-724ca0465850' class='xr-index-data-in' type='checkbox'/><label for='index-26881743-26a5-46fa-96ea-724ca0465850' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01&#x27;, &#x27;1960-02-01&#x27;, &#x27;1960-03-01&#x27;, &#x27;1960-04-01&#x27;,
               &#x27;1960-05-01&#x27;, &#x27;1960-06-01&#x27;, &#x27;1960-07-01&#x27;, &#x27;1960-08-01&#x27;,
               &#x27;1960-09-01&#x27;, &#x27;1960-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=732, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e135eb59-e1f5-49e7-9d73-622ebe2a8db5' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e135eb59-e1f5-49e7-9d73-622ebe2a8db5' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div></li></ul></div></div>




```python
lat_points = xr.DataArray(Histalp_stations_df[['closest_Imerg_lat', 'closest_Imerg_lon']].drop_duplicates()['closest_Imerg_lat'].values, dims="points")
lon_points = xr.DataArray(Histalp_stations_df[['closest_Imerg_lat', 'closest_Imerg_lon']].drop_duplicates()['closest_Imerg_lon'].values, dims="points")

# Select only matching lat/lon pairs
era5_totime_monthly_stations = era5_totime_monthly.sel(lat=lat_points, lon=lon_points, method=None) # No nearest
era5_totime_monthly_stations

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 446kB
Dimensions:   (points: 50, time: 732)
Coordinates:
    lon       (points) float64 400B 15.25 14.55 13.85 ... 11.35 13.85 15.95
    lat       (points) float64 400B 47.45 48.45 48.65 ... 47.25 46.65 48.75
  * time      (time) datetime64[ns] 6kB 1960-01-01 1960-02-01 ... 2020-12-01
Dimensions without coordinates: points
Data variables:
    ppt_era5  (time, points) float32 146kB 65.92 63.96 68.69 ... 250.0 45.77
    camr      (time, points) float32 146kB 0.001191 0.001335 ... 0.00219
    tciw      (time, points) float32 146kB 0.03057 0.03453 ... 0.05927 0.03351
Attributes:
    units:    mm</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-037498a2-f3ab-4b2d-879a-e8694c279de1' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-037498a2-f3ab-4b2d-879a-e8694c279de1' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>points</span>: 50</li><li><span class='xr-has-index'>time</span>: 732</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-697ac641-f9b4-425b-92b7-a058496bd218' class='xr-section-summary-in' type='checkbox'  checked><label for='section-697ac641-f9b4-425b-92b7-a058496bd218' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.25 14.55 13.85 ... 13.85 15.95</div><input id='attrs-2747cade-5adb-4067-b7eb-d86cc43e02cb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2747cade-5adb-4067-b7eb-d86cc43e02cb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-587d0550-dabc-425a-bd17-8bda466a90b6' class='xr-var-data-in' type='checkbox'><label for='data-587d0550-dabc-425a-bd17-8bda466a90b6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([15.25, 14.55, 13.85, 10.55, 15.65, 16.35, 17.25,  9.15, 12.15,  9.95,
       17.65, 15.25, 17.45,  6.65,  8.45,  8.05,  9.15, 13.25, 11.55, 14.55,
       14.45, 15.25, 11.05, 11.65, 10.25,  7.65, 11.35, 16.65, 15.55,  9.15,
       12.15, 10.35, 15.85, 14.75, 13.85, 15.35, 12.65, 12.35, 13.05, 12.95,
       13.25, 10.15, 14.15, 12.85, 16.25,  9.75, 13.15, 11.35, 13.85, 15.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>47.45 48.45 48.65 ... 46.65 48.75</div><input id='attrs-63747de4-b201-44de-8fde-08ab91832615' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-63747de4-b201-44de-8fde-08ab91832615' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b57c55d7-bba8-4c70-9e4d-dc6df13fe1da' class='xr-var-data-in' type='checkbox'><label for='data-b57c55d7-bba8-4c70-9e4d-dc6df13fe1da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([47.45, 48.45, 48.65, 47.15, 48.15, 48.25, 44.35, 47.65, 48.55, 48.35,
       45.35, 44.15, 47.35, 45.05, 46.35, 43.95, 45.45, 46.05, 43.75, 46.05,
       47.55, 46.25, 45.85, 46.75, 47.45, 45.05, 46.55, 47.25, 45.45, 48.85,
       47.85, 44.85, 44.85, 47.95, 47.15, 47.75, 47.05, 45.45, 47.85, 47.25,
       46.95, 47.15, 48.05, 46.65, 47.45, 47.55, 46.95, 47.25, 46.65, 48.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01 ... 2020-12-01</div><input id='attrs-5f437ffe-9caf-4cdb-ad8b-434dabf6a620' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5f437ffe-9caf-4cdb-ad8b-434dabf6a620' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-afa588d3-562a-485d-9f66-c693cdcd3566' class='xr-var-data-in' type='checkbox'><label for='data-afa588d3-562a-485d-9f66-c693cdcd3566' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>valid_time_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T00:00:00.000000000&#x27;, &#x27;1960-02-01T00:00:00.000000000&#x27;,
       &#x27;1960-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-38a36033-0664-41d3-9422-37b292934b04' class='xr-section-summary-in' type='checkbox'  checked><label for='section-38a36033-0664-41d3-9422-37b292934b04' class='xr-section-summary' >Data variables: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>65.92 63.96 68.69 ... 250.0 45.77</div><input id='attrs-ab1618f9-52b7-4f54-8c7d-45f1ddd9d06a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ab1618f9-52b7-4f54-8c7d-45f1ddd9d06a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1ebb89ab-f0e2-40ca-9ead-de21a9df34d0' class='xr-var-data-in' type='checkbox'><label for='data-1ebb89ab-f0e2-40ca-9ead-de21a9df34d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[ 65.917496,  63.964607,  68.69246 , ...,  96.54773 ,  52.836037,
         34.47485 ],
       [ 40.644882,  43.577194,  65.418   , ...,  84.05532 ,  90.00667 ,
         20.415068],
       [119.71163 ,  96.61867 ,  75.93259 , ..., 131.23535 , 105.13157 ,
         81.00702 ],
       ...,
       [125.33153 ,  89.800705,  87.07151 , ..., 189.24315 , 143.9171  ,
         86.95248 ],
       [ 21.89741 ,  25.090475,  27.540035, ...,  34.52556 ,  19.983315,
         24.935768],
       [ 80.51436 ,  40.73421 ,  48.877247, ..., 157.24481 , 250.01329 ,
         45.769176]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001191 0.001335 ... 0.00219</div><input id='attrs-27abafed-018c-4220-956e-14c47e7310e6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-27abafed-018c-4220-956e-14c47e7310e6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02b50b74-bc67-4d35-81e9-cefcd68e0c35' class='xr-var-data-in' type='checkbox'><label for='data-02b50b74-bc67-4d35-81e9-cefcd68e0c35' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[0.00119073, 0.00133534, 0.001349  , ..., 0.00107445, 0.00124784,
        0.00141092],
       [0.00124127, 0.00141693, 0.00142621, ..., 0.00100702, 0.00117273,
        0.00131722],
       [0.00157116, 0.00160993, 0.00151111, ..., 0.00123752, 0.00140756,
        0.0017513 ],
       ...,
       [0.0024104 , 0.00253813, 0.00254615, ..., 0.00197569, 0.00234892,
        0.00273953],
       [0.00272308, 0.00308957, 0.00306843, ..., 0.00245345, 0.00229152,
        0.00317363],
       [0.00164231, 0.00197414, 0.00200449, ..., 0.00135975, 0.00153561,
        0.00218976]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.03057 0.03453 ... 0.05927 0.03351</div><input id='attrs-282a796d-2116-431d-9f75-51a3b4172119' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-282a796d-2116-431d-9f75-51a3b4172119' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bdc46bfc-d33e-4838-b187-b1b6b988df9a' class='xr-var-data-in' type='checkbox'><label for='data-bdc46bfc-d33e-4838-b187-b1b6b988df9a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[0.03057266, 0.03453384, 0.03351156, ..., 0.0391553 , 0.02856437,
        0.02856544],
       [0.02778996, 0.0307448 , 0.04013137, ..., 0.04824368, 0.02895344,
        0.022769  ],
       [0.03485563, 0.03342284, 0.03244188, ..., 0.0560413 , 0.03780513,
        0.02434212],
       ...,
       [0.0434829 , 0.04456761, 0.04140592, ..., 0.04752392, 0.0378547 ,
        0.0518298 ],
       [0.01191662, 0.01380919, 0.01370827, ..., 0.01442197, 0.00972888,
        0.01357218],
       [0.03370658, 0.03357987, 0.03287918, ..., 0.05328577, 0.05927466,
        0.03351054]], dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-cbd35845-3674-432d-8415-89a8057e1b8c' class='xr-section-summary-in' type='checkbox'  ><label for='section-cbd35845-3674-432d-8415-89a8057e1b8c' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d57e3f35-7dd0-48d7-b5e0-2228e1203f1d' class='xr-index-data-in' type='checkbox'/><label for='index-d57e3f35-7dd0-48d7-b5e0-2228e1203f1d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01&#x27;, &#x27;1960-02-01&#x27;, &#x27;1960-03-01&#x27;, &#x27;1960-04-01&#x27;,
               &#x27;1960-05-01&#x27;, &#x27;1960-06-01&#x27;, &#x27;1960-07-01&#x27;, &#x27;1960-08-01&#x27;,
               &#x27;1960-09-01&#x27;, &#x27;1960-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=732, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c0957fd3-15da-4b88-b7a6-70bddd154b55' class='xr-section-summary-in' type='checkbox'  checked><label for='section-c0957fd3-15da-4b88-b7a6-70bddd154b55' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div></li></ul></div></div>




```python
# Step 1: Convert Histalp to long format
df = Histalp_stations_df.copy()

# Create a 'month' and 'value' column
df_long = df.melt(
    id_vars=['Year', 'closest_Imerg_lat', 'closest_Imerg_lon'],
    value_vars=['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'],
    var_name='month',
    value_name='precip'
)

df_long
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
      <th>month</th>
      <th>precip</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>jan</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>jan</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>jan</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>jan</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>jan</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36595</th>
      <td>2016</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>dec</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>36596</th>
      <td>2017</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>dec</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>36597</th>
      <td>2018</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>dec</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>36598</th>
      <td>2019</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>dec</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>36599</th>
      <td>2020</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>dec</td>
      <td>27.0</td>
    </tr>
  </tbody>
</table>
<p>36600 rows × 5 columns</p>
</div>




```python
# Month mapping to integer
month_map = {'jan': 1, 'feb': 2, 'mar': 3, 'apr': 4, 'may': 5, 'jun': 6,
             'jul': 7, 'aug': 8, 'sep': 9, 'oct': 10, 'nov': 11, 'dec': 12}
df_long['month'] = df_long['month'].map(month_map)
df_long
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
      <th>month</th>
      <th>precip</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>18.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>33.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>29.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36595</th>
      <td>2016</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>36596</th>
      <td>2017</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>36597</th>
      <td>2018</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>36598</th>
      <td>2019</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>39.0</td>
    </tr>
    <tr>
      <th>36599</th>
      <td>2020</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>27.0</td>
    </tr>
  </tbody>
</table>
<p>36600 rows × 5 columns</p>
</div>




```python
# Create datetime
df_long['time'] = pd.to_datetime(dict(year=df_long['Year'], month=df_long['month'], day=1))
df_long
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
      <th>month</th>
      <th>precip</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>18.0</td>
      <td>1960-01-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>12.0</td>
      <td>1961-01-01</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>33.0</td>
      <td>1962-01-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>29.0</td>
      <td>1963-01-01</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>1</td>
      <td>0.0</td>
      <td>1964-01-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36595</th>
      <td>2016</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>14.0</td>
      <td>2016-12-01</td>
    </tr>
    <tr>
      <th>36596</th>
      <td>2017</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>15.0</td>
      <td>2017-12-01</td>
    </tr>
    <tr>
      <th>36597</th>
      <td>2018</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>32.0</td>
      <td>2018-12-01</td>
    </tr>
    <tr>
      <th>36598</th>
      <td>2019</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>39.0</td>
      <td>2019-12-01</td>
    </tr>
    <tr>
      <th>36599</th>
      <td>2020</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>12</td>
      <td>27.0</td>
      <td>2020-12-01</td>
    </tr>
  </tbody>
</table>
<p>36600 rows × 6 columns</p>
</div>




```python
df_long_NA=df_long[df_long['precip'].isna()]
df_long_NA
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
      <th>month</th>
      <th>precip</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>417</th>
      <td>2011</td>
      <td>44.35</td>
      <td>17.25</td>
      <td>1</td>
      <td>NaN</td>
      <td>2011-01-01</td>
    </tr>
    <tr>
      <th>418</th>
      <td>2012</td>
      <td>44.35</td>
      <td>17.25</td>
      <td>1</td>
      <td>NaN</td>
      <td>2012-01-01</td>
    </tr>
    <tr>
      <th>419</th>
      <td>2013</td>
      <td>44.35</td>
      <td>17.25</td>
      <td>1</td>
      <td>NaN</td>
      <td>2013-01-01</td>
    </tr>
    <tr>
      <th>420</th>
      <td>2014</td>
      <td>44.35</td>
      <td>17.25</td>
      <td>1</td>
      <td>NaN</td>
      <td>2014-01-01</td>
    </tr>
    <tr>
      <th>421</th>
      <td>2015</td>
      <td>44.35</td>
      <td>17.25</td>
      <td>1</td>
      <td>NaN</td>
      <td>2015-01-01</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>36412</th>
      <td>2016</td>
      <td>46.95</td>
      <td>13.15</td>
      <td>12</td>
      <td>NaN</td>
      <td>2016-12-01</td>
    </tr>
    <tr>
      <th>36413</th>
      <td>2017</td>
      <td>46.95</td>
      <td>13.15</td>
      <td>12</td>
      <td>NaN</td>
      <td>2017-12-01</td>
    </tr>
    <tr>
      <th>36414</th>
      <td>2018</td>
      <td>46.95</td>
      <td>13.15</td>
      <td>12</td>
      <td>NaN</td>
      <td>2018-12-01</td>
    </tr>
    <tr>
      <th>36415</th>
      <td>2019</td>
      <td>46.95</td>
      <td>13.15</td>
      <td>12</td>
      <td>NaN</td>
      <td>2019-12-01</td>
    </tr>
    <tr>
      <th>36416</th>
      <td>2020</td>
      <td>46.95</td>
      <td>13.15</td>
      <td>12</td>
      <td>NaN</td>
      <td>2020-12-01</td>
    </tr>
  </tbody>
</table>
<p>2508 rows × 6 columns</p>
</div>




```python
# Step 2: Group by station coordinate
grouped = df_long.groupby(['closest_Imerg_lat', 'closest_Imerg_lon'])

# Step 3: Create array to match shape of ERA5
era5_times = era5_totime_monthly_stations.time.values
points = len(era5_totime_monthly_stations.points)
histalp_values = np.full((len(era5_times), points), np.nan)

# Step 4: Match and fill values
for i in range(points):
    lat = float(era5_totime_monthly_stations.lat[i].values)
    lon = float(era5_totime_monthly_stations.lon[i].values)

    try:
        group = grouped.get_group((lat, lon))
        group = group.set_index('time').sort_index()
        # Align with ERA5 time
        group_aligned = group.reindex(era5_times)
        histalp_values[:, i] = group_aligned['precip'].values
    except KeyError:
        pass  # No matching station
```


```python
# Step 5: Add to xarray as new variable
histalp_da = xr.DataArray(
    data=histalp_values,
    dims=['time', 'points'],
    coords={'time': era5_times, 'points': era5_totime_monthly_stations.points},
    name='histalp_precipitation_monthly')

era5_totime_monthly_stations['histalp_precipitation_monthly'] = histalp_da
era5_totime_monthly_stations
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 739kB
Dimensions:                        (points: 50, time: 732)
Coordinates:
    lon                            (points) float64 400B 15.25 14.55 ... 15.95
    lat                            (points) float64 400B 47.45 48.45 ... 48.75
  * time                           (time) datetime64[ns] 6kB 1960-01-01 ... 2...
  * points                         (points) int64 400B 0 1 2 3 4 ... 46 47 48 49
Data variables:
    ppt_era5                       (time, points) float32 146kB 65.92 ... 45.77
    camr                           (time, points) float32 146kB 0.001191 ... ...
    tciw                           (time, points) float32 146kB 0.03057 ... 0...
    histalp_precipitation_monthly  (time, points) float64 293kB 18.0 ... 27.0
Attributes:
    units:    mm</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-42870948-6484-464d-94f6-de2a8f3ff079' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-42870948-6484-464d-94f6-de2a8f3ff079' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>points</span>: 50</li><li><span class='xr-has-index'>time</span>: 732</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-feace639-732c-49aa-879a-2b8300240de4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-feace639-732c-49aa-879a-2b8300240de4' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.25 14.55 13.85 ... 13.85 15.95</div><input id='attrs-cf879b12-3495-4fc4-8ff9-c40d2981869d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cf879b12-3495-4fc4-8ff9-c40d2981869d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9ec7b894-0c9f-4a81-be55-0296d1399236' class='xr-var-data-in' type='checkbox'><label for='data-9ec7b894-0c9f-4a81-be55-0296d1399236' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([15.25, 14.55, 13.85, 10.55, 15.65, 16.35, 17.25,  9.15, 12.15,  9.95,
       17.65, 15.25, 17.45,  6.65,  8.45,  8.05,  9.15, 13.25, 11.55, 14.55,
       14.45, 15.25, 11.05, 11.65, 10.25,  7.65, 11.35, 16.65, 15.55,  9.15,
       12.15, 10.35, 15.85, 14.75, 13.85, 15.35, 12.65, 12.35, 13.05, 12.95,
       13.25, 10.15, 14.15, 12.85, 16.25,  9.75, 13.15, 11.35, 13.85, 15.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>47.45 48.45 48.65 ... 46.65 48.75</div><input id='attrs-50b7fb3f-8b50-4bd6-82d5-8fccb8d5548c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-50b7fb3f-8b50-4bd6-82d5-8fccb8d5548c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f3146d2c-7592-47c5-93d0-6f258ae62525' class='xr-var-data-in' type='checkbox'><label for='data-f3146d2c-7592-47c5-93d0-6f258ae62525' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([47.45, 48.45, 48.65, 47.15, 48.15, 48.25, 44.35, 47.65, 48.55, 48.35,
       45.35, 44.15, 47.35, 45.05, 46.35, 43.95, 45.45, 46.05, 43.75, 46.05,
       47.55, 46.25, 45.85, 46.75, 47.45, 45.05, 46.55, 47.25, 45.45, 48.85,
       47.85, 44.85, 44.85, 47.95, 47.15, 47.75, 47.05, 45.45, 47.85, 47.25,
       46.95, 47.15, 48.05, 46.65, 47.45, 47.55, 46.95, 47.25, 46.65, 48.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01 ... 2020-12-01</div><input id='attrs-2cadab41-5207-4952-a902-07bc8c77a0c9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2cadab41-5207-4952-a902-07bc8c77a0c9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f551fbdd-aa8d-46ef-8fd1-8f70a0bbb5b8' class='xr-var-data-in' type='checkbox'><label for='data-f551fbdd-aa8d-46ef-8fd1-8f70a0bbb5b8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T00:00:00.000000000&#x27;, &#x27;1960-02-01T00:00:00.000000000&#x27;,
       &#x27;1960-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>points</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-89844e97-89ea-41d6-afb4-c20a9a07a2f5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-89844e97-89ea-41d6-afb4-c20a9a07a2f5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6de00c84-74f3-459a-a848-d199a0529b29' class='xr-var-data-in' type='checkbox'><label for='data-6de00c84-74f3-459a-a848-d199a0529b29' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49], dtype=int64)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5a05add9-2de1-40de-9560-105be64925f9' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5a05add9-2de1-40de-9560-105be64925f9' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>65.92 63.96 68.69 ... 250.0 45.77</div><input id='attrs-bd288913-509e-4fdb-bcf0-8c3fd51d87fe' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bd288913-509e-4fdb-bcf0-8c3fd51d87fe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73fc4513-85e3-4b0a-acd5-bb6c4c2087e5' class='xr-var-data-in' type='checkbox'><label for='data-73fc4513-85e3-4b0a-acd5-bb6c4c2087e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[ 65.917496,  63.964607,  68.69246 , ...,  96.54773 ,  52.836037,
         34.47485 ],
       [ 40.644882,  43.577194,  65.418   , ...,  84.05532 ,  90.00667 ,
         20.415068],
       [119.71163 ,  96.61867 ,  75.93259 , ..., 131.23535 , 105.13157 ,
         81.00702 ],
       ...,
       [125.33153 ,  89.800705,  87.07151 , ..., 189.24315 , 143.9171  ,
         86.95248 ],
       [ 21.89741 ,  25.090475,  27.540035, ...,  34.52556 ,  19.983315,
         24.935768],
       [ 80.51436 ,  40.73421 ,  48.877247, ..., 157.24481 , 250.01329 ,
         45.769176]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001191 0.001335 ... 0.00219</div><input id='attrs-c9c83564-850e-4d5f-8b8f-e3c8ec8b1952' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c9c83564-850e-4d5f-8b8f-e3c8ec8b1952' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-de761add-fec7-445e-b3e2-fbffbf281444' class='xr-var-data-in' type='checkbox'><label for='data-de761add-fec7-445e-b3e2-fbffbf281444' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[0.00119073, 0.00133534, 0.001349  , ..., 0.00107445, 0.00124784,
        0.00141092],
       [0.00124127, 0.00141693, 0.00142621, ..., 0.00100702, 0.00117273,
        0.00131722],
       [0.00157116, 0.00160993, 0.00151111, ..., 0.00123752, 0.00140756,
        0.0017513 ],
       ...,
       [0.0024104 , 0.00253813, 0.00254615, ..., 0.00197569, 0.00234892,
        0.00273953],
       [0.00272308, 0.00308957, 0.00306843, ..., 0.00245345, 0.00229152,
        0.00317363],
       [0.00164231, 0.00197414, 0.00200449, ..., 0.00135975, 0.00153561,
        0.00218976]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.03057 0.03453 ... 0.05927 0.03351</div><input id='attrs-de2fe3a3-42cf-4201-9d40-abae85da1178' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de2fe3a3-42cf-4201-9d40-abae85da1178' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0859f69-9e0d-4d78-889e-11cf62bcdee2' class='xr-var-data-in' type='checkbox'><label for='data-f0859f69-9e0d-4d78-889e-11cf62bcdee2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[0.03057266, 0.03453384, 0.03351156, ..., 0.0391553 , 0.02856437,
        0.02856544],
       [0.02778996, 0.0307448 , 0.04013137, ..., 0.04824368, 0.02895344,
        0.022769  ],
       [0.03485563, 0.03342284, 0.03244188, ..., 0.0560413 , 0.03780513,
        0.02434212],
       ...,
       [0.0434829 , 0.04456761, 0.04140592, ..., 0.04752392, 0.0378547 ,
        0.0518298 ],
       [0.01191662, 0.01380919, 0.01370827, ..., 0.01442197, 0.00972888,
        0.01357218],
       [0.03370658, 0.03357987, 0.03287918, ..., 0.05328577, 0.05927466,
        0.03351054]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>histalp_precipitation_monthly</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.0 39.0 68.0 ... 129.0 249.0 27.0</div><input id='attrs-92bf37c3-197f-4b08-82d8-81a78c8f441e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-92bf37c3-197f-4b08-82d8-81a78c8f441e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ca84c7b6-5470-4b4b-b26d-01698b0312cb' class='xr-var-data-in' type='checkbox'><label for='data-ca84c7b6-5470-4b4b-b26d-01698b0312cb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 18.,  39.,  68., ...,  37.,  41.,  18.],
       [ 17.,  28.,  63., ...,  32.,  69.,  12.],
       [ 43.,  72.,  77., ...,  69., 106.,  45.],
       ...,
       [ 96.,  57., 105., ...,  99., 172.,  70.],
       [  7.,  22.,  36., ...,  11.,  21.,  12.],
       [ 71.,  26.,  59., ..., 129., 249.,  27.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-d09e45f6-fe02-4170-a4cd-147d33d774c0' class='xr-section-summary-in' type='checkbox'  ><label for='section-d09e45f6-fe02-4170-a4cd-147d33d774c0' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-0493f459-b7af-4bfe-b3a1-4ae8b6a0943b' class='xr-index-data-in' type='checkbox'/><label for='index-0493f459-b7af-4bfe-b3a1-4ae8b6a0943b' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01&#x27;, &#x27;1960-02-01&#x27;, &#x27;1960-03-01&#x27;, &#x27;1960-04-01&#x27;,
               &#x27;1960-05-01&#x27;, &#x27;1960-06-01&#x27;, &#x27;1960-07-01&#x27;, &#x27;1960-08-01&#x27;,
               &#x27;1960-09-01&#x27;, &#x27;1960-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=732, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>points</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-131bc0f2-e87d-473c-85c9-9176388f9402' class='xr-index-data-in' type='checkbox'/><label for='index-131bc0f2-e87d-473c-85c9-9176388f9402' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(RangeIndex(start=0, stop=50, step=1, name=&#x27;points&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-31efce07-d7d0-42c8-bba8-331c5ae55a27' class='xr-section-summary-in' type='checkbox'  checked><label for='section-31efce07-d7d0-42c8-bba8-331c5ae55a27' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div></li></ul></div></div>




```python
#Dealing with 6percent of NA values

era5_totime_monthly_stations_clean = era5_totime_monthly_stations#.dropna(dim="time", subset=["histalp_precipitation_monthly"])

era5_totime_monthly_stations_clean
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 739kB
Dimensions:                        (points: 50, time: 732)
Coordinates:
    lon                            (points) float64 400B 15.25 14.55 ... 15.95
    lat                            (points) float64 400B 47.45 48.45 ... 48.75
  * time                           (time) datetime64[ns] 6kB 1960-01-01 ... 2...
  * points                         (points) int64 400B 0 1 2 3 4 ... 46 47 48 49
Data variables:
    ppt_era5                       (time, points) float32 146kB 65.92 ... 45.77
    camr                           (time, points) float32 146kB 0.001191 ... ...
    tciw                           (time, points) float32 146kB 0.03057 ... 0...
    histalp_precipitation_monthly  (time, points) float64 293kB 18.0 ... 27.0
Attributes:
    units:    mm</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-13ab9112-1132-4975-b911-fa945bae0388' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-13ab9112-1132-4975-b911-fa945bae0388' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>points</span>: 50</li><li><span class='xr-has-index'>time</span>: 732</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-b4129a3d-fa99-4990-9c88-069c0a1637d0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b4129a3d-fa99-4990-9c88-069c0a1637d0' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lon</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>15.25 14.55 13.85 ... 13.85 15.95</div><input id='attrs-0426cf18-0845-47e5-8a63-87f354effa6d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0426cf18-0845-47e5-8a63-87f354effa6d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-71b78976-a8b3-4ef7-8a71-e25c929e9f1f' class='xr-var-data-in' type='checkbox'><label for='data-71b78976-a8b3-4ef7-8a71-e25c929e9f1f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd></dl></div><div class='xr-var-data'><pre>array([15.25, 14.55, 13.85, 10.55, 15.65, 16.35, 17.25,  9.15, 12.15,  9.95,
       17.65, 15.25, 17.45,  6.65,  8.45,  8.05,  9.15, 13.25, 11.55, 14.55,
       14.45, 15.25, 11.05, 11.65, 10.25,  7.65, 11.35, 16.65, 15.55,  9.15,
       12.15, 10.35, 15.85, 14.75, 13.85, 15.35, 12.65, 12.35, 13.05, 12.95,
       13.25, 10.15, 14.15, 12.85, 16.25,  9.75, 13.15, 11.35, 13.85, 15.95])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lat</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>47.45 48.45 48.65 ... 46.65 48.75</div><input id='attrs-4291a662-541c-496c-b073-d98a2eb358de' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4291a662-541c-496c-b073-d98a2eb358de' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f0025cb6-72f2-40f4-a25d-4bb9553df743' class='xr-var-data-in' type='checkbox'><label for='data-f0025cb6-72f2-40f4-a25d-4bb9553df743' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd></dl></div><div class='xr-var-data'><pre>array([47.45, 48.45, 48.65, 47.15, 48.15, 48.25, 44.35, 47.65, 48.55, 48.35,
       45.35, 44.15, 47.35, 45.05, 46.35, 43.95, 45.45, 46.05, 43.75, 46.05,
       47.55, 46.25, 45.85, 46.75, 47.45, 45.05, 46.55, 47.25, 45.45, 48.85,
       47.85, 44.85, 44.85, 47.95, 47.15, 47.75, 47.05, 45.45, 47.85, 47.25,
       46.95, 47.15, 48.05, 46.65, 47.45, 47.55, 46.95, 47.25, 46.65, 48.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1960-01-01 ... 2020-12-01</div><input id='attrs-c793197d-40e7-47d1-8561-fd717df501a0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c793197d-40e7-47d1-8561-fd717df501a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7537fa8-a638-43ad-96e1-2ab10f521f8a' class='xr-var-data-in' type='checkbox'><label for='data-e7537fa8-a638-43ad-96e1-2ab10f521f8a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;1960-01-01T00:00:00.000000000&#x27;, &#x27;1960-02-01T00:00:00.000000000&#x27;,
       &#x27;1960-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>points</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 6 ... 44 45 46 47 48 49</div><input id='attrs-c1bd993f-82ad-41e6-ba38-bca2211edfa3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c1bd993f-82ad-41e6-ba38-bca2211edfa3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42eeb596-bb30-4c46-bdc0-59625e1127be' class='xr-var-data-in' type='checkbox'><label for='data-42eeb596-bb30-4c46-bdc0-59625e1127be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15, 16, 17,
       18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35,
       36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49], dtype=int64)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e60af06d-60a4-47d4-994d-58b02dd8ce30' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e60af06d-60a4-47d4-994d-58b02dd8ce30' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ppt_era5</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>65.92 63.96 68.69 ... 250.0 45.77</div><input id='attrs-2af209ec-744c-42ff-8be7-173efb1eb5c4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2af209ec-744c-42ff-8be7-173efb1eb5c4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c8822abc-bacc-4326-85cb-e82a85bcfff5' class='xr-var-data-in' type='checkbox'><label for='data-c8822abc-bacc-4326-85cb-e82a85bcfff5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div><div class='xr-var-data'><pre>array([[ 65.917496,  63.964607,  68.69246 , ...,  96.54773 ,  52.836037,
         34.47485 ],
       [ 40.644882,  43.577194,  65.418   , ...,  84.05532 ,  90.00667 ,
         20.415068],
       [119.71163 ,  96.61867 ,  75.93259 , ..., 131.23535 , 105.13157 ,
         81.00702 ],
       ...,
       [125.33153 ,  89.800705,  87.07151 , ..., 189.24315 , 143.9171  ,
         86.95248 ],
       [ 21.89741 ,  25.090475,  27.540035, ...,  34.52556 ,  19.983315,
         24.935768],
       [ 80.51436 ,  40.73421 ,  48.877247, ..., 157.24481 , 250.01329 ,
         45.769176]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>camr</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.001191 0.001335 ... 0.00219</div><input id='attrs-0990da12-25dc-43f8-aa82-6ad6c31a1bb1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-0990da12-25dc-43f8-aa82-6ad6c31a1bb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-408a526a-84e0-4691-93a4-f10ee76f8403' class='xr-var-data-in' type='checkbox'><label for='data-408a526a-84e0-4691-93a4-f10ee76f8403' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>array([[0.00119073, 0.00133534, 0.001349  , ..., 0.00107445, 0.00124784,
        0.00141092],
       [0.00124127, 0.00141693, 0.00142621, ..., 0.00100702, 0.00117273,
        0.00131722],
       [0.00157116, 0.00160993, 0.00151111, ..., 0.00123752, 0.00140756,
        0.0017513 ],
       ...,
       [0.0024104 , 0.00253813, 0.00254615, ..., 0.00197569, 0.00234892,
        0.00273953],
       [0.00272308, 0.00308957, 0.00306843, ..., 0.00245345, 0.00229152,
        0.00317363],
       [0.00164231, 0.00197414, 0.00200449, ..., 0.00135975, 0.00153561,
        0.00218976]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tciw</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.03057 0.03453 ... 0.05927 0.03351</div><input id='attrs-dbe1bbfb-944a-4cf3-b698-9c25db6fbf74' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dbe1bbfb-944a-4cf3-b698-9c25db6fbf74' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a69781e-ae21-46bb-afac-1d02d64eae0f' class='xr-var-data-in' type='checkbox'><label for='data-6a69781e-ae21-46bb-afac-1d02d64eae0f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>unknown</dd><dt><span>long_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>units :</span></dt><dd>kg m**-2</dd><dt><span>cell_methods :</span></dt><dd>valid_time: mean</dd><dt><span>GRIB_dataType :</span></dt><dd>an</dd><dt><span>GRIB_typeOfLevel :</span></dt><dd>surface</dd><dt><span>GRIB_stepType :</span></dt><dd>instant</dd><dt><span>GRIB_gridType :</span></dt><dd>regular_ll</dd><dt><span>GRIB_cfName :</span></dt><dd>unknown</dd><dt><span>GRIB_cfVarName :</span></dt><dd>tciw</dd><dt><span>GRIB_gridDefinitionDescription :</span></dt><dd>Latitude/Longitude Grid</dd><dt><span>GRIB_iDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_jDirectionIncrementInDegrees :</span></dt><dd>0.25</dd><dt><span>GRIB_latitudeOfFirstGridPointInDegrees :</span></dt><dd>49.0</dd><dt><span>GRIB_latitudeOfLastGridPointInDegrees :</span></dt><dd>43.0</dd><dt><span>GRIB_longitudeOfFirstGridPointInDegrees :</span></dt><dd>4.0</dd><dt><span>GRIB_longitudeOfLastGridPointInDegrees :</span></dt><dd>19.0</dd><dt><span>GRIB_missingValue :</span></dt><dd>3.4028234663852886e+38</dd><dt><span>GRIB_name :</span></dt><dd>Total column cloud ice water</dd><dt><span>GRIB_shortName :</span></dt><dd>tciw</dd><dt><span>GRIB_units :</span></dt><dd>kg m**-2</dd><dt><span>GRIB_surface :</span></dt><dd>0.0</dd></dl></div><div class='xr-var-data'><pre>array([[0.03057266, 0.03453384, 0.03351156, ..., 0.0391553 , 0.02856437,
        0.02856544],
       [0.02778996, 0.0307448 , 0.04013137, ..., 0.04824368, 0.02895344,
        0.022769  ],
       [0.03485563, 0.03342284, 0.03244188, ..., 0.0560413 , 0.03780513,
        0.02434212],
       ...,
       [0.0434829 , 0.04456761, 0.04140592, ..., 0.04752392, 0.0378547 ,
        0.0518298 ],
       [0.01191662, 0.01380919, 0.01370827, ..., 0.01442197, 0.00972888,
        0.01357218],
       [0.03370658, 0.03357987, 0.03287918, ..., 0.05328577, 0.05927466,
        0.03351054]], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>histalp_precipitation_monthly</span></div><div class='xr-var-dims'>(time, points)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>18.0 39.0 68.0 ... 129.0 249.0 27.0</div><input id='attrs-8027b1e7-edc7-4adf-8d06-a4d6a691800b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8027b1e7-edc7-4adf-8d06-a4d6a691800b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fef2b005-6283-46f9-8381-db58f3117c2e' class='xr-var-data-in' type='checkbox'><label for='data-fef2b005-6283-46f9-8381-db58f3117c2e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([[ 18.,  39.,  68., ...,  37.,  41.,  18.],
       [ 17.,  28.,  63., ...,  32.,  69.,  12.],
       [ 43.,  72.,  77., ...,  69., 106.,  45.],
       ...,
       [ 96.,  57., 105., ...,  99., 172.,  70.],
       [  7.,  22.,  36., ...,  11.,  21.,  12.],
       [ 71.,  26.,  59., ..., 129., 249.,  27.]])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-80a1d533-b9b6-453b-abfd-d7d8f05de60d' class='xr-section-summary-in' type='checkbox'  ><label for='section-80a1d533-b9b6-453b-abfd-d7d8f05de60d' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>time</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a2164467-bfda-43f8-9e9a-99d34edbd5f2' class='xr-index-data-in' type='checkbox'/><label for='index-a2164467-bfda-43f8-9e9a-99d34edbd5f2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1960-01-01&#x27;, &#x27;1960-02-01&#x27;, &#x27;1960-03-01&#x27;, &#x27;1960-04-01&#x27;,
               &#x27;1960-05-01&#x27;, &#x27;1960-06-01&#x27;, &#x27;1960-07-01&#x27;, &#x27;1960-08-01&#x27;,
               &#x27;1960-09-01&#x27;, &#x27;1960-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time&#x27;, length=732, freq=None))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>points</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-a5dfee30-83c4-4583-a51a-d7ca9890a4f4' class='xr-index-data-in' type='checkbox'/><label for='index-a5dfee30-83c4-4583-a51a-d7ca9890a4f4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(RangeIndex(start=0, stop=50, step=1, name=&#x27;points&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f40ede1c-7a8d-4586-b869-03a64d6921da' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f40ede1c-7a8d-4586-b869-03a64d6921da' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd></dl></div></li></ul></div></div>



CHAPPTERR


```python
file_list = [os.path.join(f"{path}/CHAPTER", f) for f in os.listdir(f"{path}/CHAPTER") if f.endswith('.nc')]
chapter = xr.open_mfdataset(file_list,combine='by_coords',chunks={'time': 1},parallel=True)
chapter=chapter.drop_vars('XTIME_bnds')

#removing 29th of Feb to have a same data for all years
chapter = chapter.sel(XTIME=~((chapter['XTIME'].dt.month == 2) & (chapter['XTIME'].dt.day == 29)))
chapter

```




    '\n#path = \'C:/Iman/Maxm\'\n#path = \'/leonardo_work/mBI23_AmbCo_1/igoudarz\'\n#path = \'/leonardo_work/mBI25_AmbCo/igoudarz\'\n\ndatasets = []\nfor year in range(1983, 2021): #2021   2001\n    # Open the dataset for the current year and append it to the list\n    ds = xr.open_dataset(f"{path}/CHAPTER/CUM_PREC_ACC_NC_{year}.nc", chunks={\'time\': 1}) #\n    ds = ds[\'PREC_ACC_NC\']\n    datasets.append(ds)\n    ds.close()\n\n# Combine all yearly datasets into a single xarray.Dataset\nchapter = xr.merge(datasets)\n'




```python
from geopy.distance import geodesic
################################################################################
def calculate_distance(lat1, lon1, lat2, lon2):
    return geodesic((lat1, lon1), (lat2, lon2)).km
```


```python
def find_closest_point_chapter(chapter, station_latitude, station_longitude):
    # Compute squared Euclidean distance (avoid sqrt for efficiency)
    dist = (chapter.XLAT.compute() - station_latitude) ** 2 + (chapter.XLONG.compute() - station_longitude) ** 2

    # Find the indices of the minimum distance
    min_index = np.unravel_index(dist.argmin(), dist.shape)
    i, j = min_index

    # Extract closest latitude and longitude
    closest_lat = chapter.XLAT.isel(south_north=i, west_east=j).compute().item()
    closest_lon = chapter.XLONG.isel(south_north=i, west_east=j).compute().item()

    return closest_lat, closest_lon  # Return float values
```


```python
chapter_month= chapter.resample(XTIME="1MS").sum()
# chapter_month = chapter_month.compute()
chapter_month
```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 165MB
Dimensions:      (XTIME: 456, south_north: 228, west_east: 396)
Coordinates:
    XLONG        (south_north, west_east) float32 361kB dask.array&lt;chunksize=(228, 396), meta=np.ndarray&gt;
    XLAT         (south_north, west_east) float32 361kB dask.array&lt;chunksize=(228, 396), meta=np.ndarray&gt;
  * XTIME        (XTIME) datetime64[ns] 4kB 1983-01-01 1983-02-01 ... 2020-12-01
Dimensions without coordinates: south_north, west_east
Data variables:
    PREC_ACC_NC  (XTIME, south_north, west_east) float32 165MB dask.array&lt;chunksize=(1, 228, 396), meta=np.ndarray&gt;
Attributes: (12/139)
    CDI:                             Climate Data Interface version 2.0.4 (ht...
    Conventions:                     CF-1.6
    TITLE:                            OUTPUT FROM WRF V4.1.1 MODEL
    START_DATE:                      1981-12-31_18:00:00
    SIMULATION_START_DATE:           1981-12-31_18:00:00
    WEST-EAST_GRID_DIMENSION:        1642
    ...                              ...
    HYBRID_OPT:                      2
    ETAC:                            0.2
    history:                         Fri Mar 07 11:41:21 2025: cdo -z zip_1 -...
    NCO:                             netCDF Operators version 4.9.3 (Homepage...
    frequency:                       day
    CDO:                             Climate Data Operators version 2.0.4 (ht...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-fb8e2e71-d834-43a0-a72b-2fc2d1651c8c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-fb8e2e71-d834-43a0-a72b-2fc2d1651c8c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>XTIME</span>: 456</li><li><span>south_north</span>: 228</li><li><span>west_east</span>: 396</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-1c7f11d4-f919-4876-9c68-e80cf338ebe0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1c7f11d4-f919-4876-9c68-e80cf338ebe0' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>XLONG</span></div><div class='xr-var-dims'>(south_north, west_east)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(228, 396), meta=np.ndarray&gt;</div><input id='attrs-d51073de-8334-4dd7-a0b1-32b8d101fa6e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d51073de-8334-4dd7-a0b1-32b8d101fa6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00024a5a-3084-4c78-a6bc-e84c2095326f' class='xr-var-data-in' type='checkbox'><label for='data-00024a5a-3084-4c78-a6bc-e84c2095326f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degree_east</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 352.69 kiB </td>
                        <td> 352.69 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (228, 396) </td>
                        <td> (228, 396) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 185 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="119" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="69" x2="120" y2="69" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="69" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="69" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,69.0909090909091 0.0,69.0909090909091" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="89.090909" font-size="1.0rem" font-weight="100" text-anchor="middle" >396</text>
  <text x="140.000000" y="34.545455" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,34.545455)">228</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XLAT</span></div><div class='xr-var-dims'>(south_north, west_east)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(228, 396), meta=np.ndarray&gt;</div><input id='attrs-ed527cba-5e9f-4aa2-9cf6-5961f9c6504b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ed527cba-5e9f-4aa2-9cf6-5961f9c6504b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7528bb3a-b10c-4922-bfa4-70e99c9d5016' class='xr-var-data-in' type='checkbox'><label for='data-7528bb3a-b10c-4922-bfa4-70e99c9d5016' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degree_north</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 352.69 kiB </td>
                        <td> 352.69 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (228, 396) </td>
                        <td> (228, 396) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 185 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="119" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="69" x2="120" y2="69" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="69" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="69" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,69.0909090909091 0.0,69.0909090909091" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="89.090909" font-size="1.0rem" font-weight="100" text-anchor="middle" >396</text>
  <text x="140.000000" y="34.545455" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,34.545455)">228</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>XTIME</span></div><div class='xr-var-dims'>(XTIME)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1983-01-01 ... 2020-12-01</div><input id='attrs-9d4f8ea5-31ff-43fe-a2ab-bfbe7f0e7e21' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-9d4f8ea5-31ff-43fe-a2ab-bfbe7f0e7e21' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f6a84e8-47c8-4581-b0bb-b68875c9229c' class='xr-var-data-in' type='checkbox'><label for='data-4f6a84e8-47c8-4581-b0bb-b68875c9229c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>XTIME_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1983-01-01T00:00:00.000000000&#x27;, &#x27;1983-02-01T00:00:00.000000000&#x27;,
       &#x27;1983-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-eed9a39b-c237-4755-86b9-21f373ce703f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-eed9a39b-c237-4755-86b9-21f373ce703f' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>PREC_ACC_NC</span></div><div class='xr-var-dims'>(XTIME, south_north, west_east)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 228, 396), meta=np.ndarray&gt;</div><input id='attrs-85ff2d33-298f-4cae-8a03-2345d6064133' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85ff2d33-298f-4cae-8a03-2345d6064133' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5117b7c3-0c5e-4c89-820e-beb1185c47b9' class='xr-var-data-in' type='checkbox'><label for='data-5117b7c3-0c5e-4c89-820e-beb1185c47b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>cell_methods :</span></dt><dd>XTIME: sum</dd><dt><span>FieldType :</span></dt><dd>104</dd><dt><span>MemoryOrder :</span></dt><dd>XY </dd><dt><span>description :</span></dt><dd>ACCUMULATED GRID SCALE  PRECIPITATION OVER prec_acc_dt PERIODS OF TIME</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 157.06 MiB </td>
                        <td> 352.69 kiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (456, 228, 396) </td>
                        <td> (1, 228, 396) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 456 chunks in 2818 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="234" height="180" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="10" y1="60" x2="80" y2="130" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="60" style="stroke-width:2" />
  <line x1="13" y1="3" x2="13" y2="63" />
  <line x1="17" y1="7" x2="17" y2="67" />
  <line x1="21" y1="11" x2="21" y2="71" />
  <line x1="24" y1="14" x2="24" y2="74" />
  <line x1="28" y1="18" x2="28" y2="78" />
  <line x1="32" y1="22" x2="32" y2="82" />
  <line x1="36" y1="26" x2="36" y2="86" />
  <line x1="39" y1="29" x2="39" y2="89" />
  <line x1="43" y1="33" x2="43" y2="93" />
  <line x1="47" y1="37" x2="47" y2="97" />
  <line x1="50" y1="40" x2="50" y2="100" />
  <line x1="54" y1="44" x2="54" y2="104" />
  <line x1="58" y1="48" x2="58" y2="108" />
  <line x1="62" y1="52" x2="62" y2="112" />
  <line x1="65" y1="55" x2="65" y2="115" />
  <line x1="69" y1="59" x2="69" y2="119" />
  <line x1="73" y1="63" x2="73" y2="123" />
  <line x1="76" y1="66" x2="76" y2="126" />
  <line x1="80" y1="70" x2="80" y2="130" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 80.58823529411765,70.58823529411765 80.58823529411765,130.58823529411765 10.0,60.0" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="114" y2="0" style="stroke-width:2" />
  <line x1="13" y1="3" x2="117" y2="3" />
  <line x1="17" y1="7" x2="121" y2="7" />
  <line x1="21" y1="11" x2="125" y2="11" />
  <line x1="24" y1="14" x2="129" y2="14" />
  <line x1="28" y1="18" x2="132" y2="18" />
  <line x1="32" y1="22" x2="136" y2="22" />
  <line x1="36" y1="26" x2="140" y2="26" />
  <line x1="39" y1="29" x2="143" y2="29" />
  <line x1="43" y1="33" x2="147" y2="33" />
  <line x1="47" y1="37" x2="151" y2="37" />
  <line x1="50" y1="40" x2="155" y2="40" />
  <line x1="54" y1="44" x2="158" y2="44" />
  <line x1="58" y1="48" x2="162" y2="48" />
  <line x1="62" y1="52" x2="166" y2="52" />
  <line x1="65" y1="55" x2="169" y2="55" />
  <line x1="69" y1="59" x2="173" y2="59" />
  <line x1="73" y1="63" x2="177" y2="63" />
  <line x1="76" y1="66" x2="181" y2="66" />
  <line x1="80" y1="70" x2="184" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="80" y2="70" style="stroke-width:2" />
  <line x1="114" y1="0" x2="184" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 114.21052631578947,0.0 184.7987616099071,70.58823529411765 80.58823529411765,70.58823529411765" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="80" y1="70" x2="184" y2="70" style="stroke-width:2" />
  <line x1="80" y1="130" x2="184" y2="130" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="80" y1="70" x2="80" y2="130" style="stroke-width:2" />
  <line x1="184" y1="70" x2="184" y2="130" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="80.58823529411765,70.58823529411765 184.7987616099071,70.58823529411765 184.7987616099071,130.58823529411765 80.58823529411765,130.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="132.693498" y="150.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >396</text>
  <text x="204.798762" y="100.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,204.798762,100.588235)">228</text>
  <text x="35.294118" y="115.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,35.294118,115.294118)">456</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-ed574da0-4489-4fc4-80fa-7c6bb19167ee' class='xr-section-summary-in' type='checkbox'  ><label for='section-ed574da0-4489-4fc4-80fa-7c6bb19167ee' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>XTIME</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-17ffdcb6-179c-4033-a625-0f328d3318c9' class='xr-index-data-in' type='checkbox'/><label for='index-17ffdcb6-179c-4033-a625-0f328d3318c9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1983-01-01&#x27;, &#x27;1983-02-01&#x27;, &#x27;1983-03-01&#x27;, &#x27;1983-04-01&#x27;,
               &#x27;1983-05-01&#x27;, &#x27;1983-06-01&#x27;, &#x27;1983-07-01&#x27;, &#x27;1983-08-01&#x27;,
               &#x27;1983-09-01&#x27;, &#x27;1983-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;XTIME&#x27;, length=456, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6ba2d329-4aca-4195-ad0c-c2ede33e9b77' class='xr-section-summary-in' type='checkbox'  ><label for='section-6ba2d329-4aca-4195-ad0c-c2ede33e9b77' class='xr-section-summary' >Attributes: <span>(139)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>TITLE :</span></dt><dd> OUTPUT FROM WRF V4.1.1 MODEL</dd><dt><span>START_DATE :</span></dt><dd>1981-12-31_18:00:00</dd><dt><span>SIMULATION_START_DATE :</span></dt><dd>1981-12-31_18:00:00</dd><dt><span>WEST-EAST_GRID_DIMENSION :</span></dt><dd>1642</dd><dt><span>SOUTH-NORTH_GRID_DIMENSION :</span></dt><dd>1354</dd><dt><span>BOTTOM-TOP_GRID_DIMENSION :</span></dt><dd>50</dd><dt><span>DX :</span></dt><dd>3000.0</dd><dt><span>DY :</span></dt><dd>3000.0</dd><dt><span>AERCU_OPT :</span></dt><dd>0</dd><dt><span>AERCU_FCT :</span></dt><dd>1.0</dd><dt><span>IDEAL_CASE :</span></dt><dd>0</dd><dt><span>DIFF_6TH_SLOPEOPT :</span></dt><dd>0</dd><dt><span>AUTO_LEVELS_OPT :</span></dt><dd>2</dd><dt><span>DIFF_6TH_THRESH :</span></dt><dd>0.1</dd><dt><span>DZBOT :</span></dt><dd>50.0</dd><dt><span>DZSTRETCH_S :</span></dt><dd>1.3</dd><dt><span>DZSTRETCH_U :</span></dt><dd>1.1</dd><dt><span>SKEBS_ON :</span></dt><dd>0</dd><dt><span>SPEC_BDY_FINAL_MU :</span></dt><dd>1</dd><dt><span>USE_Q_DIABATIC :</span></dt><dd>0</dd><dt><span>GRIDTYPE :</span></dt><dd>C</dd><dt><span>DIFF_OPT :</span></dt><dd>1</dd><dt><span>KM_OPT :</span></dt><dd>4</dd><dt><span>DAMP_OPT :</span></dt><dd>0</dd><dt><span>DAMPCOEF :</span></dt><dd>0.2</dd><dt><span>KHDIF :</span></dt><dd>0.0</dd><dt><span>KVDIF :</span></dt><dd>0.0</dd><dt><span>MP_PHYSICS :</span></dt><dd>6</dd><dt><span>RA_LW_PHYSICS :</span></dt><dd>4</dd><dt><span>RA_SW_PHYSICS :</span></dt><dd>4</dd><dt><span>SF_SFCLAY_PHYSICS :</span></dt><dd>1</dd><dt><span>SF_SURFACE_PHYSICS :</span></dt><dd>3</dd><dt><span>BL_PBL_PHYSICS :</span></dt><dd>1</dd><dt><span>CU_PHYSICS :</span></dt><dd>0</dd><dt><span>SF_LAKE_PHYSICS :</span></dt><dd>0</dd><dt><span>SURFACE_INPUT_SOURCE :</span></dt><dd>1</dd><dt><span>SST_UPDATE :</span></dt><dd>0</dd><dt><span>GRID_FDDA :</span></dt><dd>0</dd><dt><span>GFDDA_INTERVAL_M :</span></dt><dd>0</dd><dt><span>GFDDA_END_H :</span></dt><dd>0</dd><dt><span>GRID_SFDDA :</span></dt><dd>0</dd><dt><span>SGFDDA_INTERVAL_M :</span></dt><dd>0</dd><dt><span>SGFDDA_END_H :</span></dt><dd>0</dd><dt><span>HYPSOMETRIC_OPT :</span></dt><dd>2</dd><dt><span>USE_THETA_M :</span></dt><dd>1</dd><dt><span>GWD_OPT :</span></dt><dd>0</dd><dt><span>SF_URBAN_PHYSICS :</span></dt><dd>0</dd><dt><span>SF_SURFACE_MOSAIC :</span></dt><dd>0</dd><dt><span>SF_OCEAN_PHYSICS :</span></dt><dd>0</dd><dt><span>SHCU_PHYSICS :</span></dt><dd>0</dd><dt><span>MFSHCONV :</span></dt><dd>0</dd><dt><span>FEEDBACK :</span></dt><dd>1</dd><dt><span>SMOOTH_OPTION :</span></dt><dd>0</dd><dt><span>SWRAD_SCAT :</span></dt><dd>1.0</dd><dt><span>W_DAMPING :</span></dt><dd>0</dd><dt><span>DT :</span></dt><dd>21.0</dd><dt><span>ADAPT_DT_START :</span></dt><dd>12.0</dd><dt><span>ADAPT_DT_MAX :</span></dt><dd>21.0</dd><dt><span>ADAPT_DT_MIN :</span></dt><dd>6.0</dd><dt><span>RADT :</span></dt><dd>5.0</dd><dt><span>BLDT :</span></dt><dd>0.0</dd><dt><span>CUDT :</span></dt><dd>0.0</dd><dt><span>AER_OPT :</span></dt><dd>0</dd><dt><span>SWINT_OPT :</span></dt><dd>0</dd><dt><span>AER_TYPE :</span></dt><dd>1</dd><dt><span>AER_AOD550_OPT :</span></dt><dd>1</dd><dt><span>AER_ANGEXP_OPT :</span></dt><dd>1</dd><dt><span>AER_SSA_OPT :</span></dt><dd>1</dd><dt><span>AER_ASY_OPT :</span></dt><dd>1</dd><dt><span>AER_AOD550_VAL :</span></dt><dd>0.12</dd><dt><span>AER_ANGEXP_VAL :</span></dt><dd>1.3</dd><dt><span>AER_SSA_VAL :</span></dt><dd>0.85</dd><dt><span>AER_ASY_VAL :</span></dt><dd>0.9</dd><dt><span>MOIST_ADV_OPT :</span></dt><dd>1</dd><dt><span>SCALAR_ADV_OPT :</span></dt><dd>1</dd><dt><span>TKE_ADV_OPT :</span></dt><dd>1</dd><dt><span>DIFF_6TH_OPT :</span></dt><dd>2</dd><dt><span>DIFF_6TH_FACTOR :</span></dt><dd>0.12</dd><dt><span>TOPO_WIND :</span></dt><dd>1</dd><dt><span>OBS_NUDGE_OPT :</span></dt><dd>0</dd><dt><span>BUCKET_MM :</span></dt><dd>-1.0</dd><dt><span>BUCKET_J :</span></dt><dd>-1.0</dd><dt><span>PREC_ACC_DT :</span></dt><dd>60.0</dd><dt><span>ISFTCFLX :</span></dt><dd>0</dd><dt><span>ISHALLOW :</span></dt><dd>0</dd><dt><span>ISFFLX :</span></dt><dd>1</dd><dt><span>ICLOUD :</span></dt><dd>1</dd><dt><span>ICLOUD_CU :</span></dt><dd>0</dd><dt><span>TRACER_PBLMIX :</span></dt><dd>1</dd><dt><span>SCALAR_PBLMIX :</span></dt><dd>0</dd><dt><span>YSU_TOPDOWN_PBLMIX :</span></dt><dd>0</dd><dt><span>GRAV_SETTLING :</span></dt><dd>0</dd><dt><span>DFI_OPT :</span></dt><dd>0</dd><dt><span>SIMULATION_INITIALIZATION_TYPE :</span></dt><dd>REAL-DATA CASE</dd><dt><span>WEST-EAST_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>WEST-EAST_PATCH_END_UNSTAG :</span></dt><dd>1641</dd><dt><span>WEST-EAST_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>WEST-EAST_PATCH_END_STAG :</span></dt><dd>1642</dd><dt><span>SOUTH-NORTH_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>SOUTH-NORTH_PATCH_END_UNSTAG :</span></dt><dd>1353</dd><dt><span>SOUTH-NORTH_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>SOUTH-NORTH_PATCH_END_STAG :</span></dt><dd>1354</dd><dt><span>BOTTOM-TOP_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>BOTTOM-TOP_PATCH_END_UNSTAG :</span></dt><dd>49</dd><dt><span>BOTTOM-TOP_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>BOTTOM-TOP_PATCH_END_STAG :</span></dt><dd>50</dd><dt><span>GRID_ID :</span></dt><dd>2</dd><dt><span>PARENT_ID :</span></dt><dd>1</dd><dt><span>I_PARENT_START :</span></dt><dd>88</dd><dt><span>J_PARENT_START :</span></dt><dd>91</dd><dt><span>PARENT_GRID_RATIO :</span></dt><dd>3</dd><dt><span>CEN_LAT :</span></dt><dd>44.50888</dd><dt><span>CEN_LON :</span></dt><dd>11.141662</dd><dt><span>TRUELAT1 :</span></dt><dd>44.671</dd><dt><span>TRUELAT2 :</span></dt><dd>0.0</dd><dt><span>MOAD_CEN_LAT :</span></dt><dd>44.67099</dd><dt><span>STAND_LON :</span></dt><dd>10.914</dd><dt><span>POLE_LAT :</span></dt><dd>90.0</dd><dt><span>POLE_LON :</span></dt><dd>0.0</dd><dt><span>GMT :</span></dt><dd>18.0</dd><dt><span>JULYR :</span></dt><dd>1981</dd><dt><span>JULDAY :</span></dt><dd>365</dd><dt><span>MAP_PROJ :</span></dt><dd>3</dd><dt><span>MAP_PROJ_CHAR :</span></dt><dd>Mercator</dd><dt><span>MMINLU :</span></dt><dd>MODIFIED_IGBP_MODIS_NOAH</dd><dt><span>NUM_LAND_CAT :</span></dt><dd>21</dd><dt><span>ISWATER :</span></dt><dd>17</dd><dt><span>ISLAKE :</span></dt><dd>21</dd><dt><span>ISICE :</span></dt><dd>15</dd><dt><span>ISURBAN :</span></dt><dd>13</dd><dt><span>ISOILWATER :</span></dt><dd>14</dd><dt><span>HYBRID_OPT :</span></dt><dd>2</dd><dt><span>ETAC :</span></dt><dd>0.2</dd><dt><span>history :</span></dt><dd>Fri Mar 07 11:41:21 2025: cdo -z zip_1 -b F32 -daysum -selyear,1983 -cat /himalaya/CHAPTER/GAR/Hourly/PREC_ACC_NC_1982.nc /himalaya/CHAPTER/GAR/Hourly/PREC_ACC_NC_1983.nc /himalaya/CHAPTER/GAR/Daily_fix/CUM_PREC_ACC_NC_1983.nc
Mon Apr 15 11:47:46 2024: cdo -s -sellonlatbox,4,19,43,49 /home/locclima/data/CHAPTER/PREC_ACC_NC_1982.nc /home/locclima/data/CHAPTER/GAR/PREC_ACC_NC_1982.nc
Mon Apr 15 11:28:42 2024: cdo -s -O -z zip_1 -cat /home/locclima/data/CHAPTER/1982/1982*/PREC_ACC_NC* /home/locclima/data/CHAPTER/PREC_ACC_NC_1982.nc
Thu Mar 21 15:54:32 2024: ncrcat -v PREC_ACC_NC /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_01:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_02:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_03:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_04:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_05:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_06:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_07:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_08:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_09:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_10:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_11:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_12:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_13:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_14:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_15:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_16:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_17:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_18:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_19:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_20:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_21:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_22:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_23:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-02_00:00:00 /hppfs/scratch/07/di93suz/CHAPTER/Data/1982/1982010100/PREC_ACC_NC_1982010100.nc</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.9.3 (Homepage = http://nco.sf.net, Code = http://github.com/nco/nco)</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
#closest Grid point of era5_Imerg based on stations' positions
df_lon_lat= Histalp_stations_df[['latitude', 'longitude']].drop_duplicates()

# Loop through each row 
closest_latitudes = []
closest_longitudes = []

for index, row in tqdm(df_lon_lat.iterrows()):
    closest_lat, closest_lon = find_closest_point_chapter(chapter_month, row['latitude'], row['longitude'])
    closest_latitudes.append(closest_lat)
    closest_longitudes.append(closest_lon)

# Add the new columns to the DataFrame
df_lon_lat['closest_chapter_lat'] = closest_latitudes
df_lon_lat['closest_chapter_lon'] = closest_longitudes
#####################################################################################################
# Merge Histalp_stations_df with df_lon_lat on latitude and longitude
Histalp_stations_df = Histalp_stations_df.merge(
    df_lon_lat[['latitude', 'longitude', 'closest_chapter_lat', 'closest_chapter_lon']],
    on=['latitude', 'longitude'], 
    how='left'  # Use 'left' to keep all Histalp_stations_df rows
)

Histalp_stations_df
```

    50it [01:26,  1.73s/it]





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>jan</th>
      <th>feb</th>
      <th>mar</th>
      <th>apr</th>
      <th>may</th>
      <th>jun</th>
      <th>jul</th>
      <th>aug</th>
      <th>sep</th>
      <th>...</th>
      <th>nov</th>
      <th>dec</th>
      <th>longitude</th>
      <th>latitude</th>
      <th>height</th>
      <th>station</th>
      <th>closest_Imerg_lat</th>
      <th>closest_Imerg_lon</th>
      <th>closest_chapter_lat</th>
      <th>closest_chapter_lon</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960</td>
      <td>18.0</td>
      <td>17.0</td>
      <td>43.0</td>
      <td>16.0</td>
      <td>48.0</td>
      <td>95.0</td>
      <td>145.0</td>
      <td>135.0</td>
      <td>118.0</td>
      <td>...</td>
      <td>46.0</td>
      <td>86.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>47.409409</td>
      <td>15.239584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1961</td>
      <td>12.0</td>
      <td>48.0</td>
      <td>8.0</td>
      <td>38.0</td>
      <td>83.0</td>
      <td>51.0</td>
      <td>94.0</td>
      <td>91.0</td>
      <td>13.0</td>
      <td>...</td>
      <td>85.0</td>
      <td>53.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>47.409409</td>
      <td>15.239584</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1962</td>
      <td>33.0</td>
      <td>49.0</td>
      <td>29.0</td>
      <td>16.0</td>
      <td>106.0</td>
      <td>116.0</td>
      <td>92.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>...</td>
      <td>82.0</td>
      <td>37.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>47.409409</td>
      <td>15.239584</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1963</td>
      <td>29.0</td>
      <td>28.0</td>
      <td>62.0</td>
      <td>50.0</td>
      <td>98.0</td>
      <td>134.0</td>
      <td>93.0</td>
      <td>162.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>76.0</td>
      <td>30.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>47.409409</td>
      <td>15.239584</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1964</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>60.0</td>
      <td>42.0</td>
      <td>65.0</td>
      <td>96.0</td>
      <td>56.0</td>
      <td>79.0</td>
      <td>50.0</td>
      <td>...</td>
      <td>51.0</td>
      <td>54.0</td>
      <td>15.25</td>
      <td>47.405</td>
      <td>482.0</td>
      <td>Bruck/Mur</td>
      <td>47.45</td>
      <td>15.25</td>
      <td>47.409409</td>
      <td>15.239584</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>3045</th>
      <td>2016</td>
      <td>18.0</td>
      <td>51.0</td>
      <td>10.0</td>
      <td>41.0</td>
      <td>59.0</td>
      <td>94.0</td>
      <td>110.0</td>
      <td>53.0</td>
      <td>8.0</td>
      <td>...</td>
      <td>25.0</td>
      <td>14.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>48.752823</td>
      <td>15.960514</td>
    </tr>
    <tr>
      <th>3046</th>
      <td>2017</td>
      <td>13.0</td>
      <td>12.0</td>
      <td>20.0</td>
      <td>46.0</td>
      <td>25.0</td>
      <td>12.0</td>
      <td>53.0</td>
      <td>40.0</td>
      <td>69.0</td>
      <td>...</td>
      <td>34.0</td>
      <td>15.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>48.752823</td>
      <td>15.960514</td>
    </tr>
    <tr>
      <th>3047</th>
      <td>2018</td>
      <td>25.0</td>
      <td>20.0</td>
      <td>21.0</td>
      <td>9.0</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>28.0</td>
      <td>40.0</td>
      <td>78.0</td>
      <td>...</td>
      <td>23.0</td>
      <td>32.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>48.752823</td>
      <td>15.960514</td>
    </tr>
    <tr>
      <th>3048</th>
      <td>2019</td>
      <td>14.0</td>
      <td>8.0</td>
      <td>20.0</td>
      <td>18.0</td>
      <td>127.0</td>
      <td>29.0</td>
      <td>99.0</td>
      <td>104.0</td>
      <td>52.0</td>
      <td>...</td>
      <td>25.0</td>
      <td>39.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>48.752823</td>
      <td>15.960514</td>
    </tr>
    <tr>
      <th>3049</th>
      <td>2020</td>
      <td>13.0</td>
      <td>23.0</td>
      <td>20.0</td>
      <td>22.0</td>
      <td>54.0</td>
      <td>96.0</td>
      <td>67.0</td>
      <td>86.0</td>
      <td>84.0</td>
      <td>...</td>
      <td>12.0</td>
      <td>27.0</td>
      <td>15.95</td>
      <td>48.754</td>
      <td>256.0</td>
      <td>Retz</td>
      <td>48.75</td>
      <td>15.95</td>
      <td>48.752823</td>
      <td>15.960514</td>
    </tr>
  </tbody>
</table>
<p>3050 rows × 21 columns</p>
</div>




```python
import matplotlib.pyplot as plt
import cartopy.crs as ccrs
import cartopy.feature as cfeature

# Set up the map
fig = plt.figure(figsize=(10, 8))
ax = plt.axes(projection=ccrs.PlateCarree())

# Add map features
ax.add_feature(cfeature.COASTLINE)
ax.add_feature(cfeature.BORDERS, linestyle=':')
ax.add_feature(cfeature.LAND, facecolor='lightgray')
ax.add_feature(cfeature.OCEAN, facecolor='lightblue')
ax.add_feature(cfeature.LAKES, facecolor='lightblue')
ax.add_feature(cfeature.RIVERS)
ax.set_extent([4, 19, 43, 49], crs=ccrs.PlateCarree())



# Gridlines with larger font size and same color as title
title_color = '#000000'  # Title color
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, x_inline=False, y_inline=False, linewidth=0.33, color='k', alpha=0.5)
gl.right_labels = gl.top_labels = False
gl.xlabel_style = {'size': 15, 'color': title_color}
gl.ylabel_style = {'size': 15, 'color': title_color}
# label height
levels = np.arange(0, 3000, 500)
#ax = fig.add_subplot(projection=crs)
contour = ax.contour(era5_Imerg['lon'], era5_Imerg['lat'], era5_elev, levels, colors='k', linewidths=0.5)
ax.add_feature(cfeature.COASTLINE)



plt.title('Map of the study area between 4–19°E and 43–49°N', fontsize=20, fontweight='bold', color=title_color)
plt.show()

```


    
![png](output_108_0.png)
    



```python
#Map of Closest points 

Histalp_stations_lon= Histalp_stations_df['longitude'].values
Histalp_stations_lat= Histalp_stations_df['latitude'].values

closest_Imerg_lon= Histalp_stations_df['closest_Imerg_lon'].values
closest_Imerg_lat= Histalp_stations_df['closest_Imerg_lat'].values

closest_chapter_lon= Histalp_stations_df['closest_chapter_lon'].values
closest_chapter_lat= Histalp_stations_df['closest_chapter_lat'].values

era5_Imerg_lon=era5_Imerg.lon.values
era5_Imerg_lat=era5_Imerg.lat.values
##############################

import matplotlib.pyplot as plt
import cartopy.crs as ccrs
import cartopy.feature as cfeature

# Set up the map
fig = plt.figure(figsize=(10, 8))
ax = plt.axes(projection=ccrs.PlateCarree())

# Add map features
ax.add_feature(cfeature.COASTLINE)
ax.add_feature(cfeature.BORDERS, linestyle=':')
ax.add_feature(cfeature.LAND, facecolor='lightgray')
ax.add_feature(cfeature.OCEAN, facecolor='lightblue')
ax.add_feature(cfeature.LAKES, facecolor='lightblue')
#ax.add_feature(cfeature.RIVERS)
ax.set_extent([np.min(era5_Imerg_lon), np.max(era5_Imerg_lon), np.min(era5_Imerg_lat), np.max(era5_Imerg_lat)], crs=ccrs.PlateCarree())



# Gridlines with larger font size and same color as title
title_color = '#000000'  # Title color
gl = ax.gridlines(crs=ccrs.PlateCarree(), draw_labels=True, x_inline=False, y_inline=False, linewidth=0.33, color='k', alpha=0.5)
gl.right_labels = gl.top_labels = False
gl.xlabel_style = {'size': 15, 'color': title_color}
gl.ylabel_style = {'size': 15, 'color': title_color}
# label height
levels = np.arange(0, 3000, 500)
ax = fig.add_subplot(projection=crs)
contour = ax.contour(era5_Imerg['lon'], era5_Imerg['lat'], era5_elev, levels, colors='k', linewidths=0.5)
ax.add_feature(cfeature.COASTLINE)




# Plot each dataset
ax.scatter(Histalp_stations_lon, Histalp_stations_lat, color='red', marker='o',s=50, label='HISTALP Stations')
#ax.scatter(closest_Imerg_lon, closest_Imerg_lat, color='red', marker='x',s=50, label='Closest IMERG Points')
#ax.scatter(closest_chapter_lon, closest_chapter_lat, color='blue', marker='^',s=50, label='Closest CHAPTER Points')
#ax.scatter(era5_Imerg_lon, era5_Imerg_lat, color='green', marker='s', label='ERA5 IMERG Grid')

# Add a legend
plt.legend(loc='upper left')

# Add title
plt.title('', fontsize=20, fontweight='bold', color=title_color)


plt.show()

```


    
![png](output_109_0.png)
    



```python
# List to store the extracted precipitation values
all_chapter_month_stations = []

# Iterate over each unique closest_lat and closest_lon
for closest_lat, closest_lon in zip(lat_points, lon_points):
    # Compute squared distance
    dist = (chapter.XLAT.compute() - closest_lat) ** 2 + (chapter.XLONG.compute() - closest_lon) ** 2

    # Find the indices of the minimum distance
    i, j = np.unravel_index(dist.argmin(), dist.shape)

    # Extract the precipitation time series at the closest grid cell
    chapter_month_station = chapter_month.isel(south_north=i, west_east=j)

    # Store the extracted data along with coordinates
    all_chapter_month_stations.append(chapter_month_station)

# Combine results into a new xarray Dataset or DataArray if needed
chapter_month_stations = xr.concat(all_chapter_month_stations, dim="points")


#chapter_month_stations=chapter_month_stations.compute()


# Display the final dataset with all selected points
chapter_month_stations

```




<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
html[data-theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 0 20px 0 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: inline-block;
  opacity: 0;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:focus + label {
  border: 2px solid var(--xr-font-color0);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt; Size: 95kB
Dimensions:      (points: 50, XTIME: 456)
Coordinates:
    XLONG        (points) float32 200B dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;
    XLAT         (points) float32 200B dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;
  * XTIME        (XTIME) datetime64[ns] 4kB 1983-01-01 1983-02-01 ... 2020-12-01
Dimensions without coordinates: points
Data variables:
    PREC_ACC_NC  (points, XTIME) float32 91kB dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;
Attributes: (12/139)
    CDI:                             Climate Data Interface version 2.0.4 (ht...
    Conventions:                     CF-1.6
    TITLE:                            OUTPUT FROM WRF V4.1.1 MODEL
    START_DATE:                      1981-12-31_18:00:00
    SIMULATION_START_DATE:           1981-12-31_18:00:00
    WEST-EAST_GRID_DIMENSION:        1642
    ...                              ...
    HYBRID_OPT:                      2
    ETAC:                            0.2
    history:                         Fri Mar 07 11:41:21 2025: cdo -z zip_1 -...
    NCO:                             netCDF Operators version 4.9.3 (Homepage...
    frequency:                       day
    CDO:                             Climate Data Operators version 2.0.4 (ht...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-28b72d84-b626-4b19-8706-a59f625483d5' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-28b72d84-b626-4b19-8706-a59f625483d5' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>points</span>: 50</li><li><span class='xr-has-index'>XTIME</span>: 456</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-db60d5fd-11b7-4861-9d38-dd9f37d14b94' class='xr-section-summary-in' type='checkbox'  checked><label for='section-db60d5fd-11b7-4861-9d38-dd9f37d14b94' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>XLONG</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;</div><input id='attrs-03f182ad-cc68-4110-aac5-9eea9a7f0e67' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-03f182ad-cc68-4110-aac5-9eea9a7f0e67' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-88badccb-efb8-492e-8a1e-9ddde4f879cd' class='xr-var-data-in' type='checkbox'><label for='data-88badccb-efb8-492e-8a1e-9ddde4f879cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degree_east</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lon</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 200 B </td>
                        <td> 4 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (50,) </td>
                        <td> (1,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 50 chunks in 284 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="4" y1="0" x2="4" y2="29" />
  <line x1="12" y1="0" x2="12" y2="29" />
  <line x1="16" y1="0" x2="16" y2="29" />
  <line x1="24" y1="0" x2="24" y2="29" />
  <line x1="31" y1="0" x2="31" y2="29" />
  <line x1="36" y1="0" x2="36" y2="29" />
  <line x1="43" y1="0" x2="43" y2="29" />
  <line x1="50" y1="0" x2="50" y2="29" />
  <line x1="55" y1="0" x2="55" y2="29" />
  <line x1="62" y1="0" x2="62" y2="29" />
  <line x1="67" y1="0" x2="67" y2="29" />
  <line x1="74" y1="0" x2="74" y2="29" />
  <line x1="81" y1="0" x2="81" y2="29" />
  <line x1="86" y1="0" x2="86" y2="29" />
  <line x1="93" y1="0" x2="93" y2="29" />
  <line x1="100" y1="0" x2="100" y2="29" />
  <line x1="105" y1="0" x2="105" y2="29" />
  <line x1="112" y1="0" x2="112" y2="29" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.030629010473877 0.0,29.030629010473877" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.030629" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="140.000000" y="14.515315" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.515315)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>XLAT</span></div><div class='xr-var-dims'>(points)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1,), meta=np.ndarray&gt;</div><input id='attrs-ff575158-a78f-4c90-8df6-1a81335a5835' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ff575158-a78f-4c90-8df6-1a81335a5835' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c810684-e363-4223-b683-e4b6002c7325' class='xr-var-data-in' type='checkbox'><label for='data-5c810684-e363-4223-b683-e4b6002c7325' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degree_north</dd><dt><span>_CoordinateAxisType :</span></dt><dd>Lat</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 200 B </td>
                        <td> 4 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (50,) </td>
                        <td> (1,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 50 chunks in 284 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="79" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="29" x2="120" y2="29" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="29" style="stroke-width:2" />
  <line x1="4" y1="0" x2="4" y2="29" />
  <line x1="12" y1="0" x2="12" y2="29" />
  <line x1="16" y1="0" x2="16" y2="29" />
  <line x1="24" y1="0" x2="24" y2="29" />
  <line x1="31" y1="0" x2="31" y2="29" />
  <line x1="36" y1="0" x2="36" y2="29" />
  <line x1="43" y1="0" x2="43" y2="29" />
  <line x1="50" y1="0" x2="50" y2="29" />
  <line x1="55" y1="0" x2="55" y2="29" />
  <line x1="62" y1="0" x2="62" y2="29" />
  <line x1="67" y1="0" x2="67" y2="29" />
  <line x1="74" y1="0" x2="74" y2="29" />
  <line x1="81" y1="0" x2="81" y2="29" />
  <line x1="86" y1="0" x2="86" y2="29" />
  <line x1="93" y1="0" x2="93" y2="29" />
  <line x1="100" y1="0" x2="100" y2="29" />
  <line x1="105" y1="0" x2="105" y2="29" />
  <line x1="112" y1="0" x2="112" y2="29" />
  <line x1="120" y1="0" x2="120" y2="29" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,29.030629010473877 0.0,29.030629010473877" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="49.030629" font-size="1.0rem" font-weight="100" text-anchor="middle" >50</text>
  <text x="140.000000" y="14.515315" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,14.515315)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>XTIME</span></div><div class='xr-var-dims'>(XTIME)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>1983-01-01 ... 2020-12-01</div><input id='attrs-f4ba30d1-a2c7-4558-9b2a-d40b3ac87282' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f4ba30d1-a2c7-4558-9b2a-d40b3ac87282' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ce7dbed1-5e09-4088-9e74-0cd588b68c49' class='xr-var-data-in' type='checkbox'><label for='data-ce7dbed1-5e09-4088-9e74-0cd588b68c49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>bounds :</span></dt><dd>XTIME_bnds</dd><dt><span>axis :</span></dt><dd>T</dd></dl></div><div class='xr-var-data'><pre>array([&#x27;1983-01-01T00:00:00.000000000&#x27;, &#x27;1983-02-01T00:00:00.000000000&#x27;,
       &#x27;1983-03-01T00:00:00.000000000&#x27;, ..., &#x27;2020-10-01T00:00:00.000000000&#x27;,
       &#x27;2020-11-01T00:00:00.000000000&#x27;, &#x27;2020-12-01T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-af043cf5-a873-479d-8ed6-f5f1c9a827f2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-af043cf5-a873-479d-8ed6-f5f1c9a827f2' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>PREC_ACC_NC</span></div><div class='xr-var-dims'>(points, XTIME)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(1, 1), meta=np.ndarray&gt;</div><input id='attrs-afdede04-9e77-479f-8f3d-7a0cc1d925ea' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-afdede04-9e77-479f-8f3d-7a0cc1d925ea' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc4dbcf7-b4c6-4b1e-8d40-ce09bbe86ad6' class='xr-var-data-in' type='checkbox'><label for='data-bc4dbcf7-b4c6-4b1e-8d40-ce09bbe86ad6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm</dd><dt><span>cell_methods :</span></dt><dd>XTIME: sum</dd><dt><span>FieldType :</span></dt><dd>104</dd><dt><span>MemoryOrder :</span></dt><dd>XY </dd><dt><span>description :</span></dt><dd>ACCUMULATED GRID SCALE  PRECIPITATION OVER prec_acc_dt PERIODS OF TIME</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 89.06 kiB </td>
                        <td> 4 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (50, 456) </td>
                        <td> (1, 1) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 22800 chunks in 2919 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="89" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="1" x2="120" y2="1" />
  <line x1="0" y1="3" x2="120" y2="3" />
  <line x1="0" y1="5" x2="120" y2="5" />
  <line x1="0" y1="7" x2="120" y2="7" />
  <line x1="0" y1="10" x2="120" y2="10" />
  <line x1="0" y1="11" x2="120" y2="11" />
  <line x1="0" y1="14" x2="120" y2="14" />
  <line x1="0" y1="16" x2="120" y2="16" />
  <line x1="0" y1="17" x2="120" y2="17" />
  <line x1="0" y1="20" x2="120" y2="20" />
  <line x1="0" y1="21" x2="120" y2="21" />
  <line x1="0" y1="24" x2="120" y2="24" />
  <line x1="0" y1="26" x2="120" y2="26" />
  <line x1="0" y1="28" x2="120" y2="28" />
  <line x1="0" y1="30" x2="120" y2="30" />
  <line x1="0" y1="32" x2="120" y2="32" />
  <line x1="0" y1="34" x2="120" y2="34" />
  <line x1="0" y1="36" x2="120" y2="36" />
  <line x1="0" y1="39" x2="120" y2="39" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="39" style="stroke-width:2" />
  <line x1="6" y1="0" x2="6" y2="39" />
  <line x1="12" y1="0" x2="12" y2="39" />
  <line x1="18" y1="0" x2="18" y2="39" />
  <line x1="25" y1="0" x2="25" y2="39" />
  <line x1="31" y1="0" x2="31" y2="39" />
  <line x1="37" y1="0" x2="37" y2="39" />
  <line x1="44" y1="0" x2="44" y2="39" />
  <line x1="50" y1="0" x2="50" y2="39" />
  <line x1="56" y1="0" x2="56" y2="39" />
  <line x1="63" y1="0" x2="63" y2="39" />
  <line x1="69" y1="0" x2="69" y2="39" />
  <line x1="75" y1="0" x2="75" y2="39" />
  <line x1="82" y1="0" x2="82" y2="39" />
  <line x1="88" y1="0" x2="88" y2="39" />
  <line x1="94" y1="0" x2="94" y2="39" />
  <line x1="101" y1="0" x2="101" y2="39" />
  <line x1="107" y1="0" x2="107" y2="39" />
  <line x1="113" y1="0" x2="113" y2="39" />
  <line x1="120" y1="0" x2="120" y2="39" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,39.10090422470905 0.0,39.10090422470905" style="fill:#8B4903A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="59.100904" font-size="1.0rem" font-weight="100" text-anchor="middle" >456</text>
  <text x="140.000000" y="19.550452" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,19.550452)">50</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-5a899655-d883-4be3-9bf1-3a189bd0a2ad' class='xr-section-summary-in' type='checkbox'  ><label for='section-5a899655-d883-4be3-9bf1-3a189bd0a2ad' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>XTIME</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e162d86a-902d-49e3-bcac-fd8f6817274c' class='xr-index-data-in' type='checkbox'/><label for='index-e162d86a-902d-49e3-bcac-fd8f6817274c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;1983-01-01&#x27;, &#x27;1983-02-01&#x27;, &#x27;1983-03-01&#x27;, &#x27;1983-04-01&#x27;,
               &#x27;1983-05-01&#x27;, &#x27;1983-06-01&#x27;, &#x27;1983-07-01&#x27;, &#x27;1983-08-01&#x27;,
               &#x27;1983-09-01&#x27;, &#x27;1983-10-01&#x27;,
               ...
               &#x27;2020-03-01&#x27;, &#x27;2020-04-01&#x27;, &#x27;2020-05-01&#x27;, &#x27;2020-06-01&#x27;,
               &#x27;2020-07-01&#x27;, &#x27;2020-08-01&#x27;, &#x27;2020-09-01&#x27;, &#x27;2020-10-01&#x27;,
               &#x27;2020-11-01&#x27;, &#x27;2020-12-01&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;XTIME&#x27;, length=456, freq=&#x27;MS&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-11dd9c03-e87c-4b1a-9853-7f992a0cbe11' class='xr-section-summary-in' type='checkbox'  ><label for='section-11dd9c03-e87c-4b1a-9853-7f992a0cbe11' class='xr-section-summary' >Attributes: <span>(139)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>CDI :</span></dt><dd>Climate Data Interface version 2.0.4 (https://mpimet.mpg.de/cdi)</dd><dt><span>Conventions :</span></dt><dd>CF-1.6</dd><dt><span>TITLE :</span></dt><dd> OUTPUT FROM WRF V4.1.1 MODEL</dd><dt><span>START_DATE :</span></dt><dd>1981-12-31_18:00:00</dd><dt><span>SIMULATION_START_DATE :</span></dt><dd>1981-12-31_18:00:00</dd><dt><span>WEST-EAST_GRID_DIMENSION :</span></dt><dd>1642</dd><dt><span>SOUTH-NORTH_GRID_DIMENSION :</span></dt><dd>1354</dd><dt><span>BOTTOM-TOP_GRID_DIMENSION :</span></dt><dd>50</dd><dt><span>DX :</span></dt><dd>3000.0</dd><dt><span>DY :</span></dt><dd>3000.0</dd><dt><span>AERCU_OPT :</span></dt><dd>0</dd><dt><span>AERCU_FCT :</span></dt><dd>1.0</dd><dt><span>IDEAL_CASE :</span></dt><dd>0</dd><dt><span>DIFF_6TH_SLOPEOPT :</span></dt><dd>0</dd><dt><span>AUTO_LEVELS_OPT :</span></dt><dd>2</dd><dt><span>DIFF_6TH_THRESH :</span></dt><dd>0.1</dd><dt><span>DZBOT :</span></dt><dd>50.0</dd><dt><span>DZSTRETCH_S :</span></dt><dd>1.3</dd><dt><span>DZSTRETCH_U :</span></dt><dd>1.1</dd><dt><span>SKEBS_ON :</span></dt><dd>0</dd><dt><span>SPEC_BDY_FINAL_MU :</span></dt><dd>1</dd><dt><span>USE_Q_DIABATIC :</span></dt><dd>0</dd><dt><span>GRIDTYPE :</span></dt><dd>C</dd><dt><span>DIFF_OPT :</span></dt><dd>1</dd><dt><span>KM_OPT :</span></dt><dd>4</dd><dt><span>DAMP_OPT :</span></dt><dd>0</dd><dt><span>DAMPCOEF :</span></dt><dd>0.2</dd><dt><span>KHDIF :</span></dt><dd>0.0</dd><dt><span>KVDIF :</span></dt><dd>0.0</dd><dt><span>MP_PHYSICS :</span></dt><dd>6</dd><dt><span>RA_LW_PHYSICS :</span></dt><dd>4</dd><dt><span>RA_SW_PHYSICS :</span></dt><dd>4</dd><dt><span>SF_SFCLAY_PHYSICS :</span></dt><dd>1</dd><dt><span>SF_SURFACE_PHYSICS :</span></dt><dd>3</dd><dt><span>BL_PBL_PHYSICS :</span></dt><dd>1</dd><dt><span>CU_PHYSICS :</span></dt><dd>0</dd><dt><span>SF_LAKE_PHYSICS :</span></dt><dd>0</dd><dt><span>SURFACE_INPUT_SOURCE :</span></dt><dd>1</dd><dt><span>SST_UPDATE :</span></dt><dd>0</dd><dt><span>GRID_FDDA :</span></dt><dd>0</dd><dt><span>GFDDA_INTERVAL_M :</span></dt><dd>0</dd><dt><span>GFDDA_END_H :</span></dt><dd>0</dd><dt><span>GRID_SFDDA :</span></dt><dd>0</dd><dt><span>SGFDDA_INTERVAL_M :</span></dt><dd>0</dd><dt><span>SGFDDA_END_H :</span></dt><dd>0</dd><dt><span>HYPSOMETRIC_OPT :</span></dt><dd>2</dd><dt><span>USE_THETA_M :</span></dt><dd>1</dd><dt><span>GWD_OPT :</span></dt><dd>0</dd><dt><span>SF_URBAN_PHYSICS :</span></dt><dd>0</dd><dt><span>SF_SURFACE_MOSAIC :</span></dt><dd>0</dd><dt><span>SF_OCEAN_PHYSICS :</span></dt><dd>0</dd><dt><span>SHCU_PHYSICS :</span></dt><dd>0</dd><dt><span>MFSHCONV :</span></dt><dd>0</dd><dt><span>FEEDBACK :</span></dt><dd>1</dd><dt><span>SMOOTH_OPTION :</span></dt><dd>0</dd><dt><span>SWRAD_SCAT :</span></dt><dd>1.0</dd><dt><span>W_DAMPING :</span></dt><dd>0</dd><dt><span>DT :</span></dt><dd>21.0</dd><dt><span>ADAPT_DT_START :</span></dt><dd>12.0</dd><dt><span>ADAPT_DT_MAX :</span></dt><dd>21.0</dd><dt><span>ADAPT_DT_MIN :</span></dt><dd>6.0</dd><dt><span>RADT :</span></dt><dd>5.0</dd><dt><span>BLDT :</span></dt><dd>0.0</dd><dt><span>CUDT :</span></dt><dd>0.0</dd><dt><span>AER_OPT :</span></dt><dd>0</dd><dt><span>SWINT_OPT :</span></dt><dd>0</dd><dt><span>AER_TYPE :</span></dt><dd>1</dd><dt><span>AER_AOD550_OPT :</span></dt><dd>1</dd><dt><span>AER_ANGEXP_OPT :</span></dt><dd>1</dd><dt><span>AER_SSA_OPT :</span></dt><dd>1</dd><dt><span>AER_ASY_OPT :</span></dt><dd>1</dd><dt><span>AER_AOD550_VAL :</span></dt><dd>0.12</dd><dt><span>AER_ANGEXP_VAL :</span></dt><dd>1.3</dd><dt><span>AER_SSA_VAL :</span></dt><dd>0.85</dd><dt><span>AER_ASY_VAL :</span></dt><dd>0.9</dd><dt><span>MOIST_ADV_OPT :</span></dt><dd>1</dd><dt><span>SCALAR_ADV_OPT :</span></dt><dd>1</dd><dt><span>TKE_ADV_OPT :</span></dt><dd>1</dd><dt><span>DIFF_6TH_OPT :</span></dt><dd>2</dd><dt><span>DIFF_6TH_FACTOR :</span></dt><dd>0.12</dd><dt><span>TOPO_WIND :</span></dt><dd>1</dd><dt><span>OBS_NUDGE_OPT :</span></dt><dd>0</dd><dt><span>BUCKET_MM :</span></dt><dd>-1.0</dd><dt><span>BUCKET_J :</span></dt><dd>-1.0</dd><dt><span>PREC_ACC_DT :</span></dt><dd>60.0</dd><dt><span>ISFTCFLX :</span></dt><dd>0</dd><dt><span>ISHALLOW :</span></dt><dd>0</dd><dt><span>ISFFLX :</span></dt><dd>1</dd><dt><span>ICLOUD :</span></dt><dd>1</dd><dt><span>ICLOUD_CU :</span></dt><dd>0</dd><dt><span>TRACER_PBLMIX :</span></dt><dd>1</dd><dt><span>SCALAR_PBLMIX :</span></dt><dd>0</dd><dt><span>YSU_TOPDOWN_PBLMIX :</span></dt><dd>0</dd><dt><span>GRAV_SETTLING :</span></dt><dd>0</dd><dt><span>DFI_OPT :</span></dt><dd>0</dd><dt><span>SIMULATION_INITIALIZATION_TYPE :</span></dt><dd>REAL-DATA CASE</dd><dt><span>WEST-EAST_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>WEST-EAST_PATCH_END_UNSTAG :</span></dt><dd>1641</dd><dt><span>WEST-EAST_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>WEST-EAST_PATCH_END_STAG :</span></dt><dd>1642</dd><dt><span>SOUTH-NORTH_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>SOUTH-NORTH_PATCH_END_UNSTAG :</span></dt><dd>1353</dd><dt><span>SOUTH-NORTH_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>SOUTH-NORTH_PATCH_END_STAG :</span></dt><dd>1354</dd><dt><span>BOTTOM-TOP_PATCH_START_UNSTAG :</span></dt><dd>1</dd><dt><span>BOTTOM-TOP_PATCH_END_UNSTAG :</span></dt><dd>49</dd><dt><span>BOTTOM-TOP_PATCH_START_STAG :</span></dt><dd>1</dd><dt><span>BOTTOM-TOP_PATCH_END_STAG :</span></dt><dd>50</dd><dt><span>GRID_ID :</span></dt><dd>2</dd><dt><span>PARENT_ID :</span></dt><dd>1</dd><dt><span>I_PARENT_START :</span></dt><dd>88</dd><dt><span>J_PARENT_START :</span></dt><dd>91</dd><dt><span>PARENT_GRID_RATIO :</span></dt><dd>3</dd><dt><span>CEN_LAT :</span></dt><dd>44.50888</dd><dt><span>CEN_LON :</span></dt><dd>11.141662</dd><dt><span>TRUELAT1 :</span></dt><dd>44.671</dd><dt><span>TRUELAT2 :</span></dt><dd>0.0</dd><dt><span>MOAD_CEN_LAT :</span></dt><dd>44.67099</dd><dt><span>STAND_LON :</span></dt><dd>10.914</dd><dt><span>POLE_LAT :</span></dt><dd>90.0</dd><dt><span>POLE_LON :</span></dt><dd>0.0</dd><dt><span>GMT :</span></dt><dd>18.0</dd><dt><span>JULYR :</span></dt><dd>1981</dd><dt><span>JULDAY :</span></dt><dd>365</dd><dt><span>MAP_PROJ :</span></dt><dd>3</dd><dt><span>MAP_PROJ_CHAR :</span></dt><dd>Mercator</dd><dt><span>MMINLU :</span></dt><dd>MODIFIED_IGBP_MODIS_NOAH</dd><dt><span>NUM_LAND_CAT :</span></dt><dd>21</dd><dt><span>ISWATER :</span></dt><dd>17</dd><dt><span>ISLAKE :</span></dt><dd>21</dd><dt><span>ISICE :</span></dt><dd>15</dd><dt><span>ISURBAN :</span></dt><dd>13</dd><dt><span>ISOILWATER :</span></dt><dd>14</dd><dt><span>HYBRID_OPT :</span></dt><dd>2</dd><dt><span>ETAC :</span></dt><dd>0.2</dd><dt><span>history :</span></dt><dd>Fri Mar 07 11:41:21 2025: cdo -z zip_1 -b F32 -daysum -selyear,1983 -cat /himalaya/CHAPTER/GAR/Hourly/PREC_ACC_NC_1982.nc /himalaya/CHAPTER/GAR/Hourly/PREC_ACC_NC_1983.nc /himalaya/CHAPTER/GAR/Daily_fix/CUM_PREC_ACC_NC_1983.nc
Mon Apr 15 11:47:46 2024: cdo -s -sellonlatbox,4,19,43,49 /home/locclima/data/CHAPTER/PREC_ACC_NC_1982.nc /home/locclima/data/CHAPTER/GAR/PREC_ACC_NC_1982.nc
Mon Apr 15 11:28:42 2024: cdo -s -O -z zip_1 -cat /home/locclima/data/CHAPTER/1982/1982*/PREC_ACC_NC* /home/locclima/data/CHAPTER/PREC_ACC_NC_1982.nc
Thu Mar 21 15:54:32 2024: ncrcat -v PREC_ACC_NC /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_01:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_02:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_03:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_04:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_05:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_06:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_07:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_08:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_09:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_10:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_11:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_12:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_13:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_14:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_15:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_16:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_17:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_18:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_19:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_20:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_21:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_22:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-01_23:00:00 /dss/dsafs01/0001/pn29co-dss-0000/CHAPTER_CORR/1981123118/wrfout_d02_1982-01-02_00:00:00 /hppfs/scratch/07/di93suz/CHAPTER/Data/1982/1982010100/PREC_ACC_NC_1982010100.nc</dd><dt><span>NCO :</span></dt><dd>netCDF Operators version 4.9.3 (Homepage = http://nco.sf.net, Code = http://github.com/nco/nco)</dd><dt><span>frequency :</span></dt><dd>day</dd><dt><span>CDO :</span></dt><dd>Climate Data Operators version 2.0.4 (https://mpimet.mpg.de/cdo)</dd></dl></div></li></ul></div></div>




```python
#Select Time
time_start='1960-01-01'   #'1960-01-01'   '1995-01-01'
time_end = '2020-12-31'   #'2020-12-31'   '2004-12-31'
########################################
plt.figure(figsize=(15, 5))

# Histalp Data (1960-2021) - Orange Solid Line
plt.plot(Histalp_df_long["Date"][(Histalp_df_long["Date"] > time_start) & (Histalp_df_long["Date"] < time_end)], Histalp_df_long["Value"][(Histalp_df_long["Date"] > time_start) & (Histalp_df_long["Date"] < time_end)], color='orange',
         linestyle='-', label='HISTALP')

# Formatting
plt.xlabel("Year", fontsize=20)
plt.ylabel("Monthly precipitation (mm)", fontsize=20)
plt.title("")

#plt.legend(loc='upper left', bbox_to_anchor=(1.01, 1), fontsize=15)
plt.xticks(rotation=45, fontsize=20)
plt.yticks(fontsize=20)
plt.grid(True, linestyle='--', alpha=0.6)

# Show the plot
plt.show()
```


    
![png](output_111_0.png)
    



```python
era5_Imerg_filt_month_stations
Era5_ts = era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='ERA5').reset_index()
Era5_ts
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>ERA5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2001-01-01</td>
      <td>94.098946</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2001-02-01</td>
      <td>68.526184</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2001-03-01</td>
      <td>147.995087</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2001-04-01</td>
      <td>122.538528</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2001-05-01</td>
      <td>85.522003</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>235</th>
      <td>2020-08-01</td>
      <td>180.058182</td>
    </tr>
    <tr>
      <th>236</th>
      <td>2020-09-01</td>
      <td>112.918396</td>
    </tr>
    <tr>
      <th>237</th>
      <td>2020-10-01</td>
      <td>155.090485</td>
    </tr>
    <tr>
      <th>238</th>
      <td>2020-11-01</td>
      <td>28.083494</td>
    </tr>
    <tr>
      <th>239</th>
      <td>2020-12-01</td>
      <td>144.147720</td>
    </tr>
  </tbody>
</table>
<p>240 rows × 2 columns</p>
</div>




```python
# Create DataFrames from the xarray DataArrays
Era5_ts1 = era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='ERA5').reset_index()
Era5_ts2 = era5_backintime_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='ERA5').reset_index()
merged = Era5_ts1.merge(Era5_ts2, on='time', how='outer', suffixes=('_present', '_backintime'))
merged['ERA5_filled'] = merged['ERA5_present'].fillna(merged['ERA5_backintime'])
Era5_ts = merged[['time', 'ERA5_filled']].rename(columns={'ERA5_filled': 'ERA5'})
Era5_ts

```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>time</th>
      <th>ERA5</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960-01-01</td>
      <td>77.524651</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1960-02-01</td>
      <td>81.314186</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1960-03-01</td>
      <td>115.792175</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1960-04-01</td>
      <td>82.311562</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1960-05-01</td>
      <td>80.283279</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>727</th>
      <td>2020-08-01</td>
      <td>180.058182</td>
    </tr>
    <tr>
      <th>728</th>
      <td>2020-09-01</td>
      <td>112.918396</td>
    </tr>
    <tr>
      <th>729</th>
      <td>2020-10-01</td>
      <td>155.090485</td>
    </tr>
    <tr>
      <th>730</th>
      <td>2020-11-01</td>
      <td>28.083494</td>
    </tr>
    <tr>
      <th>731</th>
      <td>2020-12-01</td>
      <td>144.147720</td>
    </tr>
  </tbody>
</table>
<p>732 rows × 2 columns</p>
</div>




```python
#Select Time
time_start='1960-01-01'  
time_end = '2020-12-31'   
######################
HISTALP_ts = Histalp_df_long[(Histalp_df_long["Date"] >= time_start) & (Histalp_df_long["Date"] < time_end)][['Date', 'Value']].rename(columns={'Value': 'HISTALP'})
XGB_ts = era5_backintime_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='XGB').reset_index()
CHAPTER_ts = chapter_month_stations['PREC_ACC_NC'].sel(XTIME=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='CHAPTER').reset_index()
#######
Era5_ts1 = era5_Imerg_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='ERA5').reset_index()
Era5_ts2 = era5_backintime_filt_month_stations['ppt_era5'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='ERA5').reset_index()
merged = Era5_ts1.merge(Era5_ts2, on='time', how='outer', suffixes=('_present', '_backintime'))
merged['ERA5_filled'] = merged['ERA5_present'].fillna(merged['ERA5_backintime'])
Era5_ts = merged[['time', 'ERA5_filled']].rename(columns={'ERA5_filled': 'ERA5'})
##############################
XGB_ts1 = era5_Imerg_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='XGB').reset_index()
XGB_ts2 = era5_backintime_filt_month_stations['XGB'].sel(time=slice(time_start , time_end)).mean(dim="points").to_dataframe(name='XGB').reset_index()
merged = XGB_ts1.merge(XGB_ts2, on='time', how='outer', suffixes=('_present', '_backintime'))
merged['XGB_filled'] = merged['XGB_present'].fillna(merged['XGB_backintime'])
XGB_ts = merged[['time', 'XGB_filled']].rename(columns={'XGB_filled': 'XGB'})
##############################
merged = pd.merge(HISTALP_ts, Era5_ts, left_on='Date', right_on='time', how='left')
merged = pd.merge(merged, XGB_ts, left_on='Date', right_on='time', how='left')
#merged = pd.merge(merged, CHAPTER_ts, left_on='Date', right_on='XTIME', how='inner')
merged = pd.merge(merged, CHAPTER_ts, left_on='Date', right_on='XTIME', how='left')


merged['Era5-HIS']=merged['ERA5']-merged['HISTALP']
merged['XGB-HIS']=merged['XGB']-merged['HISTALP']
merged['CHAPTER-HIS']=merged['CHAPTER']-merged['HISTALP']
merged
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date</th>
      <th>HISTALP</th>
      <th>time_x</th>
      <th>ERA5</th>
      <th>time_y</th>
      <th>XGB</th>
      <th>XTIME</th>
      <th>CHAPTER</th>
      <th>Era5-HIS</th>
      <th>XGB-HIS</th>
      <th>CHAPTER-HIS</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1960-01-01</td>
      <td>55.700000</td>
      <td>1960-01-01</td>
      <td>77.524651</td>
      <td>1960-01-01</td>
      <td>40.375744</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>21.824651</td>
      <td>-15.324256</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1960-02-01</td>
      <td>67.820000</td>
      <td>1960-02-01</td>
      <td>81.314186</td>
      <td>1960-02-01</td>
      <td>51.927666</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>13.494186</td>
      <td>-15.892334</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1960-03-01</td>
      <td>80.040000</td>
      <td>1960-03-01</td>
      <td>115.792175</td>
      <td>1960-03-01</td>
      <td>83.062637</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>35.752175</td>
      <td>3.022637</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1960-04-01</td>
      <td>48.840000</td>
      <td>1960-04-01</td>
      <td>82.311562</td>
      <td>1960-04-01</td>
      <td>51.833961</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>33.471562</td>
      <td>2.993961</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1960-05-01</td>
      <td>62.760000</td>
      <td>1960-05-01</td>
      <td>80.283279</td>
      <td>1960-05-01</td>
      <td>66.461266</td>
      <td>NaT</td>
      <td>NaN</td>
      <td>17.523279</td>
      <td>3.701266</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>727</th>
      <td>2020-08-01</td>
      <td>187.904762</td>
      <td>2020-08-01</td>
      <td>180.058182</td>
      <td>2020-08-01</td>
      <td>182.310699</td>
      <td>2020-08-01</td>
      <td>177.383453</td>
      <td>-7.846580</td>
      <td>-5.594062</td>
      <td>-10.521309</td>
    </tr>
    <tr>
      <th>728</th>
      <td>2020-09-01</td>
      <td>108.619048</td>
      <td>2020-09-01</td>
      <td>112.918396</td>
      <td>2020-09-01</td>
      <td>99.615967</td>
      <td>2020-09-01</td>
      <td>114.397453</td>
      <td>4.299348</td>
      <td>-9.003081</td>
      <td>5.778406</td>
    </tr>
    <tr>
      <th>729</th>
      <td>2020-10-01</td>
      <td>110.476190</td>
      <td>2020-10-01</td>
      <td>155.090485</td>
      <td>2020-10-01</td>
      <td>137.771423</td>
      <td>2020-10-01</td>
      <td>144.894760</td>
      <td>44.614294</td>
      <td>27.295233</td>
      <td>34.418570</td>
    </tr>
    <tr>
      <th>730</th>
      <td>2020-11-01</td>
      <td>16.190476</td>
      <td>2020-11-01</td>
      <td>28.083494</td>
      <td>2020-11-01</td>
      <td>25.723440</td>
      <td>2020-11-01</td>
      <td>21.710238</td>
      <td>11.893018</td>
      <td>9.532964</td>
      <td>5.519761</td>
    </tr>
    <tr>
      <th>731</th>
      <td>2020-12-01</td>
      <td>90.952381</td>
      <td>2020-12-01</td>
      <td>144.147720</td>
      <td>2020-12-01</td>
      <td>103.382812</td>
      <td>2020-12-01</td>
      <td>139.964111</td>
      <td>53.195339</td>
      <td>12.430432</td>
      <td>49.011730</td>
    </tr>
  </tbody>
</table>
<p>732 rows × 11 columns</p>
</div>




```python
#Errors
MAE_Era5 = np.mean(np.abs(merged['Era5-HIS']))
ME_Era5 = np.mean(merged['Era5-HIS']) 
print(MAE_Era5)
print(ME_Era5)
MAE_XGB = np.mean(np.abs(merged['XGB-HIS']))
ME_XGB = np.mean(merged['XGB-HIS']) 
print(MAE_XGB)
print(ME_XGB)
MAE_CHAPTER = np.mean(np.abs(merged['CHAPTER-HIS']))
ME_CHAPTER = np.mean(merged['CHAPTER-HIS']) 
print(MAE_CHAPTER)
print(ME_CHAPTER)
```

    22.525213413770462
    22.093692840478248
    9.667456294192263
    -0.4488779563423896
    19.85859592801446
    19.27564982634435



```python
# Plot with specific colors
plt.figure(figsize=(15, 5))
plt.plot(merged['Date'], merged['Era5-HIS'], label=f'ERA5-HISTALP (ME={ME_Era5:.1f} mm)', color='blue')
plt.plot(merged['Date'], merged['XGB-HIS'], label=f'XGB-HISTALP (ME={ME_XGB:.1f} mm)', color='purple') 
plt.plot(merged['Date'], merged['CHAPTER-HIS'], label=f'CHAPTER-HISTALP (ME={ME_CHAPTER:.1f} mm)', color='black') 

# Labels and formatting
plt.xlabel('Year',fontsize=20)
plt.ylabel('Difference in Precipitation',fontsize=20)
plt.title('')
plt.legend(fontsize=15)
plt.xticks(fontsize=20) 
plt.yticks(fontsize=20)
plt.grid(True)
plt.tight_layout()
plt.show()
```


    
![png](output_116_0.png)
    



```python
plt.figure(figsize=(7, 5))

sns.kdeplot(merged['ERA5'], color='blue', label='ERA5', linewidth=1)
sns.kdeplot(merged['HISTALP'], color='orange', label='HISTALP', linewidth=2)
sns.kdeplot(merged['XGB'], color='purple', label='XGB', linewidth=1)
sns.kdeplot(merged['CHAPTER'], color='black', label='CHAPTER', linewidth=1)

plt.xlabel('Monthly Precipitation (mm)', fontsize=20)
plt.ylabel('Probability Density', fontsize=20)
plt.xticks(fontsize=15)
plt.yticks(fontsize=15)
plt.legend(fontsize=16)
plt.show()

```


    
![png](output_117_0.png)
    



```python
#Select Time
time_start='1983-01-01'  
time_end = '2000-12-31' #'2000-12-31'   
# Step 1: Convert xarray to pandas DataFrame
B_df = chapter_month_stations['PREC_ACC_NC'].sel(XTIME=slice(time_start , time_end)) \
    .mean(dim="points") \
    .to_dataframe(name='B') \
    .reset_index()

# Step 2: Prepare Histalp data
A_df = Histalp_df_long[(Histalp_df_long["Date"] >= time_start) & 
                       (Histalp_df_long["Date"] < time_end)][['Date', 'Value']].rename(columns={'Value': 'A'})

# Step 3: Merge on Date
merged_pd = pd.merge(A_df, B_df, left_on='Date', right_on='XTIME', how='inner')

# Step 4: Compute RMSE
rmse_his_chapter_1983_2000 = np.sqrt(np.nanmean((merged_pd['A'] - merged_pd['B']) ** 2))
r2_his_chapter_1983_2000 = r2_score(merged_pd['A'], merged_pd['B'])
print('rmse_his_chapter_1983_2000: ', rmse_his_chapter_1983_2000)
print('r2_his_chapter_1983_2000: ', r2_his_chapter_1983_2000)

```

    rmse_his_chapter_1983_2000:  22.341280496665323
    r2_his_chapter_1983_2000:  0.5218573807859849



```python
# Given RMSE values (replace with actual numbers)
rmse_values = [ rmse_his_era5_1960_2000, rmse_his_chapter_1983_2000, rmse_his_xgb_1960_2000]
labels = ['ERA5','CHAPTER', 'XGB' ]

# Create the plot
plt.figure(figsize=(2.5, 5))
plt.bar(labels, rmse_values, color=[ 'blue', 'black', 'purple'])  
plt.ylabel('RMSE mm/month', fontsize=20)
plt.title('')
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Add value labels above bars
for i, value in enumerate(rmse_values):
    plt.text(i, value + 0.02 * max(rmse_values), f'{value:.2f}', ha='center', fontsize=15)

plt.xticks(rotation=90, fontsize=15)
plt.yticks(rotation=90, fontsize=15)
# Show the plot
plt.show()
```


    
![png](output_119_0.png)
    



```python
# Given RMSE values (replace with actual numbers)
r2_values = [ r2_his_era5_1960_2000, r2_his_chapter_1983_2000, r2_his_xgb_1960_2000]
labels = ['ERA5','CHAPTER', 'XGB' ]

# Create the plot
plt.figure(figsize=(2.5, 5))
plt.bar(labels, r2_values, color=[ 'blue', 'black', 'purple'])  
plt.ylabel('R2', fontsize=20)
plt.title('')
plt.grid(axis='y', linestyle='--', alpha=0.7)

# Add value labels above bars
for i, value in enumerate(r2_values):
    plt.text(i, value + 0.02 * max(r2_values), f'{value:.2f}', ha='center', fontsize=15)

plt.xticks(rotation=90, fontsize=15)
plt.yticks(rotation=90, fontsize=15)
# Show the plot
plt.show()
```


    
![png](output_120_0.png)
    


save file


```python
# Open or ensure datasets are in dask (lazy) mode
#era5_backintime = era5_backintime.chunk({'time': 365})
#era5_Imerg = era5_Imerg.chunk({'time': 365})

# Concatenate safely (lazy with Dask)
#merged = xr.concat([era5_backintime, era5_Imerg.drop_vars('custom_dayofyear', errors='ignore')], dim='time')

# Save to NetCDF (on disk, lazy execution)
#merged['XGB'].to_netcdf("ML_IMEX20250722.nc", engine="netcdf4", compute=True)

#ML_IMEX = xr.open_dataset(f"{path}/ML_IMEX20250722.nc")
#print(np.isnan(ML_IMEX['XGB'].values.flatten()).sum())

##############Saving All necessary variables###############################
#merged2 = merged.drop_vars(['sp', 'tcwv', 'time_bnds', 'p71.162', 'cape', 'tp_NearestN','t', 'u', 'v', 'Seasonal Mask', 'Rain/No rain threshold','Imerg P with threshold', 'Train/Valid/Test indices'])
#merged2.to_netcdf("ML_IMEX_allvar_20250722.nc", engine="netcdf4", compute=True)
#ML_IMEX = xr.open_dataset(f"{path}/ML_IMEX_allvar_20250722.nc")
```


```python

```


```python

```


```python

```


```python

```
